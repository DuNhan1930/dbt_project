[0m15:55:47.592805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b320fdb5570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b320ed505e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b320ed50580>]}


============================== 15:55:47.596384 | d52f68a1-1ec2-4cec-bada-fcc20a9b27a1 ==============================
[0m15:55:47.596384 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:55:47.597317 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'profiles_dir': '/home/dunhan/.dbt', 'warn_error': 'None', 'version_check': 'True', 'write_json': 'True', 'debug': 'False', 'target_path': 'None', 'static_parser': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_path': 'logs', 'use_colors': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt init', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'quiet': 'False'}
[0m15:55:47.607482 [info ] [MainThread]: Creating dbt configuration folder at /home/dunhan/.dbt
[0m15:56:02.317235 [debug] [MainThread]: Starter project path: /home/dunhan/dbt_project/dbt_venv/lib/python3.10/site-packages/dbt/include/starter_project
[0m15:56:02.320160 [info ] [MainThread]: 
Your new dbt project "dbt_project" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m15:56:02.320869 [info ] [MainThread]: Setting up your profile.
[0m15:58:08.903747 [info ] [MainThread]: Profile dbt_project written to /home/dunhan/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m15:58:08.905105 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 141.39337, "process_in_blocks": "0", "process_kernel_time": 0.311903, "process_mem_max_rss": "335500", "process_out_blocks": "80", "process_user_time": 4.251886}
[0m15:58:08.906208 [debug] [MainThread]: Command `dbt init` succeeded at 15:58:08.905963 after 141.39 seconds
[0m15:58:08.906872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b320fdb5570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b31ef82d6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b31ef82fd30>]}
[0m15:58:08.907636 [debug] [MainThread]: Flushing usage events
[0m15:58:10.245538 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:58:17.532727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd1fdb94e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd1ed59a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd1ed599c0>]}


============================== 15:58:17.536049 | a96a687b-33a2-4e4f-a9a7-14b9c7d71030 ==============================
[0m15:58:17.536049 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:58:17.537346 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'printer_width': '80', 'invocation_command': 'dbt debug', 'profiles_dir': '/home/dunhan/.dbt', 'debug': 'False', 'write_json': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'no_print': 'None', 'use_colors': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'log_path': 'logs'}
[0m15:58:17.548406 [info ] [MainThread]: dbt version: 1.10.11
[0m15:58:17.549803 [info ] [MainThread]: python version: 3.10.12
[0m15:58:17.551064 [info ] [MainThread]: python path: /home/dunhan/dbt_project/dbt_venv/bin/python3
[0m15:58:17.552198 [info ] [MainThread]: os info: Linux-6.8.0-79-generic-x86_64-with-glibc2.35
[0m15:58:20.350075 [info ] [MainThread]: Using profiles dir at /home/dunhan/.dbt
[0m15:58:20.350776 [info ] [MainThread]: Using profiles.yml file at /home/dunhan/.dbt/profiles.yml
[0m15:58:20.351333 [info ] [MainThread]: Using dbt_project.yml file at /home/dunhan/dbt_project/dbt_project.yml
[0m15:58:20.351863 [info ] [MainThread]: adapter type: bigquery
[0m15:58:20.352334 [info ] [MainThread]: adapter version: 1.10.2
[0m15:58:20.352979 [info ] [MainThread]: Configuration:
[0m15:58:20.353593 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:58:20.354254 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m15:58:20.355029 [info ] [MainThread]: Required dependencies:
[0m15:58:20.355607 [debug] [MainThread]: Executing "git --help"
[0m15:58:20.359105 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:58:20.360267 [debug] [MainThread]: STDERR: "b''"
[0m15:58:20.361142 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:58:20.362148 [info ] [MainThread]: Connection:
[0m15:58:20.363046 [info ] [MainThread]:   method: service-account
[0m15:58:20.364004 [info ] [MainThread]:   database: symmetric-fin-469415-q9
[0m15:58:20.364668 [info ] [MainThread]:   execution_project: symmetric-fin-469415-q9
[0m15:58:20.365579 [info ] [MainThread]:   schema: glamira_data_2025
[0m15:58:20.366380 [info ] [MainThread]:   location: US
[0m15:58:20.367087 [info ] [MainThread]:   priority: interactive
[0m15:58:20.367955 [info ] [MainThread]:   maximum_bytes_billed: None
[0m15:58:20.368594 [info ] [MainThread]:   impersonate_service_account: None
[0m15:58:20.369733 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m15:58:20.370752 [info ] [MainThread]:   job_retries: 1
[0m15:58:20.371830 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m15:58:20.372852 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m15:58:20.373806 [info ] [MainThread]:   timeout_seconds: 300
[0m15:58:20.375036 [info ] [MainThread]:   client_id: None
[0m15:58:20.376351 [info ] [MainThread]:   token_uri: None
[0m15:58:20.377621 [info ] [MainThread]:   compute_region: None
[0m15:58:20.379008 [info ] [MainThread]:   dataproc_cluster_name: None
[0m15:58:20.380383 [info ] [MainThread]:   gcs_bucket: None
[0m15:58:20.381478 [info ] [MainThread]:   dataproc_batch: None
[0m15:58:20.382639 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:58:20.706412 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m15:58:20.707034 [debug] [MainThread]: On debug: select 1 as id
[0m15:58:20.707572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:21.837045 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:0562a041-c11a-4767-8886-84a8570a5704&page=queryresults
[0m15:58:22.592863 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:58:22.593608 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:58:22.594477 [info ] [MainThread]: Project loading failed for the following reason:
 project path </home/dunhan/dbt_project/dbt_project.yml> not found

[0m15:58:22.596116 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 5.1428823, "process_in_blocks": "0", "process_kernel_time": 0.408135, "process_mem_max_rss": "346576", "process_out_blocks": "24", "process_user_time": 5.24788}
[0m15:58:22.596779 [debug] [MainThread]: Command `dbt debug` failed at 15:58:22.596654 after 5.14 seconds
[0m15:58:22.597326 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:58:22.597826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd1fdb94e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fcff8c3a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fcff8c3a00>]}
[0m15:58:22.598457 [debug] [MainThread]: Flushing usage events
[0m15:58:24.249078 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:11.883769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8ec1fb95a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8ec0f586d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8ec0f58670>]}


============================== 15:59:11.887341 | b4f3c626-9e96-4752-aaec-1e23d7d63d2f ==============================
[0m15:59:11.887341 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:59:11.888562 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'debug': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'quiet': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'log_format': 'default', 'profiles_dir': '/home/dunhan/.dbt', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'introspect': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'target_path': 'None', 'log_path': '/home/dunhan/dbt_project/logs', 'invocation_command': 'dbt debug', 'static_parser': 'True'}
[0m15:59:11.899002 [info ] [MainThread]: dbt version: 1.10.11
[0m15:59:11.899770 [info ] [MainThread]: python version: 3.10.12
[0m15:59:11.900668 [info ] [MainThread]: python path: /home/dunhan/dbt_project/dbt_venv/bin/python3
[0m15:59:11.901798 [info ] [MainThread]: os info: Linux-6.8.0-79-generic-x86_64-with-glibc2.35
[0m15:59:14.492773 [info ] [MainThread]: Using profiles dir at /home/dunhan/.dbt
[0m15:59:14.493497 [info ] [MainThread]: Using profiles.yml file at /home/dunhan/.dbt/profiles.yml
[0m15:59:14.494061 [info ] [MainThread]: Using dbt_project.yml file at /home/dunhan/dbt_project/dbt_project.yml
[0m15:59:14.494885 [info ] [MainThread]: adapter type: bigquery
[0m15:59:14.495633 [info ] [MainThread]: adapter version: 1.10.2
[0m15:59:14.660360 [info ] [MainThread]: Configuration:
[0m15:59:14.661317 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:59:14.662210 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:59:14.663047 [info ] [MainThread]: Required dependencies:
[0m15:59:14.663738 [debug] [MainThread]: Executing "git --help"
[0m15:59:14.666941 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:59:14.668067 [debug] [MainThread]: STDERR: "b''"
[0m15:59:14.668638 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:59:14.669312 [info ] [MainThread]: Connection:
[0m15:59:14.670341 [info ] [MainThread]:   method: service-account
[0m15:59:14.671327 [info ] [MainThread]:   database: symmetric-fin-469415-q9
[0m15:59:14.672249 [info ] [MainThread]:   execution_project: symmetric-fin-469415-q9
[0m15:59:14.673016 [info ] [MainThread]:   schema: glamira_data_2025
[0m15:59:14.673928 [info ] [MainThread]:   location: US
[0m15:59:14.674943 [info ] [MainThread]:   priority: interactive
[0m15:59:14.676227 [info ] [MainThread]:   maximum_bytes_billed: None
[0m15:59:14.677204 [info ] [MainThread]:   impersonate_service_account: None
[0m15:59:14.678503 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m15:59:14.679821 [info ] [MainThread]:   job_retries: 1
[0m15:59:14.681114 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m15:59:14.682463 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m15:59:14.683686 [info ] [MainThread]:   timeout_seconds: 300
[0m15:59:14.684652 [info ] [MainThread]:   client_id: None
[0m15:59:14.685737 [info ] [MainThread]:   token_uri: None
[0m15:59:14.686681 [info ] [MainThread]:   compute_region: None
[0m15:59:14.687607 [info ] [MainThread]:   dataproc_cluster_name: None
[0m15:59:14.688648 [info ] [MainThread]:   gcs_bucket: None
[0m15:59:14.689342 [info ] [MainThread]:   dataproc_batch: None
[0m15:59:14.690432 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:59:14.985248 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m15:59:14.985893 [debug] [MainThread]: On debug: select 1 as id
[0m15:59:14.986405 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:59:15.874739 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:e9a2b03a-aff8-4002-a828-0f3e6a149980&page=queryresults
[0m15:59:16.642617 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:59:16.643420 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:59:16.644751 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.8398476, "process_in_blocks": "0", "process_kernel_time": 0.403362, "process_mem_max_rss": "347768", "process_out_blocks": "24", "process_user_time": 5.029046}
[0m15:59:16.645474 [debug] [MainThread]: Command `dbt debug` succeeded at 15:59:16.645349 after 4.84 seconds
[0m15:59:16.646004 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:59:16.646623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8ec1fb95a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8ec1d4ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8ea1af2080>]}
[0m15:59:16.647320 [debug] [MainThread]: Flushing usage events
[0m15:59:18.209779 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:01:11.022555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aab73bd4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aab63585e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aab6358580>]}


============================== 16:01:11.026371 | e311e79b-8513-4159-ae59-7e912a9fedcb ==============================
[0m16:01:11.026371 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:01:11.027398 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_cache_events': 'False', 'partial_parse': 'True', 'profiles_dir': '/home/dunhan/.dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/dunhan/dbt_project/logs', 'version_check': 'True', 'write_json': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'empty': 'None', 'no_print': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'use_colors': 'True'}
[0m16:01:11.040159 [info ] [MainThread]: dbt version: 1.10.11
[0m16:01:11.041292 [info ] [MainThread]: python version: 3.10.12
[0m16:01:11.042346 [info ] [MainThread]: python path: /home/dunhan/dbt_project/dbt_venv/bin/python3
[0m16:01:11.043388 [info ] [MainThread]: os info: Linux-6.8.0-79-generic-x86_64-with-glibc2.35
[0m16:01:13.772557 [info ] [MainThread]: Using profiles dir at /home/dunhan/.dbt
[0m16:01:13.773413 [info ] [MainThread]: Using profiles.yml file at /home/dunhan/.dbt/profiles.yml
[0m16:01:13.774233 [info ] [MainThread]: Using dbt_project.yml file at /home/dunhan/dbt_project/dbt_project.yml
[0m16:01:13.775178 [info ] [MainThread]: adapter type: bigquery
[0m16:01:13.775780 [info ] [MainThread]: adapter version: 1.10.2
[0m16:01:13.939982 [info ] [MainThread]: Configuration:
[0m16:01:13.940722 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:01:13.941639 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:01:13.942277 [info ] [MainThread]: Required dependencies:
[0m16:01:13.943042 [debug] [MainThread]: Executing "git --help"
[0m16:01:13.945979 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:01:13.947241 [debug] [MainThread]: STDERR: "b''"
[0m16:01:13.948426 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:01:13.949296 [info ] [MainThread]: Connection:
[0m16:01:13.950296 [info ] [MainThread]:   method: service-account
[0m16:01:13.951244 [info ] [MainThread]:   database: symmetric-fin-469415-q9
[0m16:01:13.951920 [info ] [MainThread]:   execution_project: symmetric-fin-469415-q9
[0m16:01:13.952535 [info ] [MainThread]:   schema: glamira_data_2025
[0m16:01:13.953445 [info ] [MainThread]:   location: US
[0m16:01:13.954209 [info ] [MainThread]:   priority: interactive
[0m16:01:13.955127 [info ] [MainThread]:   maximum_bytes_billed: None
[0m16:01:13.955856 [info ] [MainThread]:   impersonate_service_account: None
[0m16:01:13.956461 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m16:01:13.957462 [info ] [MainThread]:   job_retries: 1
[0m16:01:13.958648 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m16:01:13.959959 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m16:01:13.961238 [info ] [MainThread]:   timeout_seconds: 300
[0m16:01:13.962532 [info ] [MainThread]:   client_id: None
[0m16:01:13.963726 [info ] [MainThread]:   token_uri: None
[0m16:01:13.964849 [info ] [MainThread]:   compute_region: None
[0m16:01:13.966166 [info ] [MainThread]:   dataproc_cluster_name: None
[0m16:01:13.967493 [info ] [MainThread]:   gcs_bucket: None
[0m16:01:13.968884 [info ] [MainThread]:   dataproc_batch: None
[0m16:01:13.970526 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:01:14.290746 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m16:01:14.291413 [debug] [MainThread]: On debug: select 1 as id
[0m16:01:14.291951 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:01:15.228983 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:2ab85b15-ca3c-4d2e-98a7-9a24577ccd21&page=queryresults
[0m16:01:16.022527 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:01:16.023788 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:01:16.025387 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 5.083952, "process_in_blocks": "0", "process_kernel_time": 0.430045, "process_mem_max_rss": "348144", "process_out_blocks": "24", "process_user_time": 5.074741}
[0m16:01:16.026125 [debug] [MainThread]: Command `dbt debug` succeeded at 16:01:16.025982 after 5.08 seconds
[0m16:01:16.026714 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:01:16.027399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aab73bd4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aa96f78a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78aa96f78d30>]}
[0m16:01:16.028006 [debug] [MainThread]: Flushing usage events
[0m16:01:18.369377 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:07:05.684415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff49acb9570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff499c586d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff499c58670>]}


============================== 16:07:05.690331 | 0284fb5d-4909-43f3-8e42-490de1d65bcb ==============================
[0m16:07:05.690331 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:07:05.691804 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'quiet': 'False', 'fail_fast': 'False', 'no_print': 'None', 'version_check': 'True', 'printer_width': '80', 'profiles_dir': '/home/dunhan/.dbt', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': '/home/dunhan/dbt_project/logs', 'static_parser': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt ', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'log_format': 'default', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True'}
[0m16:07:05.910476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0284fb5d-4909-43f3-8e42-490de1d65bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff499c58a30>]}
[0m16:07:05.924616 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:07:05.926209 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:07:05.928026 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3356179, "process_in_blocks": "0", "process_kernel_time": 0.127965, "process_mem_max_rss": "96576", "process_out_blocks": "16", "process_user_time": 2.300381}
[0m16:07:05.928768 [debug] [MainThread]: Command `cli deps` succeeded at 16:07:05.928629 after 0.34 seconds
[0m16:07:05.929389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff49acb9570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4999cd510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff499c58700>]}
[0m16:07:05.929987 [debug] [MainThread]: Flushing usage events
[0m16:07:07.355350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:08:05.699814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd011a95a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd001507f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd00150790>]}


============================== 16:08:05.703310 | e3e5c748-d0dc-43be-82d7-254eb71b6503 ==============================
[0m16:08:05.703310 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:08:05.704138 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'version_check': 'True', 'static_parser': 'True', 'warn_error': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/home/dunhan/.dbt', 'use_colors': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'no_print': 'None', 'log_path': '/home/dunhan/dbt_project/logs', 'log_format': 'default', 'fail_fast': 'False', 'printer_width': '80', 'quiet': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:08:08.402600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3e5c748-d0dc-43be-82d7-254eb71b6503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd02c20d00>]}
[0m16:08:08.497175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3e5c748-d0dc-43be-82d7-254eb71b6503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd00119360>]}
[0m16:08:08.498188 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:08:08.788031 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m16:08:08.964429 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:08:08.965258 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/example/test.sql
[0m16:08:09.325256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3e5c748-d0dc-43be-82d7-254eb71b6503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fce07ca4a0>]}
[0m16:08:09.447475 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m16:08:09.449902 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m16:08:09.464938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3e5c748-d0dc-43be-82d7-254eb71b6503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fce08e8a30>]}
[0m16:08:09.465731 [info ] [MainThread]: Found 3 models, 4 data tests, 495 macros
[0m16:08:09.466290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3e5c748-d0dc-43be-82d7-254eb71b6503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fce08e8a00>]}
[0m16:08:09.468466 [info ] [MainThread]: 
[0m16:08:09.469124 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:08:09.469735 [info ] [MainThread]: 
[0m16:08:09.470624 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:08:09.480722 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m16:08:09.481581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:10.327139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now list_symmetric-fin-469415-q9_glamira_data_2025)
[0m16:08:10.327927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:11.172069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3e5c748-d0dc-43be-82d7-254eb71b6503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fce07087c0>]}
[0m16:08:11.172840 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:08:11.215469 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m16:08:11.216534 [info ] [Thread-1 (]: 1 of 2 START sql table model glamira_data_2025.my_first_dbt_model .............. [RUN]
[0m16:08:11.217454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025, now model.dbt_project.my_first_dbt_model)
[0m16:08:11.218161 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m16:08:11.234521 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m16:08:11.236379 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m16:08:11.311793 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m16:08:11.313360 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025`.`my_first_dbt_model`
      
    
    

    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m16:08:11.314430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:12.345682 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:405aed76-2451-4b62-874c-d484c2111dd9&page=queryresults
[0m16:08:14.865210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e5c748-d0dc-43be-82d7-254eb71b6503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fce3b7e800>]}
[0m16:08:14.866272 [info ] [Thread-1 (]: 1 of 2 OK created sql table model glamira_data_2025.my_first_dbt_model ......... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.65s]
[0m16:08:14.867398 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m16:08:14.868868 [debug] [Thread-1 (]: Began running node model.dbt_project.my_second_dbt_model
[0m16:08:14.869657 [info ] [Thread-1 (]: 2 of 2 START sql view model glamira_data_2025.my_second_dbt_model .............. [RUN]
[0m16:08:14.870599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.my_first_dbt_model, now model.dbt_project.my_second_dbt_model)
[0m16:08:14.871256 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_second_dbt_model
[0m16:08:14.876980 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_second_dbt_model"
[0m16:08:14.878566 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_second_dbt_model
[0m16:08:14.914940 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_second_dbt_model"
[0m16:08:14.915897 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */


  create or replace view `symmetric-fin-469415-q9`.`glamira_data_2025`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `symmetric-fin-469415-q9`.`glamira_data_2025`.`my_first_dbt_model`
where id = 1;


[0m16:08:14.916601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:15.854218 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:db348215-713d-4d00-9cc2-4ffb94647332&page=queryresults
[0m16:08:16.542576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3e5c748-d0dc-43be-82d7-254eb71b6503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fcdfd4bb50>]}
[0m16:08:16.543740 [info ] [Thread-1 (]: 2 of 2 OK created sql view model glamira_data_2025.my_second_dbt_model ......... [[32mCREATE VIEW (0 processed)[0m in 1.67s]
[0m16:08:16.544781 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_second_dbt_model
[0m16:08:16.546296 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:08:16.549032 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:08:16.549682 [debug] [MainThread]: Connection 'model.dbt_project.my_second_dbt_model' was properly closed.
[0m16:08:16.550710 [info ] [MainThread]: 
[0m16:08:16.551500 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 7.08 seconds (7.08s).
[0m16:08:16.553563 [debug] [MainThread]: Command end result
[0m16:08:16.610406 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m16:08:16.612912 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m16:08:16.625081 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m16:08:16.625683 [info ] [MainThread]: 
[0m16:08:16.626780 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:08:16.627476 [info ] [MainThread]: 
[0m16:08:16.628177 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m16:08:16.629602 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.008659, "process_in_blocks": "16", "process_kernel_time": 0.425209, "process_mem_max_rss": "361552", "process_out_blocks": "3112", "process_user_time": 6.368131}
[0m16:08:16.630679 [debug] [MainThread]: Command `dbt run` succeeded at 16:08:16.630418 after 11.01 seconds
[0m16:08:16.631379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd011a95a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd01d38130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd00905c00>]}
[0m16:08:16.632073 [debug] [MainThread]: Flushing usage events
[0m16:08:18.284265 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:11:15.774704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7706eafb94e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7706e9f606d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7706e9f60670>]}


============================== 16:11:15.777936 | 6d5f275b-366e-44bb-ac07-4c229d6be7aa ==============================
[0m16:11:15.777936 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:11:15.778991 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'profiles_dir': '/home/dunhan/.dbt', 'partial_parse': 'True', 'version_check': 'True', 'log_path': '/home/dunhan/dbt_project/logs', 'no_print': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'debug': 'False', 'write_json': 'True', 'empty': 'False', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'static_parser': 'True'}
[0m16:11:18.500264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d5f275b-366e-44bb-ac07-4c229d6be7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7706ca9210f0>]}
[0m16:11:18.590418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d5f275b-366e-44bb-ac07-4c229d6be7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7706ea18a920>]}
[0m16:11:18.591349 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:11:18.895378 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m16:11:19.080267 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:11:19.080862 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:11:19.144306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d5f275b-366e-44bb-ac07-4c229d6be7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7706ca480130>]}
[0m16:11:19.273148 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m16:11:19.275754 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m16:11:19.290594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d5f275b-366e-44bb-ac07-4c229d6be7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7706ca41c9a0>]}
[0m16:11:19.291929 [info ] [MainThread]: Found 3 models, 4 data tests, 495 macros
[0m16:11:19.292679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d5f275b-366e-44bb-ac07-4c229d6be7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7706ca41c4f0>]}
[0m16:11:19.295529 [info ] [MainThread]: 
[0m16:11:19.296405 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:11:19.297311 [info ] [MainThread]: 
[0m16:11:19.298885 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:11:19.310071 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m16:11:19.311318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:20.119259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now list_symmetric-fin-469415-q9_glamira_data_2025)
[0m16:11:20.120272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:20.939606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d5f275b-366e-44bb-ac07-4c229d6be7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7706eca05d20>]}
[0m16:11:20.940486 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:11:20.945881 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m16:11:20.946722 [info ] [Thread-1 (]: 1 of 3 START sql table model glamira_data_2025.my_first_dbt_model .............. [RUN]
[0m16:11:20.947536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025, now model.dbt_project.my_first_dbt_model)
[0m16:11:20.948221 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m16:11:20.962879 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m16:11:20.964380 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m16:11:20.992292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:21.800057 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m16:11:21.801110 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025`.`my_first_dbt_model`
      
    
    

    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m16:11:22.371374 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:69337458-e7bc-4c09-88b8-c6a7cd07f971&page=queryresults
[0m16:11:24.534439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5f275b-366e-44bb-ac07-4c229d6be7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7706cd8ae770>]}
[0m16:11:24.535565 [info ] [Thread-1 (]: 1 of 3 OK created sql table model glamira_data_2025.my_first_dbt_model ......... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.58s]
[0m16:11:24.536707 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m16:11:24.537534 [debug] [Thread-1 (]: Began running node model.dbt_project.test
[0m16:11:24.538959 [info ] [Thread-1 (]: 2 of 3 START sql table model glamira_data_2025.test ............................ [RUN]
[0m16:11:24.539830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.my_first_dbt_model, now model.dbt_project.test)
[0m16:11:24.540498 [debug] [Thread-1 (]: Began compiling node model.dbt_project.test
[0m16:11:24.547769 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.test"
[0m16:11:24.549370 [debug] [Thread-1 (]: Began executing node model.dbt_project.test
[0m16:11:24.557863 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.test"
[0m16:11:24.559481 [debug] [Thread-1 (]: On model.dbt_project.test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.test"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025`.`test`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
 SELECT *
 FROM symmetric-fin-469415-q9.glamira_data_2025.summary
),


checkout_success AS (
 SELECT
   _id AS customer_id,
   ip AS ip_address,
   time_stamp AS date_id,
   local_time AS local_time,
   device_id AS device_id,
   email_address AS email_address,
   resolution AS resolution,
   user_id_db AS user_id_db,
   user_agent AS user_agent,
   referrer_url AS referrer_url
 FROM src
 WHERE collection = "checkout_success"
)


SELECT * FROM checkout_success;
    );
  
[0m16:11:24.560642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:25.365606 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:8a937925-1c5d-491a-8e69-64aded1de2fe&page=queryresults
[0m16:11:25.366432 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:8a937925-1c5d-491a-8e69-64aded1de2fe&page=queryresults
[0m16:11:25.391940 [debug] [Thread-1 (]: Database Error in model test (models/example/test.sql)
  Syntax error: Expected ")" but got ";" at [39:31]
  compiled code at target/run/dbt_project/models/example/test.sql
[0m16:11:25.392981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5f275b-366e-44bb-ac07-4c229d6be7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7706bbe96cb0>]}
[0m16:11:25.394018 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model glamira_data_2025.test ................... [[31mERROR[0m in 0.85s]
[0m16:11:25.395233 [debug] [Thread-1 (]: Finished running node model.dbt_project.test
[0m16:11:25.396603 [debug] [Thread-1 (]: Began running node model.dbt_project.my_second_dbt_model
[0m16:11:25.397962 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.test' to be skipped because of status 'error'.  Reason: Database Error in model test (models/example/test.sql)
  Syntax error: Expected ")" but got ";" at [39:31]
  compiled code at target/run/dbt_project/models/example/test.sql.
[0m16:11:25.399703 [info ] [Thread-1 (]: 3 of 3 START sql view model glamira_data_2025.my_second_dbt_model .............. [RUN]
[0m16:11:25.402625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.test, now model.dbt_project.my_second_dbt_model)
[0m16:11:25.404005 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_second_dbt_model
[0m16:11:25.411406 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_second_dbt_model"
[0m16:11:25.412449 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_second_dbt_model
[0m16:11:25.453062 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_second_dbt_model"
[0m16:11:25.454073 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */


  create or replace view `symmetric-fin-469415-q9`.`glamira_data_2025`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `symmetric-fin-469415-q9`.`glamira_data_2025`.`my_first_dbt_model`
where id = 1;


[0m16:11:25.454868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:26.402587 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:06403e8a-85ae-409a-9878-b8e3f57ef78e&page=queryresults
[0m16:11:27.086376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5f275b-366e-44bb-ac07-4c229d6be7aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7706ca490ee0>]}
[0m16:11:27.087586 [info ] [Thread-1 (]: 3 of 3 OK created sql view model glamira_data_2025.my_second_dbt_model ......... [[32mCREATE VIEW (0 processed)[0m in 1.68s]
[0m16:11:27.088779 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_second_dbt_model
[0m16:11:27.090844 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:11:27.093209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:27.094001 [debug] [MainThread]: Connection 'model.dbt_project.my_second_dbt_model' was properly closed.
[0m16:11:27.095220 [info ] [MainThread]: 
[0m16:11:27.096293 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 7.80 seconds (7.80s).
[0m16:11:27.098240 [debug] [MainThread]: Command end result
[0m16:11:27.154075 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m16:11:27.157181 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m16:11:27.168236 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m16:11:27.168813 [info ] [MainThread]: 
[0m16:11:27.169661 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:11:27.170527 [info ] [MainThread]: 
[0m16:11:27.171726 [error] [MainThread]: [31mFailure in model test (models/example/test.sql)[0m
[0m16:11:27.172871 [error] [MainThread]:   Database Error in model test (models/example/test.sql)
  Syntax error: Expected ")" but got ";" at [39:31]
  compiled code at target/run/dbt_project/models/example/test.sql
[0m16:11:27.173434 [info ] [MainThread]: 
[0m16:11:27.174388 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/example/test.sql
[0m16:11:27.175447 [info ] [MainThread]: 
[0m16:11:27.176532 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m16:11:27.178154 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.482418, "process_in_blocks": "56", "process_kernel_time": 0.411287, "process_mem_max_rss": "357948", "process_out_blocks": "2120", "process_user_time": 6.437852}
[0m16:11:27.178946 [debug] [MainThread]: Command `dbt run` failed at 16:11:27.178724 after 11.48 seconds
[0m16:11:27.180014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7706eafb94e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7706ca922650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7706eaeac940>]}
[0m16:11:27.180870 [debug] [MainThread]: Flushing usage events
[0m16:11:29.280041 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:13:23.677654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ad461b5570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ad451607c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ad45160760>]}


============================== 16:13:23.681773 | 0e4c044c-1e2a-4f69-a0f4-2b1f3185b0db ==============================
[0m16:13:23.681773 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:13:23.683227 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'target_path': 'None', 'debug': 'False', 'empty': 'False', 'partial_parse': 'True', 'no_print': 'None', 'log_path': '/home/dunhan/dbt_project/logs', 'use_colors': 'True', 'static_parser': 'True', 'profiles_dir': '/home/dunhan/.dbt', 'log_format': 'default', 'printer_width': '80', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select stag_customer'}
[0m16:13:26.382410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e4c044c-1e2a-4f69-a0f4-2b1f3185b0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ad25de87c0>]}
[0m16:13:26.474093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e4c044c-1e2a-4f69-a0f4-2b1f3185b0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ad459677f0>]}
[0m16:13:26.475043 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:13:26.772182 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m16:13:26.950534 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:13:26.951163 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:13:27.011710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e4c044c-1e2a-4f69-a0f4-2b1f3185b0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ad25770130>]}
[0m16:13:27.134136 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m16:13:27.136828 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m16:13:27.151900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e4c044c-1e2a-4f69-a0f4-2b1f3185b0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ad25728370>]}
[0m16:13:27.152673 [info ] [MainThread]: Found 3 models, 4 data tests, 495 macros
[0m16:13:27.153318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e4c044c-1e2a-4f69-a0f4-2b1f3185b0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ad25dc3160>]}
[0m16:13:27.154189 [warn ] [MainThread]: The selection criterion 'stag_customer' does not match any enabled nodes
[0m16:13:27.155826 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:13:27.159498 [debug] [MainThread]: Command end result
[0m16:13:27.204376 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m16:13:27.206800 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m16:13:27.212005 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m16:13:27.213247 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.6245077, "process_in_blocks": "0", "process_kernel_time": 0.424872, "process_mem_max_rss": "346892", "process_out_blocks": "2056", "process_user_time": 5.320403}
[0m16:13:27.214100 [debug] [MainThread]: Command `dbt run` succeeded at 16:13:27.213965 after 3.63 seconds
[0m16:13:27.214675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ad461b5570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ad46070e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ad25de87c0>]}
[0m16:13:27.215288 [debug] [MainThread]: Flushing usage events
[0m16:13:29.310565 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:13:45.423237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745c950b5510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745c94058a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745c94058a00>]}


============================== 16:13:45.426461 | 5652abb6-3741-450e-af55-9db5396874a7 ==============================
[0m16:13:45.426461 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:13:45.427336 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'invocation_command': 'dbt ls --select example', 'static_parser': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'version_check': 'True', 'no_print': 'None', 'debug': 'False', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'log_path': '/home/dunhan/dbt_project/logs', 'cache_selected_only': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/home/dunhan/.dbt', 'empty': 'None', 'printer_width': '80', 'fail_fast': 'False', 'log_cache_events': 'False'}
[0m16:13:48.199669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5652abb6-3741-450e-af55-9db5396874a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745c96b5bcd0>]}
[0m16:13:48.293661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5652abb6-3741-450e-af55-9db5396874a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745c94f5fc70>]}
[0m16:13:48.294607 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:13:48.611874 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m16:13:48.800724 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:13:48.801340 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:13:48.868699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5652abb6-3741-450e-af55-9db5396874a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745c746682e0>]}
[0m16:13:48.996081 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m16:13:48.998637 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m16:13:49.011226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5652abb6-3741-450e-af55-9db5396874a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745c747db400>]}
[0m16:13:49.012086 [info ] [MainThread]: Found 3 models, 4 data tests, 495 macros
[0m16:13:49.012854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5652abb6-3741-450e-af55-9db5396874a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745c747daf20>]}
[0m16:13:49.013789 [info ] [MainThread]: dbt_project.example.my_first_dbt_model
[0m16:13:49.014597 [info ] [MainThread]: dbt_project.example.my_second_dbt_model
[0m16:13:49.015445 [info ] [MainThread]: dbt_project.example.test
[0m16:13:49.016155 [info ] [MainThread]: dbt_project.example.not_null_my_first_dbt_model_id
[0m16:13:49.016787 [info ] [MainThread]: dbt_project.example.not_null_my_second_dbt_model_id
[0m16:13:49.017442 [info ] [MainThread]: dbt_project.example.unique_my_first_dbt_model_id
[0m16:13:49.018586 [info ] [MainThread]: dbt_project.example.unique_my_second_dbt_model_id
[0m16:13:49.020818 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 3.6773396, "process_in_blocks": "0", "process_kernel_time": 0.431478, "process_mem_max_rss": "345744", "process_out_blocks": "1032", "process_user_time": 5.233675}
[0m16:13:49.022402 [debug] [MainThread]: Command `dbt ls` succeeded at 16:13:49.022199 after 3.68 seconds
[0m16:13:49.023535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745c950b5510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745c96b5bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745c7468f1c0>]}
[0m16:13:49.024796 [debug] [MainThread]: Flushing usage events
[0m16:13:50.286259 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:14:53.578904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ba45b5570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ba35586a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ba3558640>]}


============================== 16:14:53.582575 | 434ab462-f556-4ef2-a346-f9303d273f16 ==============================
[0m16:14:53.582575 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:14:53.583547 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'introspect': 'True', 'no_print': 'None', 'warn_error': 'None', 'log_cache_events': 'False', 'profiles_dir': '/home/dunhan/.dbt', 'static_parser': 'True', 'fail_fast': 'False', 'empty': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'quiet': 'False', 'debug': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'log_path': '/home/dunhan/dbt_project/logs', 'target_path': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'invocation_command': 'dbt debug'}
[0m16:14:53.596092 [info ] [MainThread]: dbt version: 1.10.11
[0m16:14:53.597232 [info ] [MainThread]: python version: 3.10.12
[0m16:14:53.598225 [info ] [MainThread]: python path: /home/dunhan/dbt_project/dbt_venv/bin/python3
[0m16:14:53.599189 [info ] [MainThread]: os info: Linux-6.8.0-79-generic-x86_64-with-glibc2.35
[0m16:14:56.298590 [info ] [MainThread]: Using profiles dir at /home/dunhan/.dbt
[0m16:14:56.299773 [info ] [MainThread]: Using profiles.yml file at /home/dunhan/.dbt/profiles.yml
[0m16:14:56.300864 [info ] [MainThread]: Using dbt_project.yml file at /home/dunhan/dbt_project/dbt_project.yml
[0m16:14:56.301974 [info ] [MainThread]: adapter type: bigquery
[0m16:14:56.303440 [info ] [MainThread]: adapter version: 1.10.2
[0m16:14:56.520609 [info ] [MainThread]: Configuration:
[0m16:14:56.521385 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:14:56.522046 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:14:56.522693 [info ] [MainThread]: Required dependencies:
[0m16:14:56.523557 [debug] [MainThread]: Executing "git --help"
[0m16:14:56.526500 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:14:56.527350 [debug] [MainThread]: STDERR: "b''"
[0m16:14:56.527921 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:14:56.528570 [info ] [MainThread]: Connection:
[0m16:14:56.529465 [info ] [MainThread]:   method: service-account
[0m16:14:56.530090 [info ] [MainThread]:   database: symmetric-fin-469415-q9
[0m16:14:56.531017 [info ] [MainThread]:   execution_project: symmetric-fin-469415-q9
[0m16:14:56.532126 [info ] [MainThread]:   schema: glamira_data_2025
[0m16:14:56.533218 [info ] [MainThread]:   location: US
[0m16:14:56.534274 [info ] [MainThread]:   priority: interactive
[0m16:14:56.535308 [info ] [MainThread]:   maximum_bytes_billed: None
[0m16:14:56.536360 [info ] [MainThread]:   impersonate_service_account: None
[0m16:14:56.537481 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m16:14:56.538602 [info ] [MainThread]:   job_retries: 1
[0m16:14:56.539625 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m16:14:56.540620 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m16:14:56.541663 [info ] [MainThread]:   timeout_seconds: 300
[0m16:14:56.542787 [info ] [MainThread]:   client_id: None
[0m16:14:56.544110 [info ] [MainThread]:   token_uri: None
[0m16:14:56.545269 [info ] [MainThread]:   compute_region: None
[0m16:14:56.546449 [info ] [MainThread]:   dataproc_cluster_name: None
[0m16:14:56.547928 [info ] [MainThread]:   gcs_bucket: None
[0m16:14:56.549502 [info ] [MainThread]:   dataproc_batch: None
[0m16:14:56.551497 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:14:56.858841 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m16:14:56.859865 [debug] [MainThread]: On debug: select 1 as id
[0m16:14:56.860469 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:14:57.819679 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:adc63273-f304-4608-8131-0f88f9af3728&page=queryresults
[0m16:14:58.891892 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:14:58.892622 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:14:58.894268 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 5.394328, "process_in_blocks": "0", "process_kernel_time": 0.443277, "process_mem_max_rss": "348224", "process_out_blocks": "24", "process_user_time": 5.135626}
[0m16:14:58.895311 [debug] [MainThread]: Command `dbt debug` succeeded at 16:14:58.895112 after 5.40 seconds
[0m16:14:58.896075 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:14:58.897777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8ba45b5570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8b840dd630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8b840dc7c0>]}
[0m16:14:58.899508 [debug] [MainThread]: Flushing usage events
[0m16:15:00.278977 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:15:38.767337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787dcdcad540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787dccc48a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787dccc48a00>]}


============================== 16:15:38.770893 | c8f06843-612e-4ed7-a801-f10d6a8896c0 ==============================
[0m16:15:38.770893 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:15:38.772134 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'warn_error': 'None', 'log_path': '/home/dunhan/dbt_project/logs', 'profiles_dir': '/home/dunhan/.dbt', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'fail_fast': 'False', 'introspect': 'True', 'use_colors': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'target_path': 'None', 'printer_width': '80', 'empty': 'None', 'version_check': 'True', 'quiet': 'False', 'invocation_command': 'dbt ls'}
[0m16:15:41.481740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8f06843-612e-4ed7-a801-f10d6a8896c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787dad8ef3a0>]}
[0m16:15:41.578526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8f06843-612e-4ed7-a801-f10d6a8896c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787dccc4b940>]}
[0m16:15:41.579487 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:15:41.870878 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m16:15:42.039062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:15:42.039662 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:15:42.101500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8f06843-612e-4ed7-a801-f10d6a8896c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787dad250130>]}
[0m16:15:42.221451 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m16:15:42.223667 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m16:15:42.236501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8f06843-612e-4ed7-a801-f10d6a8896c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787dad3544f0>]}
[0m16:15:42.237420 [info ] [MainThread]: Found 3 models, 4 data tests, 495 macros
[0m16:15:42.238122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8f06843-612e-4ed7-a801-f10d6a8896c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787dad2375e0>]}
[0m16:15:42.239329 [info ] [MainThread]: dbt_project.example.my_first_dbt_model
[0m16:15:42.240037 [info ] [MainThread]: dbt_project.example.my_second_dbt_model
[0m16:15:42.240675 [info ] [MainThread]: dbt_project.example.test
[0m16:15:42.241363 [info ] [MainThread]: dbt_project.example.not_null_my_first_dbt_model_id
[0m16:15:42.242151 [info ] [MainThread]: dbt_project.example.not_null_my_second_dbt_model_id
[0m16:15:42.243020 [info ] [MainThread]: dbt_project.example.unique_my_first_dbt_model_id
[0m16:15:42.244087 [info ] [MainThread]: dbt_project.example.unique_my_second_dbt_model_id
[0m16:15:42.245510 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 3.5625577, "process_in_blocks": "0", "process_kernel_time": 0.41068, "process_mem_max_rss": "345788", "process_out_blocks": "1032", "process_user_time": 5.125009}
[0m16:15:42.246898 [debug] [MainThread]: Command `dbt ls` succeeded at 16:15:42.246651 after 3.56 seconds
[0m16:15:42.247966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787dcdcad540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787dccbf1540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787dad3544c0>]}
[0m16:15:42.249108 [debug] [MainThread]: Flushing usage events
[0m16:15:44.401084 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:18:30.866878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e06c74ad510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e06c6450730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e06c64506d0>]}


============================== 16:18:30.870175 | 39d857c4-bb53-43ce-9b86-8f2dc2b12d91 ==============================
[0m16:18:30.870175 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:18:30.871283 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'version_check': 'True', 'write_json': 'True', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'debug': 'False', 'log_path': '/home/dunhan/dbt_project/logs', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'cache_selected_only': 'False', 'profiles_dir': '/home/dunhan/.dbt', 'quiet': 'False', 'target_path': 'None'}
[0m16:18:33.592287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39d857c4-bb53-43ce-9b86-8f2dc2b12d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e06c6c09b70>]}
[0m16:18:33.680443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39d857c4-bb53-43ce-9b86-8f2dc2b12d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e06c7357c70>]}
[0m16:18:33.681408 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:18:33.974323 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m16:18:34.143610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:18:34.144300 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:18:34.206499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39d857c4-bb53-43ce-9b86-8f2dc2b12d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e06a6a58130>]}
[0m16:18:34.334299 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m16:18:34.336712 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m16:18:34.350732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39d857c4-bb53-43ce-9b86-8f2dc2b12d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e06a6a00730>]}
[0m16:18:34.351543 [info ] [MainThread]: Found 3 models, 4 data tests, 495 macros
[0m16:18:34.352335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39d857c4-bb53-43ce-9b86-8f2dc2b12d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e06a6a01a50>]}
[0m16:18:34.354685 [info ] [MainThread]: 
[0m16:18:34.355419 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:18:34.356183 [info ] [MainThread]: 
[0m16:18:34.357084 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:18:34.363721 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m16:18:34.364502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:35.183214 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now list_symmetric-fin-469415-q9_glamira_data_2025)
[0m16:18:35.184249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:18:35.960634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39d857c4-bb53-43ce-9b86-8f2dc2b12d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e06c8f3ed70>]}
[0m16:18:35.961510 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:18:35.967044 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m16:18:35.967966 [info ] [Thread-1 (]: 1 of 3 START sql table model glamira_data_2025.my_first_dbt_model .............. [RUN]
[0m16:18:35.968777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025, now model.dbt_project.my_first_dbt_model)
[0m16:18:35.969438 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m16:18:35.983654 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m16:18:35.985471 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m16:18:36.011974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:18:36.928380 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m16:18:36.929620 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025`.`my_first_dbt_model`
      
    
    

    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m16:18:37.543699 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:0e258833-75fd-49e2-8b2a-fa010ae90cd1&page=queryresults
[0m16:18:39.756781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39d857c4-bb53-43ce-9b86-8f2dc2b12d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e06c8226110>]}
[0m16:18:39.757967 [info ] [Thread-1 (]: 1 of 3 OK created sql table model glamira_data_2025.my_first_dbt_model ......... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.79s]
[0m16:18:39.759028 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m16:18:39.759677 [debug] [Thread-1 (]: Began running node model.dbt_project.test
[0m16:18:39.760778 [info ] [Thread-1 (]: 2 of 3 START sql table model glamira_data_2025.test ............................ [RUN]
[0m16:18:39.761561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.my_first_dbt_model, now model.dbt_project.test)
[0m16:18:39.762181 [debug] [Thread-1 (]: Began compiling node model.dbt_project.test
[0m16:18:39.767123 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.test"
[0m16:18:39.768075 [debug] [Thread-1 (]: Began executing node model.dbt_project.test
[0m16:18:39.773218 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.test"
[0m16:18:39.774357 [debug] [Thread-1 (]: On model.dbt_project.test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.test"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025`.`test`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
 SELECT *
 FROM symmetric-fin-469415-q9.glamira_data_2025.summary
),


checkout_success AS (
 SELECT
   _id AS customer_id,
   ip AS ip_address,
   time_stamp AS date_id,
   local_time AS local_time,
   device_id AS device_id,
   email_address AS email_address,
   resolution AS resolution,
   user_id_db AS user_id_db,
   user_agent AS user_agent,
   referrer_url AS referrer_url
 FROM src
 WHERE collection = 'checkout_success'
)

SELECT * FROM checkout_success
    );
  
[0m16:18:39.775041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:18:40.836543 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:815bcd0a-3188-4bcd-b9f1-6070c7186178&page=queryresults
[0m16:18:44.156566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39d857c4-bb53-43ce-9b86-8f2dc2b12d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e06a6a588e0>]}
[0m16:18:44.157927 [info ] [Thread-1 (]: 2 of 3 OK created sql table model glamira_data_2025.test ....................... [[32mCREATE TABLE (26.1k rows, 13.0 GiB processed)[0m in 4.39s]
[0m16:18:44.159175 [debug] [Thread-1 (]: Finished running node model.dbt_project.test
[0m16:18:44.159946 [debug] [Thread-1 (]: Began running node model.dbt_project.my_second_dbt_model
[0m16:18:44.160743 [info ] [Thread-1 (]: 3 of 3 START sql view model glamira_data_2025.my_second_dbt_model .............. [RUN]
[0m16:18:44.161646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.test, now model.dbt_project.my_second_dbt_model)
[0m16:18:44.162305 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_second_dbt_model
[0m16:18:44.170494 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_second_dbt_model"
[0m16:18:44.172228 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_second_dbt_model
[0m16:18:44.211982 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_second_dbt_model"
[0m16:18:44.213345 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */


  create or replace view `symmetric-fin-469415-q9`.`glamira_data_2025`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `symmetric-fin-469415-q9`.`glamira_data_2025`.`my_first_dbt_model`
where id = 1;


[0m16:18:44.214133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:18:45.180564 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:2a834bb7-66d0-4f53-96ae-bdb635d57f6e&page=queryresults
[0m16:18:45.842618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39d857c4-bb53-43ce-9b86-8f2dc2b12d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e06c8226110>]}
[0m16:18:45.843959 [info ] [Thread-1 (]: 3 of 3 OK created sql view model glamira_data_2025.my_second_dbt_model ......... [[32mCREATE VIEW (0 processed)[0m in 1.68s]
[0m16:18:45.845344 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_second_dbt_model
[0m16:18:45.847050 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:18:45.849318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:18:45.849897 [debug] [MainThread]: Connection 'model.dbt_project.my_second_dbt_model' was properly closed.
[0m16:18:45.850893 [info ] [MainThread]: 
[0m16:18:45.851975 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 11.49 seconds (11.49s).
[0m16:18:45.853996 [debug] [MainThread]: Command end result
[0m16:18:45.905187 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m16:18:45.908199 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m16:18:45.917719 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m16:18:45.918744 [info ] [MainThread]: 
[0m16:18:45.920168 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:18:45.921351 [info ] [MainThread]: 
[0m16:18:45.922116 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m16:18:45.923558 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.13594, "process_in_blocks": "0", "process_kernel_time": 0.428455, "process_mem_max_rss": "357048", "process_out_blocks": "2120", "process_user_time": 6.262044}
[0m16:18:45.924528 [debug] [MainThread]: Command `dbt run` succeeded at 16:18:45.924363 after 15.14 seconds
[0m16:18:45.925246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e06c74ad510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e06a6a5a3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e06c667ac80>]}
[0m16:18:45.926204 [debug] [MainThread]: Flushing usage events
[0m16:18:47.274482 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:19:03.803885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f1f03e14e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f1ef3846d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f1ef384670>]}


============================== 16:19:03.807484 | d12d848f-56ec-4f3f-b86a-2fcfe7c30533 ==============================
[0m16:19:03.807484 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:19:03.808385 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/dunhan/.dbt', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'no_print': 'None', 'use_colors': 'True', 'write_json': 'True', 'log_format': 'default', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'introspect': 'True', 'target_path': 'None', 'quiet': 'False', 'debug': 'False', 'log_path': '/home/dunhan/dbt_project/logs', 'version_check': 'True'}
[0m16:19:06.522465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd12d848f-56ec-4f3f-b86a-2fcfe7c30533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f1ef32f9d0>]}
[0m16:19:06.612633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd12d848f-56ec-4f3f-b86a-2fcfe7c30533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f1d0055ff0>]}
[0m16:19:06.613662 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:19:07.016349 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m16:19:07.188982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:19:07.189545 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:19:07.250716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd12d848f-56ec-4f3f-b86a-2fcfe7c30533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f1cfa90130>]}
[0m16:19:07.374427 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m16:19:07.377169 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m16:19:07.391333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd12d848f-56ec-4f3f-b86a-2fcfe7c30533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f1cfa0d660>]}
[0m16:19:07.392604 [info ] [MainThread]: Found 3 models, 4 data tests, 495 macros
[0m16:19:07.393454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd12d848f-56ec-4f3f-b86a-2fcfe7c30533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f1cfa7e200>]}
[0m16:19:07.396231 [info ] [MainThread]: 
[0m16:19:07.397034 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:19:07.397686 [info ] [MainThread]: 
[0m16:19:07.398750 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:19:07.409773 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m16:19:07.411112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:08.226645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now list_symmetric-fin-469415-q9_glamira_data_2025)
[0m16:19:08.227526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:09.185282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd12d848f-56ec-4f3f-b86a-2fcfe7c30533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f1f1ee1d20>]}
[0m16:19:09.186069 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:09.191440 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m16:19:09.192532 [info ] [Thread-1 (]: 1 of 3 START sql table model glamira_data_2025.my_first_dbt_model .............. [RUN]
[0m16:19:09.193346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025, now model.dbt_project.my_first_dbt_model)
[0m16:19:09.193981 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m16:19:09.210906 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m16:19:09.212216 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m16:19:09.239121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:10.073107 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m16:19:10.074609 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025`.`my_first_dbt_model`
      
    
    

    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m16:19:10.620298 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:fb0318bc-60d5-46d7-9455-c598c2542d57&page=queryresults
[0m16:19:12.711053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd12d848f-56ec-4f3f-b86a-2fcfe7c30533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f1d2ec26e0>]}
[0m16:19:12.712188 [info ] [Thread-1 (]: 1 of 3 OK created sql table model glamira_data_2025.my_first_dbt_model ......... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.52s]
[0m16:19:12.713368 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m16:19:12.714068 [debug] [Thread-1 (]: Began running node model.dbt_project.test
[0m16:19:12.715681 [info ] [Thread-1 (]: 2 of 3 START sql table model glamira_data_2025.test ............................ [RUN]
[0m16:19:12.716791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.my_first_dbt_model, now model.dbt_project.test)
[0m16:19:12.717491 [debug] [Thread-1 (]: Began compiling node model.dbt_project.test
[0m16:19:12.724555 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.test"
[0m16:19:12.726231 [debug] [Thread-1 (]: Began executing node model.dbt_project.test
[0m16:19:12.730944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:13.631367 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.test"
[0m16:19:13.632442 [debug] [Thread-1 (]: On model.dbt_project.test: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.test"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025`.`test`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
 SELECT *
 FROM symmetric-fin-469415-q9.glamira_data_2025.summary
),


checkout_success AS (
 SELECT
   _id AS customer_id,
   ip AS ip_address,
   time_stamp AS date_id,
   local_time AS local_time,
   device_id AS device_id,
   email_address AS email_address,
   resolution AS resolution,
   user_id_db AS user_id_db,
   user_agent AS user_agent,
   referrer_url AS referrer_url
 FROM src
 WHERE collection = 'checkout_success'
)

SELECT * FROM checkout_success
    );
  
[0m16:19:14.356735 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:cc0d4fd1-3aba-43f6-bb6f-beb023234cb6&page=queryresults
[0m16:19:17.490053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd12d848f-56ec-4f3f-b86a-2fcfe7c30533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f1cf9d3c10>]}
[0m16:19:17.491450 [info ] [Thread-1 (]: 2 of 3 OK created sql table model glamira_data_2025.test ....................... [[32mCREATE TABLE (26.1k rows, 13.0 GiB processed)[0m in 4.77s]
[0m16:19:17.493195 [debug] [Thread-1 (]: Finished running node model.dbt_project.test
[0m16:19:17.494709 [debug] [Thread-1 (]: Began running node model.dbt_project.my_second_dbt_model
[0m16:19:17.495951 [info ] [Thread-1 (]: 3 of 3 START sql view model glamira_data_2025.my_second_dbt_model .............. [RUN]
[0m16:19:17.497432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.test, now model.dbt_project.my_second_dbt_model)
[0m16:19:17.498726 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_second_dbt_model
[0m16:19:17.504861 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_second_dbt_model"
[0m16:19:17.506007 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_second_dbt_model
[0m16:19:17.541623 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_second_dbt_model"
[0m16:19:17.542734 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */


  create or replace view `symmetric-fin-469415-q9`.`glamira_data_2025`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `symmetric-fin-469415-q9`.`glamira_data_2025`.`my_first_dbt_model`
where id = 1;


[0m16:19:17.543455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:18.480002 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:20b1c9ea-8ea4-4c93-8919-50f2cdee20d1&page=queryresults
[0m16:19:19.123162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd12d848f-56ec-4f3f-b86a-2fcfe7c30533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f1cfc98ee0>]}
[0m16:19:19.124287 [info ] [Thread-1 (]: 3 of 3 OK created sql view model glamira_data_2025.my_second_dbt_model ......... [[32mCREATE VIEW (0 processed)[0m in 1.63s]
[0m16:19:19.125411 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_second_dbt_model
[0m16:19:19.127170 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:19:19.129312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:19.129965 [debug] [MainThread]: Connection 'model.dbt_project.my_second_dbt_model' was properly closed.
[0m16:19:19.131172 [info ] [MainThread]: 
[0m16:19:19.132423 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 11.73 seconds (11.73s).
[0m16:19:19.135272 [debug] [MainThread]: Command end result
[0m16:19:19.196741 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m16:19:19.200076 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m16:19:19.210322 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m16:19:19.210916 [info ] [MainThread]: 
[0m16:19:19.211825 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:19:19.212665 [info ] [MainThread]: 
[0m16:19:19.213800 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m16:19:19.215604 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.489456, "process_in_blocks": "0", "process_kernel_time": 0.498332, "process_mem_max_rss": "357144", "process_out_blocks": "2120", "process_user_time": 6.339224}
[0m16:19:19.216532 [debug] [MainThread]: Command `dbt run` succeeded at 16:19:19.216364 after 15.49 seconds
[0m16:19:19.217388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f1f03e14e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f1ef32f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f1cfa4c460>]}
[0m16:19:19.218581 [debug] [MainThread]: Flushing usage events
[0m16:19:21.291899 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:01:03.367003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db87b4a95d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db87a44c760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db87a44c700>]}


============================== 20:01:03.370760 | a8fd0421-5059-4f98-85f4-287b169a13ec ==============================
[0m20:01:03.370760 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:01:03.372175 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt ', 'use_colors': 'True', 'partial_parse': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'log_path': '/home/dunhan/dbt_project/logs', 'log_format': 'default', 'log_cache_events': 'False', 'debug': 'False', 'printer_width': '80', 'profiles_dir': '/home/dunhan/.dbt', 'warn_error': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'introspect': 'True', 'empty': 'None'}
[0m20:01:03.542526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8fd0421-5059-4f98-85f4-287b169a13ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db87a44c790>]}
[0m20:01:03.559707 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:01:03.561071 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:01:03.563219 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.2928337, "process_in_blocks": "392", "process_kernel_time": 0.111562, "process_mem_max_rss": "96288", "process_out_blocks": "16", "process_user_time": 2.185437}
[0m20:01:03.563955 [debug] [MainThread]: Command `cli deps` succeeded at 20:01:03.563821 after 0.29 seconds
[0m20:01:03.564572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db87b4a95d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db87a44c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db87a44cac0>]}
[0m20:01:03.565532 [debug] [MainThread]: Flushing usage events
[0m20:01:05.588659 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:44:29.184537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788f80fb9570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788f7ff586d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788f7ff58670>]}


============================== 19:44:29.192072 | fc1a48c8-7c42-46af-9781-190f2aafd969 ==============================
[0m19:44:29.192072 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:44:29.194308 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt ', 'profiles_dir': '/home/dunhan/.dbt', 'log_path': '/home/dunhan/dbt_project/logs', 'fail_fast': 'False', 'partial_parse': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'empty': 'None', 'debug': 'False', 'use_colors': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'introspect': 'True', 'warn_error': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80'}
[0m19:44:29.506704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc1a48c8-7c42-46af-9781-190f2aafd969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788f7ff59d20>]}
[0m19:44:29.549019 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:44:29.550632 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:44:29.558405 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5234459, "process_in_blocks": "392", "process_kernel_time": 0.139843, "process_mem_max_rss": "96332", "process_out_blocks": "8", "process_user_time": 2.47256}
[0m19:44:29.559665 [debug] [MainThread]: Command `cli deps` succeeded at 19:44:29.559443 after 0.52 seconds
[0m19:44:29.562064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788f80fb9570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788f7ff59d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x788f7ff58640>]}
[0m19:44:29.563313 [debug] [MainThread]: Flushing usage events
[0m19:44:32.538003 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:41:15.311776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7554315b55d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755430554730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7554305546d0>]}


============================== 15:41:15.321162 | 4e5304d8-e6ac-4a84-bc80-7b3cdfe880cf ==============================
[0m15:41:15.321162 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:41:15.322840 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'empty': 'None', 'debug': 'False', 'log_path': '/home/dunhan/dbt_project/logs', 'printer_width': '80', 'target_path': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/dunhan/.dbt', 'static_parser': 'True', 'invocation_command': 'dbt ', 'version_check': 'True', 'use_colors': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error': 'None', 'introspect': 'True', 'partial_parse': 'True', 'write_json': 'True'}
[0m15:41:15.695571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e5304d8-e6ac-4a84-bc80-7b3cdfe880cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755433020cd0>]}
[0m15:41:15.734981 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:41:15.738488 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:41:15.742226 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6063372, "process_in_blocks": "392", "process_kernel_time": 0.19885, "process_mem_max_rss": "95996", "process_out_blocks": "8", "process_user_time": 3.216982}
[0m15:41:15.744019 [debug] [MainThread]: Command `cli deps` succeeded at 15:41:15.743214 after 0.61 seconds
[0m15:41:15.745631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7554315b55d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755433020cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7554302cc610>]}
[0m15:41:15.747487 [debug] [MainThread]: Flushing usage events
[0m15:41:17.885103 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:09:24.766383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a169c9b1510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a169b950670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a169b950610>]}


============================== 17:09:24.771462 | 9f0052c8-0113-46f3-816e-d5efe61962c9 ==============================
[0m17:09:24.771462 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:09:24.772769 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'static_parser': 'True', 'use_colors': 'True', 'version_check': 'True', 'write_json': 'True', 'target_path': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'log_path': '/home/dunhan/dbt_project/logs', 'partial_parse': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt ', 'profiles_dir': '/home/dunhan/.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'debug': 'False'}
[0m17:09:24.949806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f0052c8-0113-46f3-816e-d5efe61962c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a169e457cd0>]}
[0m17:09:24.969866 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:09:24.971789 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:09:24.975715 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.30672047, "process_in_blocks": "392", "process_kernel_time": 0.141704, "process_mem_max_rss": "96404", "process_out_blocks": "16", "process_user_time": 2.310185}
[0m17:09:24.976894 [debug] [MainThread]: Command `cli deps` succeeded at 17:09:24.976624 after 0.31 seconds
[0m17:09:24.978117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a169c9b1510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a169e457cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a169b6e1570>]}
[0m17:09:24.979215 [debug] [MainThread]: Flushing usage events
[0m17:09:27.220031 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:52.476922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716020891540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71601f8108b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71601f810850>]}


============================== 17:11:52.480563 | 68cc400a-d687-4c12-8284-301ebc88c00a ==============================
[0m17:11:52.480563 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:11:52.481558 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/dunhan/dbt_project/logs', 'use_experimental_parser': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'target_path': 'None', 'write_json': 'True', 'warn_error': 'None', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'printer_width': '80', 'profiles_dir': '/home/dunhan/.dbt', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'fail_fast': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'version_check': 'True'}
[0m17:11:55.206208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68cc400a-d687-4c12-8284-301ebc88c00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7160004681f0>]}
[0m17:11:55.293666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68cc400a-d687-4c12-8284-301ebc88c00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71601fa3a230>]}
[0m17:11:55.294720 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:11:55.593133 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m17:11:55.755660 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:11:55.756398 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:11:55.809957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68cc400a-d687-4c12-8284-301ebc88c00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715fffe8c130>]}
[0m17:11:55.934945 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m17:11:55.939050 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m17:11:55.971075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68cc400a-d687-4c12-8284-301ebc88c00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715ffffe2770>]}
[0m17:11:55.972015 [info ] [MainThread]: Found 4 models, 3 sources, 495 macros
[0m17:11:55.974913 [info ] [MainThread]: 
[0m17:11:55.975580 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:11:55.976328 [info ] [MainThread]: 
[0m17:11:55.977256 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:11:55.986651 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m17:11:55.988283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:56.887771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now create_symmetric-fin-469415-q9_glamira_data_2025_staging)
[0m17:11:56.888765 [debug] [ThreadPool]: Creating schema "database: "symmetric-fin-469415-q9"
schema: "glamira_data_2025_staging"
"
[0m17:11:56.902739 [debug] [ThreadPool]: On create_symmetric-fin-469415-q9_glamira_data_2025_staging: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_symmetric-fin-469415-q9_glamira_data_2025_staging"} */
create schema if not exists `symmetric-fin-469415-q9`.`glamira_data_2025_staging`
  
[0m17:11:56.903405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:58.363943 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:893a3787-cec9-4c44-8247-015e43d4804e&page=queryresults
[0m17:11:59.433000 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_symmetric-fin-469415-q9_glamira_data_2025_staging, now list_symmetric-fin-469415-q9_glamira_data_2025_staging)
[0m17:11:59.433783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:00.236156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68cc400a-d687-4c12-8284-301ebc88c00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716020052ec0>]}
[0m17:12:00.237033 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:00.244525 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_customer
[0m17:12:00.245480 [info ] [Thread-1 (]: 1 of 4 START sql table model glamira_data_2025_staging.stag_customer ........... [RUN]
[0m17:12:00.246749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_staging, now model.dbt_project.stag_customer)
[0m17:12:00.247466 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_customer
[0m17:12:00.263145 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_customer"
[0m17:12:00.265001 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_customer
[0m17:12:00.324951 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_customer"
[0m17:12:00.326398 [debug] [Thread-1 (]: On model.dbt_project.stag_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


checkout_success AS (
  SELECT
    _id AS customer_id,
    device_id AS device_id,
    email_address AS email_address,
    resolution AS resolution,
    user_id_db AS user_id_db,
    user_agent AS user_agent 
  FROM src
  WHERE collection = 'checkout_success'
)

SELECT * FROM checkout_success
    );
  
[0m17:12:00.327268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:01.440976 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:285155cc-80af-41b9-ac0b-4d47220f2642&page=queryresults
[0m17:12:05.139039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68cc400a-d687-4c12-8284-301ebc88c00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715fffd162c0>]}
[0m17:12:05.140263 [info ] [Thread-1 (]: 1 of 4 OK created sql table model glamira_data_2025_staging.stag_customer ...... [[32mCREATE TABLE (26.1k rows, 8.8 GiB processed)[0m in 4.87s]
[0m17:12:05.141556 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_customer
[0m17:12:05.142289 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_location
[0m17:12:05.143146 [info ] [Thread-1 (]: 2 of 4 START sql table model glamira_data_2025_staging.stag_location ........... [RUN]
[0m17:12:05.143984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_customer, now model.dbt_project.stag_location)
[0m17:12:05.144591 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_location
[0m17:12:05.152319 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_location"
[0m17:12:05.153914 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_location
[0m17:12:05.160843 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_location"
[0m17:12:05.162593 [debug] [Thread-1 (]: On model.dbt_project.stag_location: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_location"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`location`
),


casted AS (
    SELECT
        GENERATE_UUID() as location_id,
        src.ip AS ip_address,
        src.city AS city_name, 
        src.country_short AS country_short_name,
        src.country_long AS country_long_name,  
        ROUND(CAST(src.latitude AS NUMERIC), 6) AS latitude,
        ROUND(CAST(src.longitude AS NUMERIC), 6) AS longitude,
        src.region AS region_name, 
        src.time_zone, 
        src.zip_code
    FROM src
)

SELECT * FROM casted
    );
  
[0m17:12:05.164144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:06.589706 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:23fd90df-59a9-4330-9bd9-6061f3bcfd53&page=queryresults
[0m17:12:07.301068 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:23fd90df-59a9-4330-9bd9-6061f3bcfd53&page=queryresults
[0m17:12:07.347724 [debug] [Thread-1 (]: Database Error in model stag_location (models/staging/stag_location.sql)
  Invalid NUMERIC value: INVALID IP ADDRESS
  compiled code at target/run/dbt_project/models/staging/stag_location.sql
[0m17:12:07.348822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68cc400a-d687-4c12-8284-301ebc88c00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715ffef60160>]}
[0m17:12:07.350914 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model glamira_data_2025_staging.stag_location .. [[31mERROR[0m in 2.20s]
[0m17:12:07.352037 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_location
[0m17:12:07.352835 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_product
[0m17:12:07.353816 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.stag_location' to be skipped because of status 'error'.  Reason: Database Error in model stag_location (models/staging/stag_location.sql)
  Invalid NUMERIC value: INVALID IP ADDRESS
  compiled code at target/run/dbt_project/models/staging/stag_location.sql.
[0m17:12:07.354813 [info ] [Thread-1 (]: 3 of 4 START sql table model glamira_data_2025_staging.stag_product ............ [RUN]
[0m17:12:07.356415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_location, now model.dbt_project.stag_product)
[0m17:12:07.357497 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_product
[0m17:12:07.364799 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_product"
[0m17:12:07.366065 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_product
[0m17:12:07.374880 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_product"
[0m17:12:07.376698 [debug] [Thread-1 (]: On model.dbt_project.stag_product: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_product"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`product_name`
),

casted AS (
 SELECT
   src.product_id AS product_id,
   src.name AS product_name,
   src.sku AS sku,
   src.gender AS gender,
   src.max_price_format AS max_price_format,
   src.min_price_format AS max_price_format,
   src.type_id AS type_id,
   src.store_code AS store_code
 FROM src
)

SELECT * FROM casted;
    );
  
[0m17:12:07.378132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:08.496260 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:1c458f29-88dd-49c1-9a78-53aeb11b6543&page=queryresults
[0m17:12:08.497859 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:1c458f29-88dd-49c1-9a78-53aeb11b6543&page=queryresults
[0m17:12:08.507282 [debug] [Thread-1 (]: Database Error in model stag_product (models/staging/stag_product.sql)
  Syntax error: Expected ")" but got ";" at [35:21]
  compiled code at target/run/dbt_project/models/staging/stag_product.sql
[0m17:12:08.509218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68cc400a-d687-4c12-8284-301ebc88c00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715ffef63d30>]}
[0m17:12:08.511542 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model glamira_data_2025_staging.stag_product ... [[31mERROR[0m in 1.15s]
[0m17:12:08.516989 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_product
[0m17:12:08.520055 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_sales
[0m17:12:08.521633 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.stag_product' to be skipped because of status 'error'.  Reason: Database Error in model stag_product (models/staging/stag_product.sql)
  Syntax error: Expected ")" but got ";" at [35:21]
  compiled code at target/run/dbt_project/models/staging/stag_product.sql.
[0m17:12:08.523899 [info ] [Thread-1 (]: 4 of 4 START sql table model glamira_data_2025_staging.stag_sales .............. [RUN]
[0m17:12:08.529435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_product, now model.dbt_project.stag_sales)
[0m17:12:08.532352 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_sales
[0m17:12:08.546035 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_sales"
[0m17:12:08.549101 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_sales
[0m17:12:08.571504 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_sales"
[0m17:12:08.595368 [debug] [Thread-1 (]: On model.dbt_project.stag_sales: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_sales"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


flattened AS (
 SELECT
   GENERATE_UUID() as sales_id,
   src.order_id AS order_id,
   src._id AS customer_id,
   src.time_stamp AS date_id,
   src.ip AS ip_address,
   CAST(src.store_id AS INT64) AS store_id,
   cp.product_id AS product_id,
   cp.amount AS amount,
   cp.currency AS currency,
   cp.price AS price,
 FROM src,
 UNNEST(src.cart_products) AS cp
)


SELECT * FROM flattened;
    );
  
[0m17:12:08.597717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:09.552962 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:f243ced4-4041-439c-b8f8-aa23444bb392&page=queryresults
[0m17:12:09.554075 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:f243ced4-4041-439c-b8f8-aa23444bb392&page=queryresults
[0m17:12:09.560801 [debug] [Thread-1 (]: Database Error in model stag_sales (models/staging/stag_sales.sql)
  Syntax error: Expected ")" but got ";" at [40:24]
  compiled code at target/run/dbt_project/models/staging/stag_sales.sql
[0m17:12:09.562564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68cc400a-d687-4c12-8284-301ebc88c00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715fff066890>]}
[0m17:12:09.564518 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model glamira_data_2025_staging.stag_sales ..... [[31mERROR[0m in 1.04s]
[0m17:12:09.566662 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_sales
[0m17:12:09.568440 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.stag_sales' to be skipped because of status 'error'.  Reason: Database Error in model stag_sales (models/staging/stag_sales.sql)
  Syntax error: Expected ")" but got ";" at [40:24]
  compiled code at target/run/dbt_project/models/staging/stag_sales.sql.
[0m17:12:09.571015 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:12:09.575249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:09.576742 [debug] [MainThread]: Connection 'model.dbt_project.stag_sales' was properly closed.
[0m17:12:09.578250 [info ] [MainThread]: 
[0m17:12:09.582094 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 13.60 seconds (13.60s).
[0m17:12:09.590439 [debug] [MainThread]: Command end result
[0m17:12:09.681035 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m17:12:09.684083 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m17:12:09.694279 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m17:12:09.695177 [info ] [MainThread]: 
[0m17:12:09.696174 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m17:12:09.697209 [info ] [MainThread]: 
[0m17:12:09.698185 [error] [MainThread]: [31mFailure in model stag_location (models/staging/stag_location.sql)[0m
[0m17:12:09.699210 [error] [MainThread]:   Database Error in model stag_location (models/staging/stag_location.sql)
  Invalid NUMERIC value: INVALID IP ADDRESS
  compiled code at target/run/dbt_project/models/staging/stag_location.sql
[0m17:12:09.700205 [info ] [MainThread]: 
[0m17:12:09.701152 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/staging/stag_location.sql
[0m17:12:09.702277 [info ] [MainThread]: 
[0m17:12:09.705033 [error] [MainThread]: [31mFailure in model stag_product (models/staging/stag_product.sql)[0m
[0m17:12:09.706509 [error] [MainThread]:   Database Error in model stag_product (models/staging/stag_product.sql)
  Syntax error: Expected ")" but got ";" at [35:21]
  compiled code at target/run/dbt_project/models/staging/stag_product.sql
[0m17:12:09.707829 [info ] [MainThread]: 
[0m17:12:09.709167 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/staging/stag_product.sql
[0m17:12:09.710357 [info ] [MainThread]: 
[0m17:12:09.711825 [error] [MainThread]: [31mFailure in model stag_sales (models/staging/stag_sales.sql)[0m
[0m17:12:09.713281 [error] [MainThread]:   Database Error in model stag_sales (models/staging/stag_sales.sql)
  Syntax error: Expected ")" but got ";" at [40:24]
  compiled code at target/run/dbt_project/models/staging/stag_sales.sql
[0m17:12:09.714369 [info ] [MainThread]: 
[0m17:12:09.715583 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/staging/stag_sales.sql
[0m17:12:09.716769 [info ] [MainThread]: 
[0m17:12:09.717811 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=4
[0m17:12:09.720087 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 17.318785, "process_in_blocks": "4080", "process_kernel_time": 0.421223, "process_mem_max_rss": "357956", "process_out_blocks": "2152", "process_user_time": 6.736587}
[0m17:12:09.721659 [debug] [MainThread]: Command `dbt build` failed at 17:12:09.721353 after 17.32 seconds
[0m17:12:09.722917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716020891540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7160004681f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715ffffe0340>]}
[0m17:12:09.724090 [debug] [MainThread]: Flushing usage events
[0m17:12:11.854240 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:13:22.693188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab18b14e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab0850850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab08507f0>]}


============================== 17:13:22.699528 | 07e02115-45cb-4c63-bbfa-7dd08e8e3f36 ==============================
[0m17:13:22.699528 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:13:22.700919 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/dunhan/dbt_project/logs', 'empty': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'log_format': 'default', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'quiet': 'False', 'printer_width': '80', 'invocation_command': 'dbt build', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/home/dunhan/.dbt'}
[0m17:13:26.637620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07e02115-45cb-4c63-bbfa-7dd08e8e3f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab3354f70>]}
[0m17:13:26.733123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07e02115-45cb-4c63-bbfa-7dd08e8e3f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9141a680>]}
[0m17:13:26.734050 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:13:27.088421 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m17:13:27.294632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:13:27.295751 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:13:27.357416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07e02115-45cb-4c63-bbfa-7dd08e8e3f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a90ea8130>]}
[0m17:13:27.535218 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m17:13:27.538952 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m17:13:27.580829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07e02115-45cb-4c63-bbfa-7dd08e8e3f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a90e8f820>]}
[0m17:13:27.581865 [info ] [MainThread]: Found 4 models, 3 sources, 495 macros
[0m17:13:27.585035 [info ] [MainThread]: 
[0m17:13:27.586132 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:13:27.587153 [info ] [MainThread]: 
[0m17:13:27.588594 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:13:27.601263 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m17:13:27.602757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:28.468076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now list_symmetric-fin-469415-q9_glamira_data_2025_staging)
[0m17:13:28.468858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:13:29.325114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07e02115-45cb-4c63-bbfa-7dd08e8e3f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a91020910>]}
[0m17:13:29.325997 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:13:29.331399 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_customer
[0m17:13:29.332779 [info ] [Thread-1 (]: 1 of 4 START sql table model glamira_data_2025_staging.stag_customer ........... [RUN]
[0m17:13:29.333813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_staging, now model.dbt_project.stag_customer)
[0m17:13:29.334630 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_customer
[0m17:13:29.353488 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_customer"
[0m17:13:29.354760 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_customer
[0m17:13:29.376572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:13:30.170752 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_customer"
[0m17:13:30.172013 [debug] [Thread-1 (]: On model.dbt_project.stag_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


checkout_success AS (
  SELECT
    _id AS customer_id,
    device_id AS device_id,
    email_address AS email_address,
    resolution AS resolution,
    user_id_db AS user_id_db,
    user_agent AS user_agent 
  FROM src
  WHERE collection = 'checkout_success'
)

SELECT * FROM checkout_success
    );
  
[0m17:13:31.172162 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:5793d91c-6655-4a57-ba5a-f85b91f4fed4&page=queryresults
[0m17:13:36.012880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07e02115-45cb-4c63-bbfa-7dd08e8e3f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9428e7d0>]}
[0m17:13:36.014138 [info ] [Thread-1 (]: 1 of 4 OK created sql table model glamira_data_2025_staging.stag_customer ...... [[32mCREATE TABLE (26.1k rows, 8.8 GiB processed)[0m in 6.68s]
[0m17:13:36.015243 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_customer
[0m17:13:36.016035 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_location
[0m17:13:36.016984 [info ] [Thread-1 (]: 2 of 4 START sql table model glamira_data_2025_staging.stag_location ........... [RUN]
[0m17:13:36.017907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_customer, now model.dbt_project.stag_location)
[0m17:13:36.018563 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_location
[0m17:13:36.024714 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_location"
[0m17:13:36.026384 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_location
[0m17:13:36.034961 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_location"
[0m17:13:36.035967 [debug] [Thread-1 (]: On model.dbt_project.stag_location: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_location"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`location`
),


casted AS (
    SELECT
        GENERATE_UUID() as location_id,
        src.ip AS ip_address,
        src.city AS city_name, 
        src.country_short AS country_short_name,
        src.country_long AS country_long_name,  
        ROUND(CAST(src.latitude AS NUMERIC), 6) AS latitude,
        ROUND(CAST(src.longitude AS NUMERIC), 6) AS longitude,
        src.region AS region_name, 
        src.time_zone, 
        src.zip_code
    FROM src
)

SELECT * FROM casted
    );
  
[0m17:13:36.036978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:13:37.070072 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:dbb6fefb-d544-408f-9843-7b4709ab5da0&page=queryresults
[0m17:13:37.734060 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:dbb6fefb-d544-408f-9843-7b4709ab5da0&page=queryresults
[0m17:13:37.741118 [debug] [Thread-1 (]: Database Error in model stag_location (models/staging/stag_location.sql)
  Invalid NUMERIC value: IPV6 ADDRESS MISSING IN IPV4 BIN
  compiled code at target/run/dbt_project/models/staging/stag_location.sql
[0m17:13:37.742080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07e02115-45cb-4c63-bbfa-7dd08e8e3f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8a7c25c0>]}
[0m17:13:37.743102 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model glamira_data_2025_staging.stag_location .. [[31mERROR[0m in 1.72s]
[0m17:13:37.744515 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_location
[0m17:13:37.745345 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_product
[0m17:13:37.746153 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.stag_location' to be skipped because of status 'error'.  Reason: Database Error in model stag_location (models/staging/stag_location.sql)
  Invalid NUMERIC value: IPV6 ADDRESS MISSING IN IPV4 BIN
  compiled code at target/run/dbt_project/models/staging/stag_location.sql.
[0m17:13:37.747038 [info ] [Thread-1 (]: 3 of 4 START sql table model glamira_data_2025_staging.stag_product ............ [RUN]
[0m17:13:37.748404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_location, now model.dbt_project.stag_product)
[0m17:13:37.749254 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_product
[0m17:13:37.759944 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_product"
[0m17:13:37.762113 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_product
[0m17:13:37.772548 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_product"
[0m17:13:37.773794 [debug] [Thread-1 (]: On model.dbt_project.stag_product: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_product"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`product_name`
),

casted AS (
 SELECT
   src.product_id AS product_id,
   src.name AS product_name,
   src.sku AS sku,
   src.gender AS gender,
   src.max_price_format AS max_price_format,
   src.min_price_format AS max_price_format,
   src.type_id AS type_id,
   src.store_code AS store_code
 FROM src
)

SELECT * FROM casted
    );
  
[0m17:13:37.774584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:13:38.809595 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:25626ecc-fff5-4282-a649-2b7fdba5083e&page=queryresults
[0m17:13:39.135107 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:25626ecc-fff5-4282-a649-2b7fdba5083e&page=queryresults
[0m17:13:39.139771 [debug] [Thread-1 (]: Database Error in model stag_product (models/staging/stag_product.sql)
  CREATE TABLE has columns with duplicate name max_price_format at [17:1]
  compiled code at target/run/dbt_project/models/staging/stag_product.sql
[0m17:13:39.140666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07e02115-45cb-4c63-bbfa-7dd08e8e3f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8a5af9a0>]}
[0m17:13:39.142070 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model glamira_data_2025_staging.stag_product ... [[31mERROR[0m in 1.39s]
[0m17:13:39.143413 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_product
[0m17:13:39.144115 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_sales
[0m17:13:39.144906 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.stag_product' to be skipped because of status 'error'.  Reason: Database Error in model stag_product (models/staging/stag_product.sql)
  CREATE TABLE has columns with duplicate name max_price_format at [17:1]
  compiled code at target/run/dbt_project/models/staging/stag_product.sql.
[0m17:13:39.145803 [info ] [Thread-1 (]: 4 of 4 START sql table model glamira_data_2025_staging.stag_sales .............. [RUN]
[0m17:13:39.147072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_product, now model.dbt_project.stag_sales)
[0m17:13:39.148378 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_sales
[0m17:13:39.156783 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_sales"
[0m17:13:39.158222 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_sales
[0m17:13:39.163870 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_sales"
[0m17:13:39.165866 [debug] [Thread-1 (]: On model.dbt_project.stag_sales: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_sales"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


flattened AS (
 SELECT
   GENERATE_UUID() as sales_id,
   src.order_id AS order_id,
   src._id AS customer_id,
   src.time_stamp AS date_id,
   src.ip AS ip_address,
   CAST(src.store_id AS INT64) AS store_id,
   cp.product_id AS product_id,
   cp.amount AS amount,
   cp.currency AS currency,
   cp.price AS price,
 FROM src,
 UNNEST(src.cart_products) AS cp
)


SELECT * FROM flattened
    );
  
[0m17:13:39.166820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:13:40.490653 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:e0b63f6f-e0d0-4160-a385-e05dd930e731&page=queryresults
[0m17:13:46.572970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07e02115-45cb-4c63-bbfa-7dd08e8e3f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8a5af9a0>]}
[0m17:13:46.574221 [info ] [Thread-1 (]: 4 of 4 OK created sql table model glamira_data_2025_staging.stag_sales ......... [[32mCREATE TABLE (822.4k rows, 2.0 GiB processed)[0m in 7.43s]
[0m17:13:46.575390 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_sales
[0m17:13:46.577067 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:13:46.579259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:13:46.579852 [debug] [MainThread]: Connection 'model.dbt_project.stag_sales' was properly closed.
[0m17:13:46.580808 [info ] [MainThread]: 
[0m17:13:46.581890 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 18.99 seconds (18.99s).
[0m17:13:46.585416 [debug] [MainThread]: Command end result
[0m17:13:46.635352 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m17:13:46.637949 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m17:13:46.648825 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m17:13:46.649470 [info ] [MainThread]: 
[0m17:13:46.650409 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:13:46.651330 [info ] [MainThread]: 
[0m17:13:46.652350 [error] [MainThread]: [31mFailure in model stag_location (models/staging/stag_location.sql)[0m
[0m17:13:46.653262 [error] [MainThread]:   Database Error in model stag_location (models/staging/stag_location.sql)
  Invalid NUMERIC value: IPV6 ADDRESS MISSING IN IPV4 BIN
  compiled code at target/run/dbt_project/models/staging/stag_location.sql
[0m17:13:46.654136 [info ] [MainThread]: 
[0m17:13:46.655130 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/staging/stag_location.sql
[0m17:13:46.655989 [info ] [MainThread]: 
[0m17:13:46.656944 [error] [MainThread]: [31mFailure in model stag_product (models/staging/stag_product.sql)[0m
[0m17:13:46.657781 [error] [MainThread]:   Database Error in model stag_product (models/staging/stag_product.sql)
  CREATE TABLE has columns with duplicate name max_price_format at [17:1]
  compiled code at target/run/dbt_project/models/staging/stag_product.sql
[0m17:13:46.658635 [info ] [MainThread]: 
[0m17:13:46.659936 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/staging/stag_product.sql
[0m17:13:46.660938 [info ] [MainThread]: 
[0m17:13:46.661952 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=4
[0m17:13:46.663879 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 24.091497, "process_in_blocks": "0", "process_kernel_time": 0.504896, "process_mem_max_rss": "357740", "process_out_blocks": "2152", "process_user_time": 7.783327}
[0m17:13:46.665447 [debug] [MainThread]: Command `dbt build` failed at 17:13:46.665125 after 24.09 seconds
[0m17:13:46.666686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ab18b14e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a90e77c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9141a680>]}
[0m17:13:46.667767 [debug] [MainThread]: Flushing usage events
[0m17:13:48.196148 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:24:14.685300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c9b54bd480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c9b445c820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c9b445c7c0>]}


============================== 17:24:14.689814 | 78e6ed88-d3e6-4428-a3a7-fd00dff83774 ==============================
[0m17:24:14.689814 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:24:14.690935 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'static_parser': 'True', 'use_colors': 'True', 'debug': 'False', 'introspect': 'True', 'log_format': 'default', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/dunhan/dbt_project/logs', 'profiles_dir': '/home/dunhan/.dbt', 'write_json': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'quiet': 'False', 'invocation_command': 'dbt build', 'partial_parse': 'True', 'target_path': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'empty': 'False'}
[0m17:24:18.139932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78e6ed88-d3e6-4428-a3a7-fd00dff83774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c9b6f2bfa0>]}
[0m17:24:18.237497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78e6ed88-d3e6-4428-a3a7-fd00dff83774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c9b44063b0>]}
[0m17:24:18.238572 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:24:18.584207 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m17:24:18.794798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:24:18.795892 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:24:18.866651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78e6ed88-d3e6-4428-a3a7-fd00dff83774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c994ab0130>]}
[0m17:24:18.999793 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m17:24:19.001977 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m17:24:19.027870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78e6ed88-d3e6-4428-a3a7-fd00dff83774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c994a040d0>]}
[0m17:24:19.028669 [info ] [MainThread]: Found 4 models, 3 sources, 495 macros
[0m17:24:19.031487 [info ] [MainThread]: 
[0m17:24:19.032190 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:24:19.033178 [info ] [MainThread]: 
[0m17:24:19.034380 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:24:19.044755 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m17:24:19.045809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:20.001953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now list_symmetric-fin-469415-q9_glamira_data_2025_staging)
[0m17:24:20.003117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:20.810479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78e6ed88-d3e6-4428-a3a7-fd00dff83774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c9b601b4c0>]}
[0m17:24:20.811448 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:24:20.817287 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_customer
[0m17:24:20.818321 [info ] [Thread-1 (]: 1 of 4 START sql table model glamira_data_2025_staging.stag_customer ........... [RUN]
[0m17:24:20.819367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_staging, now model.dbt_project.stag_customer)
[0m17:24:20.820243 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_customer
[0m17:24:20.838202 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_customer"
[0m17:24:20.840384 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_customer
[0m17:24:20.896240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:21.824778 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_customer"
[0m17:24:21.826623 [debug] [Thread-1 (]: On model.dbt_project.stag_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


checkout_success AS (
  SELECT
    _id AS customer_id,
    device_id AS device_id,
    email_address AS email_address,
    resolution AS resolution,
    user_id_db AS user_id_db,
    user_agent AS user_agent 
  FROM src
  WHERE collection = 'checkout_success'
)

SELECT * FROM checkout_success
    );
  
[0m17:24:22.835562 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:b40e90d9-0b52-4644-8398-20c6a5cf06a2&page=queryresults
[0m17:24:25.609482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78e6ed88-d3e6-4428-a3a7-fd00dff83774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c997e966e0>]}
[0m17:24:25.610850 [info ] [Thread-1 (]: 1 of 4 OK created sql table model glamira_data_2025_staging.stag_customer ...... [[32mCREATE TABLE (26.1k rows, 8.8 GiB processed)[0m in 4.79s]
[0m17:24:25.613489 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_customer
[0m17:24:25.614466 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_location
[0m17:24:25.615476 [info ] [Thread-1 (]: 2 of 4 START sql table model glamira_data_2025_staging.stag_location ........... [RUN]
[0m17:24:25.616630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_customer, now model.dbt_project.stag_location)
[0m17:24:25.617722 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_location
[0m17:24:25.623107 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_location"
[0m17:24:25.624096 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_location
[0m17:24:25.632435 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_location"
[0m17:24:25.634429 [debug] [Thread-1 (]: On model.dbt_project.stag_location: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_location"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`location`
),


casted AS (
    SELECT
        GENERATE_UUID() as location_id,
        src.ip AS ip_address,
        src.city AS city_name, 
        src.country_short AS country_short_name,
        src.country_long AS country_long_name,  
        ROUND(SAFE_CAST(src.latitude AS NUMERIC), 6) AS latitude,
        ROUND(SAFE_CAST(src.longitude AS NUMERIC), 6) AS longitude,
        src.region AS region_name, 
        src.time_zone, 
        src.zip_code
    FROM src
)

SELECT * FROM casted
    );
  
[0m17:24:25.635358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:26.777445 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:0cb21b39-9b9b-419e-9531-d9a71c961a31&page=queryresults
[0m17:24:32.500285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78e6ed88-d3e6-4428-a3a7-fd00dff83774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c9927388e0>]}
[0m17:24:32.501695 [info ] [Thread-1 (]: 2 of 4 OK created sql table model glamira_data_2025_staging.stag_location ...... [[32mCREATE TABLE (3.2m rows, 289.2 MiB processed)[0m in 6.88s]
[0m17:24:32.503183 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_location
[0m17:24:32.504178 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_product
[0m17:24:32.506125 [info ] [Thread-1 (]: 3 of 4 START sql table model glamira_data_2025_staging.stag_product ............ [RUN]
[0m17:24:32.508257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_location, now model.dbt_project.stag_product)
[0m17:24:32.509698 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_product
[0m17:24:32.520278 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_product"
[0m17:24:32.522013 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_product
[0m17:24:32.530806 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_product"
[0m17:24:32.532303 [debug] [Thread-1 (]: On model.dbt_project.stag_product: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_product"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`product_name`
),

casted AS (
 SELECT
   src.product_id AS product_id,
   src.name AS product_name,
   src.sku AS sku,
   src.gender AS gender,
   src.max_price_format AS max_price_format,
   src.min_price_format AS min_price_format,
   src.type_id AS type_id,
   src.store_code AS store_code
 FROM src
)

SELECT * FROM casted
    );
  
[0m17:24:32.533446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:33.642178 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:7abf8341-b458-4232-bcb7-322b8cbe760c&page=queryresults
[0m17:24:36.058982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78e6ed88-d3e6-4428-a3a7-fd00dff83774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c997e966e0>]}
[0m17:24:36.061015 [info ] [Thread-1 (]: 3 of 4 OK created sql table model glamira_data_2025_staging.stag_product ....... [[32mCREATE TABLE (18.8k rows, 1.8 MiB processed)[0m in 3.55s]
[0m17:24:36.062420 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_product
[0m17:24:36.063351 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_sales
[0m17:24:36.064275 [info ] [Thread-1 (]: 4 of 4 START sql table model glamira_data_2025_staging.stag_sales .............. [RUN]
[0m17:24:36.065233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_product, now model.dbt_project.stag_sales)
[0m17:24:36.065953 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_sales
[0m17:24:36.072064 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_sales"
[0m17:24:36.073170 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_sales
[0m17:24:36.079206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:36.825048 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_sales"
[0m17:24:36.826621 [debug] [Thread-1 (]: On model.dbt_project.stag_sales: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_sales"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


flattened AS (
 SELECT
   GENERATE_UUID() as sales_id,
   src.order_id AS order_id,
   src._id AS customer_id,
   src.time_stamp AS date_id,
   src.ip AS ip_address,
   CAST(src.store_id AS INT64) AS store_id,
   cp.product_id AS product_id,
   cp.amount AS amount,
   cp.currency AS currency,
   cp.price AS price,
 FROM src,
 UNNEST(src.cart_products) AS cp
)


SELECT * FROM flattened
    );
  
[0m17:24:37.457250 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:2cfd375e-6c25-48c4-b220-0e8a0fbacd72&page=queryresults
[0m17:24:44.218077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78e6ed88-d3e6-4428-a3a7-fd00dff83774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c992427970>]}
[0m17:24:44.219443 [info ] [Thread-1 (]: 4 of 4 OK created sql table model glamira_data_2025_staging.stag_sales ......... [[32mCREATE TABLE (822.4k rows, 2.0 GiB processed)[0m in 8.15s]
[0m17:24:44.220745 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_sales
[0m17:24:44.222537 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:24:44.224847 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:44.225471 [debug] [MainThread]: Connection 'model.dbt_project.stag_sales' was properly closed.
[0m17:24:44.226788 [info ] [MainThread]: 
[0m17:24:44.227742 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 25.19 seconds (25.19s).
[0m17:24:44.231145 [debug] [MainThread]: Command end result
[0m17:24:44.289521 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m17:24:44.292133 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m17:24:44.303411 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m17:24:44.304069 [info ] [MainThread]: 
[0m17:24:44.304854 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:24:44.305512 [info ] [MainThread]: 
[0m17:24:44.306237 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m17:24:44.307573 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 29.716827, "process_in_blocks": "0", "process_kernel_time": 0.491541, "process_mem_max_rss": "356456", "process_out_blocks": "2152", "process_user_time": 7.4766}
[0m17:24:44.308368 [debug] [MainThread]: Command `dbt build` succeeded at 17:24:44.308238 after 29.72 seconds
[0m17:24:44.309074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c9b54bd480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c9b5391b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c9b44063b0>]}
[0m17:24:44.310011 [debug] [MainThread]: Flushing usage events
[0m17:24:46.283943 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:25:41.532808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb3cefad4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb3cdf486d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb3cdf48670>]}


============================== 17:25:41.536333 | a7f6f367-dec0-4f7c-9dc1-14b2d610ab79 ==============================
[0m17:25:41.536333 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:25:41.537656 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'target_path': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'static_parser': 'True', 'empty': 'False', 'version_check': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'log_path': '/home/dunhan/dbt_project/logs', 'warn_error': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'use_colors': 'True', 'invocation_command': 'dbt run', 'profiles_dir': '/home/dunhan/.dbt', 'debug': 'False'}
[0m17:25:44.304617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7f6f367-dec0-4f7c-9dc1-14b2d610ab79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb3d0a5bfa0>]}
[0m17:25:44.402705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7f6f367-dec0-4f7c-9dc1-14b2d610ab79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb3aeb16680>]}
[0m17:25:44.403712 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:25:44.711703 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m17:25:44.878218 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:25:44.878842 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:25:44.932303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7f6f367-dec0-4f7c-9dc1-14b2d610ab79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb3ae5a4130>]}
[0m17:25:45.051639 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m17:25:45.053978 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m17:25:45.069044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7f6f367-dec0-4f7c-9dc1-14b2d610ab79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb3ae5a7d90>]}
[0m17:25:45.070042 [info ] [MainThread]: Found 4 models, 3 sources, 495 macros
[0m17:25:45.070655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7f6f367-dec0-4f7c-9dc1-14b2d610ab79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb3ae6eab60>]}
[0m17:25:45.073241 [info ] [MainThread]: 
[0m17:25:45.073923 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:25:45.074464 [info ] [MainThread]: 
[0m17:25:45.075315 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:25:45.086861 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m17:25:45.087804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:45.891969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now list_symmetric-fin-469415-q9_glamira_data_2025_staging)
[0m17:25:45.892810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:46.638541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7f6f367-dec0-4f7c-9dc1-14b2d610ab79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb3d0a3dd20>]}
[0m17:25:46.639373 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:25:46.644719 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_customer
[0m17:25:46.645757 [info ] [Thread-1 (]: 1 of 4 START sql table model glamira_data_2025_staging.stag_customer ........... [RUN]
[0m17:25:46.646689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_staging, now model.dbt_project.stag_customer)
[0m17:25:46.647428 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_customer
[0m17:25:46.671231 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_customer"
[0m17:25:46.673155 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_customer
[0m17:25:46.699560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:47.539167 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_customer"
[0m17:25:47.540311 [debug] [Thread-1 (]: On model.dbt_project.stag_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


checkout_success AS (
  SELECT
    _id AS customer_id,
    device_id AS device_id,
    email_address AS email_address,
    resolution AS resolution,
    user_id_db AS user_id_db,
    user_agent AS user_agent 
  FROM src
  WHERE collection = 'checkout_success'
)

SELECT * FROM checkout_success
    );
  
[0m17:25:48.193056 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:78af8bda-edfe-4dae-b148-088d3340aed5&page=queryresults
[0m17:25:51.244328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7f6f367-dec0-4f7c-9dc1-14b2d610ab79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb3b198a800>]}
[0m17:25:51.245978 [info ] [Thread-1 (]: 1 of 4 OK created sql table model glamira_data_2025_staging.stag_customer ...... [[32mCREATE TABLE (26.1k rows, 8.8 GiB processed)[0m in 4.60s]
[0m17:25:51.247354 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_customer
[0m17:25:51.248055 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_location
[0m17:25:51.248983 [info ] [Thread-1 (]: 2 of 4 START sql table model glamira_data_2025_staging.stag_location ........... [RUN]
[0m17:25:51.249920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_customer, now model.dbt_project.stag_location)
[0m17:25:51.250828 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_location
[0m17:25:51.259993 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_location"
[0m17:25:51.261779 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_location
[0m17:25:51.272245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:52.059033 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_location"
[0m17:25:52.060538 [debug] [Thread-1 (]: On model.dbt_project.stag_location: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_location"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`location`
),


casted AS (
    SELECT
        GENERATE_UUID() as location_id,
        src.ip AS ip_address,
        src.city AS city_name, 
        src.country_short AS country_short_name,
        src.country_long AS country_long_name,  
        ROUND(SAFE_CAST(src.latitude AS NUMERIC), 6) AS latitude,
        ROUND(SAFE_CAST(src.longitude AS NUMERIC), 6) AS longitude,
        src.region AS region_name, 
        src.time_zone, 
        src.zip_code
    FROM src
)

SELECT * FROM casted
    );
  
[0m17:25:52.728962 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:365701be-2f8d-4d2b-bd85-dd7b5f37c6d7&page=queryresults
[0m17:25:57.516476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7f6f367-dec0-4f7c-9dc1-14b2d610ab79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb3ae930bb0>]}
[0m17:25:57.517587 [info ] [Thread-1 (]: 2 of 4 OK created sql table model glamira_data_2025_staging.stag_location ...... [[32mCREATE TABLE (3.2m rows, 289.2 MiB processed)[0m in 6.27s]
[0m17:25:57.518937 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_location
[0m17:25:57.519583 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_product
[0m17:25:57.520701 [info ] [Thread-1 (]: 3 of 4 START sql table model glamira_data_2025_staging.stag_product ............ [RUN]
[0m17:25:57.522025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_location, now model.dbt_project.stag_product)
[0m17:25:57.523213 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_product
[0m17:25:57.531914 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_product"
[0m17:25:57.670773 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_product
[0m17:25:57.675060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:58.446783 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_product"
[0m17:25:58.447974 [debug] [Thread-1 (]: On model.dbt_project.stag_product: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_product"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`product_name`
),

casted AS (
 SELECT
   src.product_id AS product_id,
   src.name AS product_name,
   src.sku AS sku,
   src.gender AS gender,
   src.max_price_format AS max_price_format,
   src.min_price_format AS min_price_format,
   src.type_id AS type_id,
   src.store_code AS store_code
 FROM src
)

SELECT * FROM casted
    );
  
[0m17:25:59.161126 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:b9df0feb-290d-4ac0-bdcc-0d5499ea78cc&page=queryresults
[0m17:26:01.582201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7f6f367-dec0-4f7c-9dc1-14b2d610ab79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb3ae930bb0>]}
[0m17:26:01.583397 [info ] [Thread-1 (]: 3 of 4 OK created sql table model glamira_data_2025_staging.stag_product ....... [[32mCREATE TABLE (18.8k rows, 1.8 MiB processed)[0m in 4.06s]
[0m17:26:01.584638 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_product
[0m17:26:01.585524 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_sales
[0m17:26:01.586769 [info ] [Thread-1 (]: 4 of 4 START sql table model glamira_data_2025_staging.stag_sales .............. [RUN]
[0m17:26:01.587776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_product, now model.dbt_project.stag_sales)
[0m17:26:01.588476 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_sales
[0m17:26:01.594645 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_sales"
[0m17:26:01.595580 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_sales
[0m17:26:01.601368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:02.365516 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_sales"
[0m17:26:02.366783 [debug] [Thread-1 (]: On model.dbt_project.stag_sales: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_sales"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


flattened AS (
 SELECT
   GENERATE_UUID() as sales_id,
   src.order_id AS order_id,
   src._id AS customer_id,
   src.time_stamp AS date_id,
   src.ip AS ip_address,
   CAST(src.store_id AS INT64) AS store_id,
   cp.product_id AS product_id,
   cp.amount AS amount,
   cp.currency AS currency,
   cp.price AS price,
 FROM src,
 UNNEST(src.cart_products) AS cp
)


SELECT * FROM flattened
    );
  
[0m17:26:02.952121 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:fa925be8-dad0-4e0b-9715-cab25e2c56ad&page=queryresults
[0m17:26:08.358895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7f6f367-dec0-4f7c-9dc1-14b2d610ab79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb3ae930bb0>]}
[0m17:26:08.360360 [info ] [Thread-1 (]: 4 of 4 OK created sql table model glamira_data_2025_staging.stag_sales ......... [[32mCREATE TABLE (822.4k rows, 2.0 GiB processed)[0m in 6.77s]
[0m17:26:08.361981 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_sales
[0m17:26:08.363934 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:26:08.366390 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:08.367407 [debug] [MainThread]: Connection 'model.dbt_project.stag_sales' was properly closed.
[0m17:26:08.368359 [info ] [MainThread]: 
[0m17:26:08.369374 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 23.29 seconds (23.29s).
[0m17:26:08.371666 [debug] [MainThread]: Command end result
[0m17:26:08.431430 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m17:26:08.434082 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m17:26:08.446143 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m17:26:08.446795 [info ] [MainThread]: 
[0m17:26:08.447541 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:26:08.448150 [info ] [MainThread]: 
[0m17:26:08.449075 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m17:26:08.450491 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 27.001484, "process_in_blocks": "0", "process_kernel_time": 0.49094, "process_mem_max_rss": "355828", "process_out_blocks": "2144", "process_user_time": 6.643665}
[0m17:26:08.452032 [debug] [MainThread]: Command `dbt run` succeeded at 17:26:08.451770 after 27.00 seconds
[0m17:26:08.452807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb3cefad4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb3ae97d630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb3aeb16680>]}
[0m17:26:08.453741 [debug] [MainThread]: Flushing usage events
[0m17:26:10.598740 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:33:19.034890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc89a9ad540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc899948760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc899948700>]}


============================== 17:33:19.038167 | 3b7dd058-df1f-445e-9d98-f7c0ac2e31e7 ==============================
[0m17:33:19.038167 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:33:19.039159 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'log_path': '/home/dunhan/dbt_project/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'profiles_dir': '/home/dunhan/.dbt', 'no_print': 'None', 'warn_error': 'None', 'partial_parse': 'True', 'empty': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'quiet': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'target_path': 'None', 'version_check': 'True'}
[0m17:33:22.225821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b7dd058-df1f-445e-9d98-f7c0ac2e31e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc89c420dc0>]}
[0m17:33:22.312158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b7dd058-df1f-445e-9d98-f7c0ac2e31e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc87d38c820>]}
[0m17:33:22.313178 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:33:22.668260 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m17:33:22.838250 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:33:22.839607 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:33:22.902143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b7dd058-df1f-445e-9d98-f7c0ac2e31e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc879fa8130>]}
[0m17:33:23.044966 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m17:33:23.047728 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m17:33:23.065558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b7dd058-df1f-445e-9d98-f7c0ac2e31e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc879fa80a0>]}
[0m17:33:23.066467 [info ] [MainThread]: Found 4 models, 3 sources, 495 macros
[0m17:33:23.067390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b7dd058-df1f-445e-9d98-f7c0ac2e31e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc879fa82b0>]}
[0m17:33:23.070095 [info ] [MainThread]: 
[0m17:33:23.070801 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:33:23.071391 [info ] [MainThread]: 
[0m17:33:23.072275 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:33:23.079570 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m17:33:23.080366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:24.097669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now list_symmetric-fin-469415-q9_glamira_data_2025_staging)
[0m17:33:24.099300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:24.837894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b7dd058-df1f-445e-9d98-f7c0ac2e31e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc89b686830>]}
[0m17:33:24.838659 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:33:24.846775 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_customer
[0m17:33:24.847625 [info ] [Thread-1 (]: 1 of 4 START sql table model glamira_data_2025_staging.stag_customer ........... [RUN]
[0m17:33:24.848549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_staging, now model.dbt_project.stag_customer)
[0m17:33:24.849266 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_customer
[0m17:33:24.867062 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_customer"
[0m17:33:24.869464 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_customer
[0m17:33:24.892161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:25.781102 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_customer"
[0m17:33:25.784920 [debug] [Thread-1 (]: On model.dbt_project.stag_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


checkout_success AS (
  SELECT
    _id AS customer_id,
    device_id AS device_id,
    email_address AS email_address,
    resolution AS resolution,
    user_id_db AS user_id_db,
    user_agent AS user_agent 
  FROM src
  WHERE collection = 'checkout_success'
)

SELECT * FROM checkout_success
    );
  
[0m17:33:26.478798 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:865fe6d6-c3e1-4f67-ab7b-68abca918ee0&page=queryresults
[0m17:33:31.733727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b7dd058-df1f-445e-9d98-f7c0ac2e31e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc87d38e800>]}
[0m17:33:31.735086 [info ] [Thread-1 (]: 1 of 4 OK created sql table model glamira_data_2025_staging.stag_customer ...... [[32mCREATE TABLE (26.1k rows, 8.8 GiB processed)[0m in 6.88s]
[0m17:33:31.736090 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_customer
[0m17:33:31.736765 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_location
[0m17:33:31.737733 [info ] [Thread-1 (]: 2 of 4 START sql table model glamira_data_2025_staging.stag_location ........... [RUN]
[0m17:33:31.738507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_customer, now model.dbt_project.stag_location)
[0m17:33:31.739275 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_location
[0m17:33:31.744206 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_location"
[0m17:33:31.746936 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_location
[0m17:33:31.755866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:32.505671 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_location"
[0m17:33:32.507498 [debug] [Thread-1 (]: On model.dbt_project.stag_location: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_location"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`location`
),


casted AS (
    SELECT
        GENERATE_UUID() as location_id,
        src.ip AS ip_address,
        src.city AS city_name, 
        src.country_short AS country_short_name,
        src.country_long AS country_long_name,  
        ROUND(SAFE_CAST(src.latitude AS NUMERIC), 6) AS latitude,
        ROUND(SAFE_CAST(src.longitude AS NUMERIC), 6) AS longitude,
        src.region AS region_name, 
        src.time_zone, 
        src.zip_code
    FROM src
)

SELECT * FROM casted
    );
  
[0m17:33:33.133081 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:349e7cbc-90a5-42a1-b285-3e1fab385d87&page=queryresults
[0m17:33:37.889423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b7dd058-df1f-445e-9d98-f7c0ac2e31e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc87a596a10>]}
[0m17:33:37.890956 [info ] [Thread-1 (]: 2 of 4 OK created sql table model glamira_data_2025_staging.stag_location ...... [[32mCREATE TABLE (3.2m rows, 289.2 MiB processed)[0m in 6.15s]
[0m17:33:37.893313 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_location
[0m17:33:37.894732 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_product
[0m17:33:37.896283 [info ] [Thread-1 (]: 3 of 4 START sql table model glamira_data_2025_staging.stag_product ............ [RUN]
[0m17:33:37.897939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_location, now model.dbt_project.stag_product)
[0m17:33:37.899252 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_product
[0m17:33:37.907439 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_product"
[0m17:33:37.909751 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_product
[0m17:33:37.920849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:38.731268 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_product"
[0m17:33:38.732824 [debug] [Thread-1 (]: On model.dbt_project.stag_product: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_product"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`product_name`
),

casted AS (
 SELECT
   src.product_id AS product_id,
   src.name AS product_name,
   src.sku AS sku,
   src.gender AS gender,
   src.max_price_format AS max_price_format,
   src.min_price_format AS min_price_format,
   src.type_id AS type_id,
   src.store_code AS store_code
 FROM src
)

SELECT * FROM casted
    );
  
[0m17:33:39.391104 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:9ee3d143-f048-45c5-b2b4-b4cd147d0db4&page=queryresults
[0m17:33:41.761794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b7dd058-df1f-445e-9d98-f7c0ac2e31e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc89aca2e30>]}
[0m17:33:41.763091 [info ] [Thread-1 (]: 3 of 4 OK created sql table model glamira_data_2025_staging.stag_product ....... [[32mCREATE TABLE (18.8k rows, 1.8 MiB processed)[0m in 3.86s]
[0m17:33:41.764187 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_product
[0m17:33:41.764872 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_sales
[0m17:33:41.765711 [info ] [Thread-1 (]: 4 of 4 START sql table model glamira_data_2025_staging.stag_sales .............. [RUN]
[0m17:33:41.766581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_product, now model.dbt_project.stag_sales)
[0m17:33:41.767245 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_sales
[0m17:33:41.774485 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_sales"
[0m17:33:41.778979 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_sales
[0m17:33:41.785927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:42.540200 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_sales"
[0m17:33:42.557507 [debug] [Thread-1 (]: On model.dbt_project.stag_sales: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_sales"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


flattened AS (
 SELECT
   GENERATE_UUID() as sales_id,
   src.order_id AS order_id,
   src._id AS customer_id,
   src.time_stamp AS date_id,
   src.ip AS ip_address,
   CAST(src.store_id AS INT64) AS store_id,
   cp.product_id AS product_id,
   cp.amount AS amount,
   cp.currency AS currency,
   cp.price AS price,
 FROM src,
 UNNEST(src.cart_products) AS cp
)


SELECT * FROM flattened
    );
  
[0m17:33:43.167143 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:5849a944-465e-4cad-962d-ee87d487da7e&page=queryresults
[0m17:33:52.274775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b7dd058-df1f-445e-9d98-f7c0ac2e31e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc89aca2e30>]}
[0m17:33:52.275960 [info ] [Thread-1 (]: 4 of 4 OK created sql table model glamira_data_2025_staging.stag_sales ......... [[32mCREATE TABLE (822.4k rows, 2.0 GiB processed)[0m in 10.51s]
[0m17:33:52.276976 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_sales
[0m17:33:52.278529 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:33:52.280582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:52.281163 [debug] [MainThread]: Connection 'model.dbt_project.stag_sales' was properly closed.
[0m17:33:52.281830 [info ] [MainThread]: 
[0m17:33:52.282743 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 29.21 seconds (29.21s).
[0m17:33:52.284685 [debug] [MainThread]: Command end result
[0m17:33:52.338213 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m17:33:52.341279 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m17:33:52.371492 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m17:33:52.372278 [info ] [MainThread]: 
[0m17:33:52.373160 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:33:52.373950 [info ] [MainThread]: 
[0m17:33:52.375008 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m17:33:52.376856 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 33.41921, "process_in_blocks": "6088", "process_kernel_time": 0.481425, "process_mem_max_rss": "355880", "process_out_blocks": "2152", "process_user_time": 6.853345}
[0m17:33:52.377847 [debug] [MainThread]: Command `dbt run` succeeded at 17:33:52.377602 after 33.42 seconds
[0m17:33:52.378627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc89a9ad540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc89a86f1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc87d38c820>]}
[0m17:33:52.379940 [debug] [MainThread]: Flushing usage events
[0m17:33:54.561615 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:36:33.110277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadb50b5540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadb4054790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadb4054730>]}


============================== 17:36:33.115945 | a37edabb-96c6-46c3-8bea-2828f9f50735 ==============================
[0m17:36:33.115945 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:36:33.117334 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'version_check': 'True', 'introspect': 'True', 'log_path': '/home/dunhan/dbt_project/logs', 'cache_selected_only': 'False', 'profiles_dir': '/home/dunhan/.dbt', 'empty': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'partial_parse': 'True', 'quiet': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'warn_error': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'use_colors': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run'}
[0m17:36:36.342295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a37edabb-96c6-46c3-8bea-2828f9f50735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad94ce2a70>]}
[0m17:36:36.487929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a37edabb-96c6-46c3-8bea-2828f9f50735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad94c5c1f0>]}
[0m17:36:36.489464 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:36:36.828094 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m17:36:36.995039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:36:36.995908 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:36:37.058493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a37edabb-96c6-46c3-8bea-2828f9f50735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad946aa830>]}
[0m17:36:37.234316 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m17:36:37.236686 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m17:36:37.259536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a37edabb-96c6-46c3-8bea-2828f9f50735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad94600160>]}
[0m17:36:37.261866 [info ] [MainThread]: Found 4 models, 3 sources, 495 macros
[0m17:36:37.263585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a37edabb-96c6-46c3-8bea-2828f9f50735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad946038b0>]}
[0m17:36:37.268343 [info ] [MainThread]: 
[0m17:36:37.269532 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:36:37.270567 [info ] [MainThread]: 
[0m17:36:37.271993 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:36:37.283259 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m17:36:37.284384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:38.166340 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9_glamira_data_2025_staging'
[0m17:36:38.167407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:38.932388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a37edabb-96c6-46c3-8bea-2828f9f50735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadb6b39f30>]}
[0m17:36:38.933546 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:36:38.941561 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_customer
[0m17:36:38.943419 [info ] [Thread-1 (]: 1 of 4 START sql table model glamira_data_2025_staging.stag_customer ........... [RUN]
[0m17:36:38.944333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_staging, now model.dbt_project.stag_customer)
[0m17:36:38.945008 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_customer
[0m17:36:38.967778 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_customer"
[0m17:36:38.969226 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_customer
[0m17:36:38.994482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:39.832125 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_customer"
[0m17:36:39.833374 [debug] [Thread-1 (]: On model.dbt_project.stag_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


checkout_success AS (
  SELECT
    _id AS customer_id,
    device_id AS device_id,
    email_address AS email_address,
    resolution AS resolution,
    user_id_db AS user_id_db,
    user_agent AS user_agent 
  FROM src
  WHERE collection = 'checkout_success'
)

SELECT * FROM checkout_success
    );
  
[0m17:36:40.640705 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:c8b5c32c-b78c-4fdc-bffa-816c08779a61&page=queryresults
[0m17:36:44.285944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a37edabb-96c6-46c3-8bea-2828f9f50735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad97a926e0>]}
[0m17:36:44.287424 [info ] [Thread-1 (]: 1 of 4 OK created sql table model glamira_data_2025_staging.stag_customer ...... [[32mCREATE TABLE (26.1k rows, 8.8 GiB processed)[0m in 5.34s]
[0m17:36:44.288595 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_customer
[0m17:36:44.289341 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_location
[0m17:36:44.290219 [info ] [Thread-1 (]: 2 of 4 START sql table model glamira_data_2025_staging.stag_location ........... [RUN]
[0m17:36:44.291125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_customer, now model.dbt_project.stag_location)
[0m17:36:44.291813 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_location
[0m17:36:44.299275 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_location"
[0m17:36:44.300876 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_location
[0m17:36:44.309250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:45.194428 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_location"
[0m17:36:45.195890 [debug] [Thread-1 (]: On model.dbt_project.stag_location: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_location"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`location`
),


casted AS (
    SELECT
        GENERATE_UUID() as location_id,
        src.ip AS ip_address,
        src.city AS city_name, 
        src.country_short AS country_short_name,
        src.country_long AS country_long_name,  
        ROUND(SAFE_CAST(src.latitude AS NUMERIC), 6) AS latitude,
        ROUND(SAFE_CAST(src.longitude AS NUMERIC), 6) AS longitude,
        src.region AS region_name, 
        src.time_zone, 
        src.zip_code
    FROM src
)

SELECT * FROM casted
    );
  
[0m17:36:45.880414 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:e2681ff1-b90c-4137-a0c3-68b9f8b68140&page=queryresults
[0m17:36:50.883630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a37edabb-96c6-46c3-8bea-2828f9f50735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad94a3a740>]}
[0m17:36:50.884832 [info ] [Thread-1 (]: 2 of 4 OK created sql table model glamira_data_2025_staging.stag_location ...... [[32mCREATE TABLE (3.2m rows, 289.2 MiB processed)[0m in 6.59s]
[0m17:36:50.885950 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_location
[0m17:36:50.886721 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_product
[0m17:36:50.887609 [info ] [Thread-1 (]: 3 of 4 START sql table model glamira_data_2025_staging.stag_product ............ [RUN]
[0m17:36:50.888467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_location, now model.dbt_project.stag_product)
[0m17:36:50.889111 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_product
[0m17:36:50.895586 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_product"
[0m17:36:50.896641 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_product
[0m17:36:50.900228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:51.664386 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_product"
[0m17:36:51.665525 [debug] [Thread-1 (]: On model.dbt_project.stag_product: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_product"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`product_name`
),

casted AS (
 SELECT
   src.product_id AS product_id,
   src.name AS product_name,
   src.sku AS sku,
   src.gender AS gender,
   src.max_price_format AS max_price_format,
   src.min_price_format AS min_price_format,
   src.type_id AS type_id,
   src.store_code AS store_code
 FROM src
)

SELECT * FROM casted
    );
  
[0m17:36:52.322143 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:6650430e-4606-467a-9305-e2edf0a0ddc3&page=queryresults
[0m17:36:54.990363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a37edabb-96c6-46c3-8bea-2828f9f50735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad94a3a740>]}
[0m17:36:54.991486 [info ] [Thread-1 (]: 3 of 4 OK created sql table model glamira_data_2025_staging.stag_product ....... [[32mCREATE TABLE (18.8k rows, 1.8 MiB processed)[0m in 4.10s]
[0m17:36:54.992606 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_product
[0m17:36:54.993370 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_sales
[0m17:36:54.994339 [info ] [Thread-1 (]: 4 of 4 START sql table model glamira_data_2025_staging.stag_sales .............. [RUN]
[0m17:36:54.995211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_product, now model.dbt_project.stag_sales)
[0m17:36:54.996129 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_sales
[0m17:36:55.001431 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_sales"
[0m17:36:55.002503 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_sales
[0m17:36:55.007162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:55.758658 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_sales"
[0m17:36:55.760056 [debug] [Thread-1 (]: On model.dbt_project.stag_sales: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_sales"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


flattened AS (
 SELECT
   GENERATE_UUID() as sales_id,
   CAST(src.order_id AS INT64) AS order_id,
   src._id AS customer_id,
   src.time_stamp AS date_id,
   src.ip AS ip_address,
   CAST(src.store_id AS INT64) AS store_id,
   cp.product_id AS product_id,
   cp.amount AS amount,
   cp.currency AS currency,
   cp.price AS price,
 FROM src,
 UNNEST(src.cart_products) AS cp
)


SELECT * FROM flattened
    );
  
[0m17:36:56.435375 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:3a60242c-63fb-4fb9-96aa-515b6599d7f6&page=queryresults
[0m17:37:02.881003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a37edabb-96c6-46c3-8bea-2828f9f50735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad947edff0>]}
[0m17:37:02.882268 [info ] [Thread-1 (]: 4 of 4 OK created sql table model glamira_data_2025_staging.stag_sales ......... [[32mCREATE TABLE (822.4k rows, 2.0 GiB processed)[0m in 7.89s]
[0m17:37:02.883445 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_sales
[0m17:37:02.885033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:37:02.887245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:37:02.887951 [debug] [MainThread]: Connection 'list_symmetric-fin-469415-q9' was properly closed.
[0m17:37:02.888632 [debug] [MainThread]: Connection 'model.dbt_project.stag_sales' was properly closed.
[0m17:37:02.889890 [info ] [MainThread]: 
[0m17:37:02.891033 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 25.62 seconds (25.62s).
[0m17:37:02.894245 [debug] [MainThread]: Command end result
[0m17:37:02.950540 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m17:37:02.953814 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m17:37:02.966810 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m17:37:02.967412 [info ] [MainThread]: 
[0m17:37:02.968494 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:37:02.969450 [info ] [MainThread]: 
[0m17:37:02.970882 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m17:37:02.973163 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 29.956202, "process_in_blocks": "0", "process_kernel_time": 0.478493, "process_mem_max_rss": "357664", "process_out_blocks": "2144", "process_user_time": 7.530024}
[0m17:37:02.974628 [debug] [MainThread]: Command `dbt run` succeeded at 17:37:02.974395 after 29.96 seconds
[0m17:37:02.975736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadb50b5540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadb405bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad94ce2a70>]}
[0m17:37:02.976454 [debug] [MainThread]: Flushing usage events
[0m17:37:04.599132 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:46:13.995556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75deebf794e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75deeaf006d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75deeaf00670>]}


============================== 17:46:13.999564 | 9e153b9e-af50-4395-ac29-b6404af2cefe ==============================
[0m17:46:13.999564 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:46:14.001152 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'no_print': 'None', 'quiet': 'False', 'use_colors': 'True', 'log_path': '/home/dunhan/dbt_project/logs', 'cache_selected_only': 'False', 'introspect': 'True', 'profiles_dir': '/home/dunhan/.dbt', 'empty': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'version_check': 'True', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run'}
[0m17:46:17.852195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e153b9e-af50-4395-ac29-b6404af2cefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75decbba6a10>]}
[0m17:46:17.945991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e153b9e-af50-4395-ac29-b6404af2cefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75decbb11ff0>]}
[0m17:46:17.946922 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:46:18.317454 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m17:46:18.539394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:46:18.540071 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:46:18.622810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e153b9e-af50-4395-ac29-b6404af2cefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75decb596740>]}
[0m17:46:18.788708 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m17:46:18.792602 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m17:46:18.808307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e153b9e-af50-4395-ac29-b6404af2cefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75decb6ff8e0>]}
[0m17:46:18.810415 [info ] [MainThread]: Found 4 models, 3 sources, 495 macros
[0m17:46:18.811947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e153b9e-af50-4395-ac29-b6404af2cefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75decb6ff910>]}
[0m17:46:18.814337 [info ] [MainThread]: 
[0m17:46:18.815026 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:46:18.815865 [info ] [MainThread]: 
[0m17:46:18.816888 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:46:18.823445 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m17:46:18.825170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:19.649557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now list_symmetric-fin-469415-q9_glamira_data_2025_staging)
[0m17:46:19.650941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:20.419042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e153b9e-af50-4395-ac29-b6404af2cefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75deeda05d20>]}
[0m17:46:20.419887 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:46:20.425297 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_customer
[0m17:46:20.426992 [info ] [Thread-1 (]: 1 of 4 START sql table model glamira_data_2025_staging.stag_customer ........... [RUN]
[0m17:46:20.428248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_staging, now model.dbt_project.stag_customer)
[0m17:46:20.428895 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_customer
[0m17:46:20.451821 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_customer"
[0m17:46:20.453157 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_customer
[0m17:46:20.476276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:21.310503 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_customer"
[0m17:46:21.312122 [debug] [Thread-1 (]: On model.dbt_project.stag_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


checkout_success AS (
  SELECT
    _id AS customer_id,
    device_id AS device_id,
    email_address AS email_address,
    resolution AS resolution,
    user_id_db AS user_id_db,
    user_agent AS user_agent 
  FROM src
  WHERE collection = 'checkout_success'
)

SELECT * FROM checkout_success
    );
  
[0m17:46:21.930551 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:f1a17262-322e-4399-b708-80e9a00174e8&page=queryresults
[0m17:46:24.529005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e153b9e-af50-4395-ac29-b6404af2cefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dece97e6e0>]}
[0m17:46:24.531124 [info ] [Thread-1 (]: 1 of 4 OK created sql table model glamira_data_2025_staging.stag_customer ...... [[32mCREATE TABLE (26.1k rows, 8.8 GiB processed)[0m in 4.10s]
[0m17:46:24.532966 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_customer
[0m17:46:24.534260 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_location
[0m17:46:24.535794 [info ] [Thread-1 (]: 2 of 4 START sql table model glamira_data_2025_staging.stag_location ........... [RUN]
[0m17:46:24.537418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_customer, now model.dbt_project.stag_location)
[0m17:46:24.538534 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_location
[0m17:46:24.547345 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_location"
[0m17:46:24.548951 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_location
[0m17:46:24.555822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:25.329266 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_location"
[0m17:46:25.330606 [debug] [Thread-1 (]: On model.dbt_project.stag_location: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_location"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`location`
),


casted AS (
    SELECT
        GENERATE_UUID() as location_id,
        src.ip AS ip_address,
        src.city AS city_name, 
        src.country_short AS country_short_name,
        src.country_long AS country_long_name,  
        ROUND(SAFE_CAST(src.latitude AS NUMERIC), 6) AS latitude,
        ROUND(SAFE_CAST(src.longitude AS NUMERIC), 6) AS longitude,
        src.region AS region_name, 
        src.time_zone, 
        src.zip_code
    FROM src
)

SELECT * FROM casted
    );
  
[0m17:46:25.981754 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:6e4c0c6c-3db5-423b-aac6-a2c05d371ab0&page=queryresults
[0m17:46:33.261212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e153b9e-af50-4395-ac29-b6404af2cefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75decb9266b0>]}
[0m17:46:33.262529 [info ] [Thread-1 (]: 2 of 4 OK created sql table model glamira_data_2025_staging.stag_location ...... [[32mCREATE TABLE (3.2m rows, 289.2 MiB processed)[0m in 8.72s]
[0m17:46:33.263750 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_location
[0m17:46:33.264425 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_product
[0m17:46:33.265362 [info ] [Thread-1 (]: 3 of 4 START sql table model glamira_data_2025_staging.stag_product ............ [RUN]
[0m17:46:33.266340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_location, now model.dbt_project.stag_product)
[0m17:46:33.267142 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_product
[0m17:46:33.272401 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_product"
[0m17:46:33.273439 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_product
[0m17:46:33.279090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:34.105789 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_product"
[0m17:46:34.107272 [debug] [Thread-1 (]: On model.dbt_project.stag_product: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_product"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`product_name`
),

casted AS (
 SELECT
   src.product_id AS product_id,
   src.name AS product_name,
   src.sku AS sku,
   src.gender AS gender,
   src.max_price_format AS max_price_format,
   src.min_price_format AS min_price_format,
   src.type_id AS type_id,
   src.store_code AS store_code
 FROM src
)

SELECT * FROM casted
    );
  
[0m17:46:34.745363 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:dc1415d1-b663-4969-9e43-2667e7ebaca0&page=queryresults
[0m17:46:36.926329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e153b9e-af50-4395-ac29-b6404af2cefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75decb9266b0>]}
[0m17:46:36.928165 [info ] [Thread-1 (]: 3 of 4 OK created sql table model glamira_data_2025_staging.stag_product ....... [[32mCREATE TABLE (18.8k rows, 1.8 MiB processed)[0m in 3.66s]
[0m17:46:36.929957 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_product
[0m17:46:36.930819 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_sales
[0m17:46:36.932312 [info ] [Thread-1 (]: 4 of 4 START sql table model glamira_data_2025_staging.stag_sales .............. [RUN]
[0m17:46:36.933582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_product, now model.dbt_project.stag_sales)
[0m17:46:36.934466 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_sales
[0m17:46:36.941641 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_sales"
[0m17:46:36.942776 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_sales
[0m17:46:36.947159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:37.729097 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_sales"
[0m17:46:37.730656 [debug] [Thread-1 (]: On model.dbt_project.stag_sales: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_sales"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


flattened AS (
 SELECT
   GENERATE_UUID() as sales_id,
   CAST(src.order_id AS INT64) AS order_id,
   src._id AS customer_id,
   src.time_stamp AS date_id,
   src.ip AS ip_address,
   src.time_stamp AS time_stamp,
   src.local_time AS local_time,
   CAST(src.store_id AS INT64) AS store_id,
   cp.product_id AS product_id,
   cp.amount AS amount,
   cp.currency AS currency_code,
   cp.price AS price,
 FROM src,
 UNNEST(src.cart_products) AS cp
)


SELECT * FROM flattened
    );
  
[0m17:46:38.299848 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:ef751fac-083c-4a61-a539-ef6b37fa45ac&page=queryresults
[0m17:46:43.525842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e153b9e-af50-4395-ac29-b6404af2cefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75decb6ff430>]}
[0m17:46:43.527917 [info ] [Thread-1 (]: 4 of 4 OK created sql table model glamira_data_2025_staging.stag_sales ......... [[32mCREATE TABLE (822.4k rows, 2.8 GiB processed)[0m in 6.59s]
[0m17:46:43.529277 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_sales
[0m17:46:43.532103 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:46:43.535507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:46:43.536202 [debug] [MainThread]: Connection 'model.dbt_project.stag_sales' was properly closed.
[0m17:46:43.537162 [info ] [MainThread]: 
[0m17:46:43.537987 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 24.72 seconds (24.72s).
[0m17:46:43.540762 [debug] [MainThread]: Command end result
[0m17:46:43.596219 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m17:46:43.599854 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m17:46:43.614145 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m17:46:43.614896 [info ] [MainThread]: 
[0m17:46:43.615916 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:46:43.616778 [info ] [MainThread]: 
[0m17:46:43.618010 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m17:46:43.620518 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 29.717339, "process_in_blocks": "0", "process_kernel_time": 0.545016, "process_mem_max_rss": "355696", "process_out_blocks": "2144", "process_user_time": 7.895259}
[0m17:46:43.622021 [debug] [MainThread]: Command `dbt run` succeeded at 17:46:43.621626 after 29.72 seconds
[0m17:46:43.623303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75deebf794e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75deebe4a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75decbba6a10>]}
[0m17:46:43.624509 [debug] [MainThread]: Flushing usage events
[0m17:46:45.597413 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:00:28.413363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e83271540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e821ec790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e821ec730>]}


============================== 18:00:28.418879 | 336847cc-cf5c-4358-b981-939e8b0c817b ==============================
[0m18:00:28.418879 [info ] [MainThread]: Running with dbt=1.10.11
[0m18:00:28.420489 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/home/dunhan/.dbt', 'version_check': 'True', 'log_format': 'default', 'write_json': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'empty': 'False', 'use_colors': 'True', 'debug': 'False', 'target_path': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'log_path': '/home/dunhan/dbt_project/logs', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run'}
[0m18:00:32.039606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '336847cc-cf5c-4358-b981-939e8b0c817b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e84d00dc0>]}
[0m18:00:32.135397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '336847cc-cf5c-4358-b981-939e8b0c817b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e62e250c0>]}
[0m18:00:32.136438 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:00:32.452663 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m18:00:32.710554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:00:32.711681 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:00:32.823035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '336847cc-cf5c-4358-b981-939e8b0c817b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e628d1150>]}
[0m18:00:33.020630 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m18:00:33.025360 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m18:00:33.049343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '336847cc-cf5c-4358-b981-939e8b0c817b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e628d36d0>]}
[0m18:00:33.050807 [info ] [MainThread]: Found 4 models, 15 data tests, 3 sources, 495 macros
[0m18:00:33.051939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '336847cc-cf5c-4358-b981-939e8b0c817b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e628d3820>]}
[0m18:00:33.057200 [info ] [MainThread]: 
[0m18:00:33.058904 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:33.060163 [info ] [MainThread]: 
[0m18:00:33.061438 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:00:33.071868 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m18:00:33.073312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:33.929600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now list_symmetric-fin-469415-q9_glamira_data_2025_staging)
[0m18:00:33.930702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:34.702168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '336847cc-cf5c-4358-b981-939e8b0c817b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e84ce9ba0>]}
[0m18:00:34.702956 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:00:34.708809 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_customer
[0m18:00:34.710072 [info ] [Thread-1 (]: 1 of 4 START sql table model glamira_data_2025_staging.stag_customer ........... [RUN]
[0m18:00:34.711268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_staging, now model.dbt_project.stag_customer)
[0m18:00:34.712138 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_customer
[0m18:00:34.728192 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_customer"
[0m18:00:34.729158 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_customer
[0m18:00:34.749081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:35.595378 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_customer"
[0m18:00:35.596854 [debug] [Thread-1 (]: On model.dbt_project.stag_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


checkout_success AS (
  SELECT
    _id AS customer_id,
    device_id AS device_id,
    email_address AS email_address,
    resolution AS resolution,
    user_id_db AS user_id_db,
    user_agent AS user_agent 
  FROM src
  WHERE collection = 'checkout_success'
)

SELECT * FROM checkout_success
    );
  
[0m18:00:36.366068 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:8774c650-6389-459e-a391-3d3dd69bfd8b&page=queryresults
[0m18:00:39.438317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '336847cc-cf5c-4358-b981-939e8b0c817b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e629f45e0>]}
[0m18:00:39.439594 [info ] [Thread-1 (]: 1 of 4 OK created sql table model glamira_data_2025_staging.stag_customer ...... [[32mCREATE TABLE (26.1k rows, 8.8 GiB processed)[0m in 4.72s]
[0m18:00:39.440787 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_customer
[0m18:00:39.441873 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_location
[0m18:00:39.443353 [info ] [Thread-1 (]: 2 of 4 START sql table model glamira_data_2025_staging.stag_location ........... [RUN]
[0m18:00:39.444644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_customer, now model.dbt_project.stag_location)
[0m18:00:39.445497 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_location
[0m18:00:39.451936 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_location"
[0m18:00:39.453068 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_location
[0m18:00:39.456351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:40.198019 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_location"
[0m18:00:40.199264 [debug] [Thread-1 (]: On model.dbt_project.stag_location: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_location"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`location`
),


casted AS (
    SELECT
        GENERATE_UUID() as location_id,
        src.ip AS ip_address,
        src.city AS city_name, 
        src.country_short AS country_short_name,
        src.country_long AS country_long_name,  
        ROUND(SAFE_CAST(src.latitude AS NUMERIC), 6) AS latitude,
        ROUND(SAFE_CAST(src.longitude AS NUMERIC), 6) AS longitude,
        src.region AS region_name, 
        src.time_zone, 
        src.zip_code
    FROM src
)

SELECT * FROM casted
    );
  
[0m18:00:40.841755 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:ab845576-f99a-4034-89dc-73fbe7dfcf77&page=queryresults
[0m18:00:46.616597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '336847cc-cf5c-4358-b981-939e8b0c817b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e8349ee30>]}
[0m18:00:46.618098 [info ] [Thread-1 (]: 2 of 4 OK created sql table model glamira_data_2025_staging.stag_location ...... [[32mCREATE TABLE (3.2m rows, 289.2 MiB processed)[0m in 7.17s]
[0m18:00:46.619484 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_location
[0m18:00:46.620258 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_product
[0m18:00:46.621528 [info ] [Thread-1 (]: 3 of 4 START sql table model glamira_data_2025_staging.stag_product ............ [RUN]
[0m18:00:46.622465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_location, now model.dbt_project.stag_product)
[0m18:00:46.623860 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_product
[0m18:00:46.634831 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_product"
[0m18:00:46.636263 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_product
[0m18:00:46.640773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:47.448337 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_product"
[0m18:00:47.449820 [debug] [Thread-1 (]: On model.dbt_project.stag_product: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_product"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`product_name`
),

casted AS (
 SELECT
   src.product_id AS product_id,
   src.name AS product_name,
   src.sku AS sku,
   src.gender AS gender,
   src.max_price_format AS max_price_format,
   src.min_price_format AS min_price_format,
   src.type_id AS type_id,
   src.store_code AS store_code
 FROM src
)

SELECT * FROM casted
    );
  
[0m18:00:48.082235 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:8f9bd1eb-b2a6-4eef-b8b1-7922661f73aa&page=queryresults
[0m18:00:50.660717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '336847cc-cf5c-4358-b981-939e8b0c817b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e629f6e00>]}
[0m18:00:50.662186 [info ] [Thread-1 (]: 3 of 4 OK created sql table model glamira_data_2025_staging.stag_product ....... [[32mCREATE TABLE (18.8k rows, 1.8 MiB processed)[0m in 4.04s]
[0m18:00:50.679275 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_product
[0m18:00:50.680527 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_sales
[0m18:00:50.681943 [info ] [Thread-1 (]: 4 of 4 START sql table model glamira_data_2025_staging.stag_sales .............. [RUN]
[0m18:00:50.682944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_product, now model.dbt_project.stag_sales)
[0m18:00:50.683728 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_sales
[0m18:00:50.688856 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_sales"
[0m18:00:50.689974 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_sales
[0m18:00:50.695548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:51.480611 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_sales"
[0m18:00:51.481803 [debug] [Thread-1 (]: On model.dbt_project.stag_sales: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_sales"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


flattened AS (
 SELECT
   GENERATE_UUID() as sales_id,
   CAST(src.order_id AS INT64) AS order_id,
   src._id AS customer_id,
   src.time_stamp AS date_id,
   src.ip AS ip_address,
   src.time_stamp AS time_stamp,
   src.local_time AS local_time,
   CAST(src.store_id AS INT64) AS store_id,
   cp.product_id AS product_id,
   cp.amount AS amount,
   cp.currency AS currency_code,
   cp.price AS price,
 FROM src,
 UNNEST(src.cart_products) AS cp
)


SELECT * FROM flattened
    );
  
[0m18:00:52.109895 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:d7648732-8d94-42b8-9f6f-9b2aa4cbd6c5&page=queryresults
[0m18:00:58.939650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '336847cc-cf5c-4358-b981-939e8b0c817b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e629f5390>]}
[0m18:00:58.940939 [info ] [Thread-1 (]: 4 of 4 OK created sql table model glamira_data_2025_staging.stag_sales ......... [[32mCREATE TABLE (822.4k rows, 2.8 GiB processed)[0m in 8.26s]
[0m18:00:58.942000 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_sales
[0m18:00:58.943958 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:00:58.946113 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:58.946652 [debug] [MainThread]: Connection 'model.dbt_project.stag_sales' was properly closed.
[0m18:00:58.947560 [info ] [MainThread]: 
[0m18:00:58.948566 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 25.89 seconds (25.89s).
[0m18:00:58.950783 [debug] [MainThread]: Command end result
[0m18:00:58.995824 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m18:00:58.998192 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m18:00:59.007368 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m18:00:59.008030 [info ] [MainThread]: 
[0m18:00:59.008764 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:59.009604 [info ] [MainThread]: 
[0m18:00:59.010332 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m18:00:59.011621 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 30.729652, "process_in_blocks": "0", "process_kernel_time": 0.491236, "process_mem_max_rss": "356320", "process_out_blocks": "2352", "process_user_time": 7.880663}
[0m18:00:59.012465 [debug] [MainThread]: Command `dbt run` succeeded at 18:00:59.012307 after 30.73 seconds
[0m18:00:59.013197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e83271540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e62ecb490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5e62902260>]}
[0m18:00:59.014211 [debug] [MainThread]: Flushing usage events
[0m18:01:00.578983 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:07.549759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac10ad4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac00586d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac0058670>]}


============================== 18:04:07.553686 | 78ba6684-ed84-42e2-a495-502fd9fffc49 ==============================
[0m18:04:07.553686 [info ] [MainThread]: Running with dbt=1.10.11
[0m18:04:07.554562 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/home/dunhan/.dbt', 'partial_parse': 'True', 'printer_width': '80', 'write_json': 'True', 'log_format': 'default', 'fail_fast': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_path': '/home/dunhan/dbt_project/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'empty': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'no_print': 'None'}
[0m18:04:10.331647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78ba6684-ed84-42e2-a495-502fd9fffc49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac0fa6ec0>]}
[0m18:04:10.426148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78ba6684-ed84-42e2-a495-502fd9fffc49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac0809b10>]}
[0m18:04:10.427063 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:04:10.738278 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m18:04:10.933073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:04:10.933682 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:04:11.004907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78ba6684-ed84-42e2-a495-502fd9fffc49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aa06f8fd0>]}
[0m18:04:11.164183 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m18:04:11.167079 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m18:04:11.182865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78ba6684-ed84-42e2-a495-502fd9fffc49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aa061af80>]}
[0m18:04:11.183809 [info ] [MainThread]: Found 4 models, 13 data tests, 3 sources, 495 macros
[0m18:04:11.184653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78ba6684-ed84-42e2-a495-502fd9fffc49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aa06197e0>]}
[0m18:04:11.187615 [info ] [MainThread]: 
[0m18:04:11.188435 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:11.189066 [info ] [MainThread]: 
[0m18:04:11.190293 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:04:11.198612 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m18:04:11.200306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:12.128336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now list_symmetric-fin-469415-q9_glamira_data_2025_staging)
[0m18:04:12.129183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:12.916488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78ba6684-ed84-42e2-a495-502fd9fffc49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac2b01330>]}
[0m18:04:12.917418 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:04:12.922787 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_customer
[0m18:04:12.923637 [info ] [Thread-1 (]: 1 of 4 START sql table model glamira_data_2025_staging.stag_customer ........... [RUN]
[0m18:04:12.924550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_staging, now model.dbt_project.stag_customer)
[0m18:04:12.925202 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_customer
[0m18:04:12.943135 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_customer"
[0m18:04:12.944300 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_customer
[0m18:04:12.970575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:13.779277 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_customer"
[0m18:04:13.794648 [debug] [Thread-1 (]: On model.dbt_project.stag_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


checkout_success AS (
  SELECT
    _id AS customer_id,
    device_id AS device_id,
    email_address AS email_address,
    resolution AS resolution,
    user_id_db AS user_id_db,
    user_agent AS user_agent 
  FROM src
  WHERE collection = 'checkout_success'
)

SELECT * FROM checkout_success
    );
  
[0m18:04:14.738727 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:39138815-e7e5-4725-b286-33583db96f15&page=queryresults
[0m18:04:17.794063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78ba6684-ed84-42e2-a495-502fd9fffc49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aa3a82800>]}
[0m18:04:17.795278 [info ] [Thread-1 (]: 1 of 4 OK created sql table model glamira_data_2025_staging.stag_customer ...... [[32mCREATE TABLE (26.1k rows, 8.8 GiB processed)[0m in 4.87s]
[0m18:04:17.796601 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_customer
[0m18:04:17.797804 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_location
[0m18:04:17.799497 [info ] [Thread-1 (]: 2 of 4 START sql table model glamira_data_2025_staging.stag_location ........... [RUN]
[0m18:04:17.800555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_customer, now model.dbt_project.stag_location)
[0m18:04:17.801562 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_location
[0m18:04:17.807046 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_location"
[0m18:04:17.808098 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_location
[0m18:04:17.815550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:18.588300 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_location"
[0m18:04:18.589670 [debug] [Thread-1 (]: On model.dbt_project.stag_location: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_location"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`location`
),


casted AS (
    SELECT
        src.ip AS ip_address,
        src.city AS city_name, 
        src.country_short AS country_short_name,
        src.country_long AS country_long_name,  
        ROUND(SAFE_CAST(src.latitude AS NUMERIC), 6) AS latitude,
        ROUND(SAFE_CAST(src.longitude AS NUMERIC), 6) AS longitude,
        src.region AS region_name, 
        src.time_zone, 
        src.zip_code
    FROM src
)

SELECT * FROM casted
    );
  
[0m18:04:19.227982 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:8654b939-2b01-464f-8af6-d90e8c2175dc&page=queryresults
[0m18:04:23.711148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78ba6684-ed84-42e2-a495-502fd9fffc49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9e06be20>]}
[0m18:04:23.712251 [info ] [Thread-1 (]: 2 of 4 OK created sql table model glamira_data_2025_staging.stag_location ...... [[32mCREATE TABLE (3.2m rows, 289.2 MiB processed)[0m in 5.91s]
[0m18:04:23.713248 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_location
[0m18:04:23.714153 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_product
[0m18:04:23.715463 [info ] [Thread-1 (]: 3 of 4 START sql table model glamira_data_2025_staging.stag_product ............ [RUN]
[0m18:04:23.716862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_location, now model.dbt_project.stag_product)
[0m18:04:23.717999 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_product
[0m18:04:23.727822 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_product"
[0m18:04:23.729493 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_product
[0m18:04:23.736120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:24.509346 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_product"
[0m18:04:24.510554 [debug] [Thread-1 (]: On model.dbt_project.stag_product: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_product"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`product_name`
),

casted AS (
 SELECT
   src.product_id AS product_id,
   src.name AS product_name,
   src.sku AS sku,
   src.gender AS gender,
   src.max_price_format AS max_price_format,
   src.min_price_format AS min_price_format,
   src.type_id AS type_id,
   src.store_code AS store_code
 FROM src
)

SELECT * FROM casted
    );
  
[0m18:04:25.128892 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:805d261d-12e4-4c48-a984-efca16e65873&page=queryresults
[0m18:04:27.503273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78ba6684-ed84-42e2-a495-502fd9fffc49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9e06be20>]}
[0m18:04:27.504733 [info ] [Thread-1 (]: 3 of 4 OK created sql table model glamira_data_2025_staging.stag_product ....... [[32mCREATE TABLE (18.8k rows, 1.8 MiB processed)[0m in 3.79s]
[0m18:04:27.505996 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_product
[0m18:04:27.506766 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_sales
[0m18:04:27.507570 [info ] [Thread-1 (]: 4 of 4 START sql table model glamira_data_2025_staging.stag_sales .............. [RUN]
[0m18:04:27.508402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_product, now model.dbt_project.stag_sales)
[0m18:04:27.509084 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_sales
[0m18:04:27.516505 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_sales"
[0m18:04:27.518170 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_sales
[0m18:04:27.524106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:28.306122 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_sales"
[0m18:04:28.307217 [debug] [Thread-1 (]: On model.dbt_project.stag_sales: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_sales"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


flattened AS (
 SELECT
   GENERATE_UUID() as sales_id,
   CAST(src.order_id AS INT64) AS order_id,
   src._id AS customer_id,
   src.time_stamp AS date_id,
   src.ip AS ip_address,
   src.time_stamp AS time_stamp,
   src.local_time AS local_time,
   CAST(src.store_id AS INT64) AS store_id,
   cp.product_id AS product_id,
   cp.amount AS amount,
   cp.currency AS currency_code,
   cp.price AS price,
 FROM src,
 UNNEST(src.cart_products) AS cp
)


SELECT * FROM flattened
    );
  
[0m18:04:28.925190 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:f6864c49-c866-4299-8a49-a0fd64f62539&page=queryresults
[0m18:04:33.719198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78ba6684-ed84-42e2-a495-502fd9fffc49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9e06be20>]}
[0m18:04:33.720515 [info ] [Thread-1 (]: 4 of 4 OK created sql table model glamira_data_2025_staging.stag_sales ......... [[32mCREATE TABLE (822.4k rows, 2.8 GiB processed)[0m in 6.21s]
[0m18:04:33.721968 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_sales
[0m18:04:33.723536 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:04:33.725712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:33.726293 [debug] [MainThread]: Connection 'model.dbt_project.stag_sales' was properly closed.
[0m18:04:33.727196 [info ] [MainThread]: 
[0m18:04:33.728485 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 22.54 seconds (22.54s).
[0m18:04:33.731880 [debug] [MainThread]: Command end result
[0m18:04:33.797025 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m18:04:33.800214 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m18:04:33.809413 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m18:04:33.810052 [info ] [MainThread]: 
[0m18:04:33.810731 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:04:33.811399 [info ] [MainThread]: 
[0m18:04:33.812216 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m18:04:33.814188 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 26.349527, "process_in_blocks": "0", "process_kernel_time": 0.419507, "process_mem_max_rss": "356256", "process_out_blocks": "2320", "process_user_time": 6.67525}
[0m18:04:33.815604 [debug] [MainThread]: Command `dbt run` succeeded at 18:04:33.815300 after 26.35 seconds
[0m18:04:33.817134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac10ad4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac0809b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac0fa6ec0>]}
[0m18:04:33.818469 [debug] [MainThread]: Flushing usage events
[0m18:04:35.560373 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:35:29.153095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c11ce9b5570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c11cd9546d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c11cd954670>]}


============================== 10:35:29.163016 | 2843eec7-ecfa-4293-99fd-56c65db7f875 ==============================
[0m10:35:29.163016 [info ] [MainThread]: Running with dbt=1.10.11
[0m10:35:29.163975 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'printer_width': '80', 'version_check': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'profiles_dir': '/home/dunhan/.dbt', 'debug': 'False', 'introspect': 'True', 'no_print': 'None', 'target_path': 'None', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'quiet': 'False', 'static_parser': 'True', 'use_colors': 'True', 'log_path': '/home/dunhan/dbt_project/logs'}
[0m10:35:29.330249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2843eec7-ecfa-4293-99fd-56c65db7f875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c11d0458d60>]}
[0m10:35:29.347902 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:35:29.349429 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:35:29.351592 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.29669788, "process_in_blocks": "392", "process_kernel_time": 0.112626, "process_mem_max_rss": "96084", "process_out_blocks": "8", "process_user_time": 2.005349}
[0m10:35:29.352443 [debug] [MainThread]: Command `cli deps` succeeded at 10:35:29.352256 after 0.30 seconds
[0m10:35:29.353317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c11ce9b5570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c11d0458d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c11cd6dd5d0>]}
[0m10:35:29.354487 [debug] [MainThread]: Flushing usage events
[0m10:35:30.716734 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:43:26.453321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798506fb94e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798505f606a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798505f60640>]}


============================== 10:43:26.457270 | 0b708337-6d74-4372-b009-d8af477318f9 ==============================
[0m10:43:26.457270 [info ] [MainThread]: Running with dbt=1.10.11
[0m10:43:26.458288 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'warn_error': 'None', 'no_print': 'None', 'printer_width': '80', 'partial_parse': 'True', 'use_colors': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'debug': 'False', 'log_cache_events': 'False', 'empty': 'False', 'quiet': 'False', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'version_check': 'True', 'introspect': 'True', 'profiles_dir': '/home/dunhan/.dbt', 'use_experimental_parser': 'False', 'log_path': '/home/dunhan/dbt_project/logs', 'static_parser': 'True'}
[0m10:43:29.225745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b708337-6d74-4372-b009-d8af477318f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798506186b90>]}
[0m10:43:29.321247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b708337-6d74-4372-b009-d8af477318f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798506796ce0>]}
[0m10:43:29.322409 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m10:43:29.690432 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m10:43:29.908710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:43:29.909476 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:43:29.991919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b708337-6d74-4372-b009-d8af477318f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7984e6378130>]}
[0m10:43:30.167166 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m10:43:30.171998 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m10:43:30.189494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b708337-6d74-4372-b009-d8af477318f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7984e635faf0>]}
[0m10:43:30.190592 [info ] [MainThread]: Found 10 models, 13 data tests, 3 sources, 495 macros
[0m10:43:30.191431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b708337-6d74-4372-b009-d8af477318f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7984e635fc10>]}
[0m10:43:30.194234 [info ] [MainThread]: 
[0m10:43:30.195116 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:43:30.195828 [info ] [MainThread]: 
[0m10:43:30.197170 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:43:30.207224 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m10:43:30.208825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:31.155445 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now list_symmetric-fin-469415-q9_glamira_data_2025_staging)
[0m10:43:31.156283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:32.074682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_staging, now list_symmetric-fin-469415-q9_glamira_data_2025)
[0m10:43:32.075831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:32.878602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b708337-6d74-4372-b009-d8af477318f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7984e66850f0>]}
[0m10:43:32.879449 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:43:32.887656 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_customer
[0m10:43:32.889382 [info ] [Thread-1 (]: 1 of 4 START sql table model glamira_data_2025_staging.stag_customer ........... [RUN]
[0m10:43:32.890520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025, now model.dbt_project.stag_customer)
[0m10:43:32.891495 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_customer
[0m10:43:32.913949 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_customer"
[0m10:43:32.915359 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_customer
[0m10:43:32.939282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:33.739987 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_customer"
[0m10:43:33.741712 [debug] [Thread-1 (]: On model.dbt_project.stag_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


checkout_success AS (
  SELECT
    _id AS customer_id,
    device_id AS device_id,
    email_address AS email_address,
    resolution AS resolution,
    user_id_db AS user_id_db,
    user_agent AS user_agent 
  FROM src
  WHERE collection = 'checkout_success'
)

SELECT * FROM checkout_success
    );
  
[0m10:43:34.411721 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:4def1bec-1141-4144-8050-6a221fb7a6b6&page=queryresults
[0m10:43:39.543414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b708337-6d74-4372-b009-d8af477318f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7984e98ae680>]}
[0m10:43:39.544551 [info ] [Thread-1 (]: 1 of 4 OK created sql table model glamira_data_2025_staging.stag_customer ...... [[32mCREATE TABLE (26.1k rows, 8.8 GiB processed)[0m in 6.65s]
[0m10:43:39.545767 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_customer
[0m10:43:39.546521 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_location
[0m10:43:39.547639 [info ] [Thread-1 (]: 2 of 4 START sql table model glamira_data_2025_staging.stag_location ........... [RUN]
[0m10:43:39.548893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_customer, now model.dbt_project.stag_location)
[0m10:43:39.549932 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_location
[0m10:43:39.555578 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_location"
[0m10:43:39.556713 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_location
[0m10:43:39.560712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:40.368669 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_location"
[0m10:43:40.370262 [debug] [Thread-1 (]: On model.dbt_project.stag_location: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_location"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`location`
),


casted AS (
    SELECT
        src.ip AS ip_address,
        src.city AS city_name, 
        src.country_short AS country_short_name,
        src.country_long AS country_long_name,  
        ROUND(SAFE_CAST(src.latitude AS NUMERIC), 6) AS latitude,
        ROUND(SAFE_CAST(src.longitude AS NUMERIC), 6) AS longitude,
        src.region AS region_name, 
        src.time_zone, 
        src.zip_code
    FROM src
)

SELECT * FROM casted
    );
  
[0m10:43:41.114997 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:d718b7e0-8be4-4f64-899f-6c53de74f9a2&page=queryresults
[0m10:43:45.532936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b708337-6d74-4372-b009-d8af477318f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7984e98ae680>]}
[0m10:43:45.534769 [info ] [Thread-1 (]: 2 of 4 OK created sql table model glamira_data_2025_staging.stag_location ...... [[32mCREATE TABLE (3.2m rows, 289.2 MiB processed)[0m in 5.98s]
[0m10:43:45.536611 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_location
[0m10:43:45.537760 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_product
[0m10:43:45.539102 [info ] [Thread-1 (]: 3 of 4 START sql table model glamira_data_2025_staging.stag_product ............ [RUN]
[0m10:43:45.540331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_location, now model.dbt_project.stag_product)
[0m10:43:45.541675 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_product
[0m10:43:45.550080 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_product"
[0m10:43:45.552345 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_product
[0m10:43:45.563657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:46.388972 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_product"
[0m10:43:46.390267 [debug] [Thread-1 (]: On model.dbt_project.stag_product: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_product"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`product_name`
),

casted AS (
 SELECT
   src.product_id AS product_id,
   src.name AS product_name,
   src.sku AS sku,
   src.gender AS gender,
   src.max_price_format AS max_price_format,
   src.min_price_format AS min_price_format,
   src.type_id AS type_id,
   src.store_code AS store_id
 FROM src
)

SELECT * FROM casted
    );
  
[0m10:43:47.101358 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:359473b8-974d-4787-a6f9-5992381aabf4&page=queryresults
[0m10:43:49.234323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b708337-6d74-4372-b009-d8af477318f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7984e411f1c0>]}
[0m10:43:49.236070 [info ] [Thread-1 (]: 3 of 4 OK created sql table model glamira_data_2025_staging.stag_product ....... [[32mCREATE TABLE (18.8k rows, 1.8 MiB processed)[0m in 3.69s]
[0m10:43:49.237482 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_product
[0m10:43:49.238264 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_sales
[0m10:43:49.239403 [info ] [Thread-1 (]: 4 of 4 START sql table model glamira_data_2025_staging.stag_sales .............. [RUN]
[0m10:43:49.240282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_product, now model.dbt_project.stag_sales)
[0m10:43:49.241052 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_sales
[0m10:43:49.246189 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_sales"
[0m10:43:49.247275 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_sales
[0m10:43:49.251953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:50.015437 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_sales"
[0m10:43:50.016594 [debug] [Thread-1 (]: On model.dbt_project.stag_sales: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_sales"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


flattened AS (
 SELECT
   GENERATE_UUID() as sales_id,
   CAST(src.order_id AS INT64) AS order_id,
   src._id AS customer_id,
   src.time_stamp AS date_id,
   src.ip AS ip_address,
   src.time_stamp AS time_stamp,
   src.local_time AS local_time,
   CAST(src.store_id AS INT64) AS store_id,
   cp.product_id AS product_id,
   cp.amount AS amount,
   cp.currency AS currency_code,
   cp.price AS price,
 FROM src,
 UNNEST(src.cart_products) AS cp
)


SELECT * FROM flattened
    );
  
[0m10:43:50.661368 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:3771f522-dd7f-43e8-98c7-75b0b1156f10&page=queryresults
[0m10:43:56.205294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b708337-6d74-4372-b009-d8af477318f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7984e411f1c0>]}
[0m10:43:56.206504 [info ] [Thread-1 (]: 4 of 4 OK created sql table model glamira_data_2025_staging.stag_sales ......... [[32mCREATE TABLE (822.4k rows, 2.8 GiB processed)[0m in 6.96s]
[0m10:43:56.207500 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_sales
[0m10:43:56.209138 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:43:56.211374 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:43:56.211970 [debug] [MainThread]: Connection 'model.dbt_project.stag_sales' was properly closed.
[0m10:43:56.212824 [info ] [MainThread]: 
[0m10:43:56.213722 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 26.02 seconds (26.02s).
[0m10:43:56.215744 [debug] [MainThread]: Command end result
[0m10:43:56.292517 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m10:43:56.295854 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m10:43:56.305981 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m10:43:56.306623 [info ] [MainThread]: 
[0m10:43:56.307362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:43:56.308033 [info ] [MainThread]: 
[0m10:43:56.308794 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m10:43:56.310033 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 29.940197, "process_in_blocks": "2280", "process_kernel_time": 0.459102, "process_mem_max_rss": "357020", "process_out_blocks": "2576", "process_user_time": 7.03357}
[0m10:43:56.310906 [debug] [MainThread]: Command `dbt run` succeeded at 10:43:56.310738 after 29.94 seconds
[0m10:43:56.311755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798506fb94e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798506e8e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798506186b90>]}
[0m10:43:56.312376 [debug] [MainThread]: Flushing usage events
[0m10:43:57.924730 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:56:56.998731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be9d0da95a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be9cfd487f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be9cfd48790>]}


============================== 14:56:57.002604 | 01eac51c-880a-4d68-96b0-a76705b9ecdf ==============================
[0m14:56:57.002604 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:56:57.004075 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'fail_fast': 'False', 'log_path': '/home/dunhan/dbt_project/logs', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/dunhan/.dbt', 'partial_parse': 'True', 'debug': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'version_check': 'True', 'target_path': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'printer_width': '80'}
[0m14:57:00.110964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01eac51c-880a-4d68-96b0-a76705b9ecdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be9d2858d00>]}
[0m14:57:00.220453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01eac51c-880a-4d68-96b0-a76705b9ecdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be9cff7a3e0>]}
[0m14:57:00.221423 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m14:57:00.585944 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:57:00.830930 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:57:00.831649 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:57:00.928068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01eac51c-880a-4d68-96b0-a76705b9ecdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be9b0268580>]}
[0m14:57:01.137184 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m14:57:01.140210 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m14:57:01.159379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01eac51c-880a-4d68-96b0-a76705b9ecdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be9b026a6e0>]}
[0m14:57:01.160505 [info ] [MainThread]: Found 14 models, 13 data tests, 3 sources, 495 macros
[0m14:57:01.161632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01eac51c-880a-4d68-96b0-a76705b9ecdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be9b0224a60>]}
[0m14:57:01.165570 [info ] [MainThread]: 
[0m14:57:01.166489 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:57:01.167639 [info ] [MainThread]: 
[0m14:57:01.169236 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:57:01.181894 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m14:57:01.183459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:02.216924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:03.025410 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now list_symmetric-fin-469415-q9_glamira_data_2025_staging)
[0m14:57:03.026271 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:03.798253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_staging, now list_symmetric-fin-469415-q9_glamira_data_2025)
[0m14:57:03.800927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:04.575787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01eac51c-880a-4d68-96b0-a76705b9ecdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be9b0966020>]}
[0m14:57:04.576791 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:57:04.582253 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_customer
[0m14:57:04.583345 [info ] [Thread-1 (]: 1 of 6 START sql table model glamira_data_2025_staging.stag_customer ........... [RUN]
[0m14:57:04.584540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025, now model.dbt_project.stag_customer)
[0m14:57:04.585244 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_customer
[0m14:57:04.604411 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_customer"
[0m14:57:04.605635 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_customer
[0m14:57:04.636095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:05.483841 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_customer"
[0m14:57:05.485204 [debug] [Thread-1 (]: On model.dbt_project.stag_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


checkout_success AS (
  SELECT
    _id AS customer_id,
    device_id AS device_id,
    email_address AS email_address,
    resolution AS resolution,
    user_id_db AS user_id_db,
    user_agent AS user_agent 
  FROM src
  WHERE collection = 'checkout_success'
)

SELECT * FROM checkout_success
    );
  
[0m14:57:06.183399 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:b521bbcf-619d-4d28-8258-985bb6d3876c&page=queryresults
[0m14:57:10.107227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01eac51c-880a-4d68-96b0-a76705b9ecdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be9b36c2800>]}
[0m14:57:10.108635 [info ] [Thread-1 (]: 1 of 6 OK created sql table model glamira_data_2025_staging.stag_customer ...... [[32mCREATE TABLE (26.1k rows, 8.8 GiB processed)[0m in 5.52s]
[0m14:57:10.110397 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_customer
[0m14:57:10.111423 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_location
[0m14:57:10.113171 [info ] [Thread-1 (]: 2 of 6 START sql table model glamira_data_2025_staging.stag_location ........... [RUN]
[0m14:57:10.114283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_customer, now model.dbt_project.stag_location)
[0m14:57:10.115102 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_location
[0m14:57:10.121928 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_location"
[0m14:57:10.123027 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_location
[0m14:57:10.129268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:11.156856 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_location"
[0m14:57:11.158084 [debug] [Thread-1 (]: On model.dbt_project.stag_location: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_location"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`location`
),


casted AS (
    SELECT
        src.ip AS ip_address,
        src.city AS city_name, 
        src.country_short AS country_short_name,
        src.country_long AS country_long_name,  
        ROUND(SAFE_CAST(src.latitude AS NUMERIC), 6) AS latitude,
        ROUND(SAFE_CAST(src.longitude AS NUMERIC), 6) AS longitude,
        src.region AS region_name, 
        src.time_zone, 
        src.zip_code
    FROM src
)

SELECT * FROM casted
    );
  
[0m14:57:11.943248 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:0f175293-0c42-4774-9432-65ffe7a7c02f&page=queryresults
[0m14:57:17.062543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01eac51c-880a-4d68-96b0-a76705b9ecdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be9af8346a0>]}
[0m14:57:17.064005 [info ] [Thread-1 (]: 2 of 6 OK created sql table model glamira_data_2025_staging.stag_location ...... [[32mCREATE TABLE (3.2m rows, 289.2 MiB processed)[0m in 6.95s]
[0m14:57:17.065851 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_location
[0m14:57:17.067060 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_product
[0m14:57:17.067944 [info ] [Thread-1 (]: 3 of 6 START sql table model glamira_data_2025_staging.stag_product ............ [RUN]
[0m14:57:17.068925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_location, now model.dbt_project.stag_product)
[0m14:57:17.069638 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_product
[0m14:57:17.079767 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_product"
[0m14:57:17.081612 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_product
[0m14:57:17.088725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:17.912927 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_product"
[0m14:57:17.914210 [debug] [Thread-1 (]: On model.dbt_project.stag_product: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_product"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`product_name`
),

casted AS (
 SELECT
   src.product_id AS product_id,
   src.name AS product_name,
   src.sku AS sku,
   src.gender AS gender,
   src.max_price_format AS max_price_format,
   src.min_price_format AS min_price_format,
   src.type_id AS type_id,
   src.store_code AS store_code
 FROM src
)

SELECT * FROM casted
    );
  
[0m14:57:18.582773 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:0db6b758-9dd1-4eee-b4fd-7752e230c2ea&page=queryresults
[0m14:57:20.733628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01eac51c-880a-4d68-96b0-a76705b9ecdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be9b36c2800>]}
[0m14:57:20.734895 [info ] [Thread-1 (]: 3 of 6 OK created sql table model glamira_data_2025_staging.stag_product ....... [[32mCREATE TABLE (18.8k rows, 1.8 MiB processed)[0m in 3.66s]
[0m14:57:20.736221 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_product
[0m14:57:20.736903 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_sales
[0m14:57:20.737873 [info ] [Thread-1 (]: 4 of 6 START sql table model glamira_data_2025_staging.stag_sales .............. [RUN]
[0m14:57:20.738728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_product, now model.dbt_project.stag_sales)
[0m14:57:20.739454 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_sales
[0m14:57:20.745805 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_sales"
[0m14:57:20.746765 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_sales
[0m14:57:20.752022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:21.510509 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_sales"
[0m14:57:21.511660 [debug] [Thread-1 (]: On model.dbt_project.stag_sales: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_sales"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


flattened AS (
 SELECT
   GENERATE_UUID() as sales_id,
   CAST(src.order_id AS INT64) AS order_id,
   src._id AS customer_id,
   src.time_stamp AS date_id,
   src.ip AS ip_address,
   src.time_stamp AS time_stamp,
   src.local_time AS local_time,
   CAST(src.store_id AS INT64) AS store_id,
   cp.product_id AS product_id,
   cp.amount AS amount,
   cp.currency AS currency_code,
   cp.price AS price,
 FROM src,
 UNNEST(src.cart_products) AS cp
)


SELECT * FROM flattened
    );
  
[0m14:57:22.164787 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:85d9ad98-56f6-46be-8e1a-67de13cb1f3b&page=queryresults
[0m14:57:27.906910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01eac51c-880a-4d68-96b0-a76705b9ecdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be9b02708b0>]}
[0m14:57:27.908889 [info ] [Thread-1 (]: 4 of 6 OK created sql table model glamira_data_2025_staging.stag_sales ......... [[32mCREATE TABLE (822.4k rows, 2.8 GiB processed)[0m in 7.17s]
[0m14:57:27.910716 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_sales
[0m14:57:27.911707 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_customer
[0m14:57:27.912701 [info ] [Thread-1 (]: 5 of 6 START sql table model glamira_data_2025.dim_customer .................... [RUN]
[0m14:57:27.914112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_sales, now model.dbt_project.dim_customer)
[0m14:57:27.915342 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_customer
[0m14:57:27.923519 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_customer"
[0m14:57:27.925215 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_customer
[0m14:57:27.935724 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_customer"
[0m14:57:27.938261 [debug] [Thread-1 (]: On model.dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025`.`dim_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
),

customer AS (
    SELECT
        customer_id,
        email_address,
        resolution,
        user_agent
    FROM src 
)

SELECT * FROM customer
    );
  
[0m14:57:27.940075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:29.070502 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:832e8b75-ae66-4633-9dcc-9bae6cae2c1f&page=queryresults
[0m14:57:31.774697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01eac51c-880a-4d68-96b0-a76705b9ecdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be9adc6dba0>]}
[0m14:57:31.777103 [info ] [Thread-1 (]: 5 of 6 OK created sql table model glamira_data_2025.dim_customer ............... [[32mCREATE TABLE (26.1k rows, 4.4 MiB processed)[0m in 3.86s]
[0m14:57:31.778504 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_customer
[0m14:57:31.779269 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_store
[0m14:57:31.780241 [info ] [Thread-1 (]: 6 of 6 START sql table model glamira_data_2025.dim_store ....................... [RUN]
[0m14:57:31.781377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_customer, now model.dbt_project.dim_store)
[0m14:57:31.782248 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_store
[0m14:57:31.790746 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_store"
[0m14:57:31.792323 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_store
[0m14:57:31.801066 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_store"
[0m14:57:31.803270 [debug] [Thread-1 (]: On model.dbt_project.dim_store: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_store"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025`.`dim_store`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
),

store AS (
    SELECT
        DISTINCT store_id,
        CONCAT("Store ", CAST(store_id AS STRING)) AS store_name
    FROM src
)

SELECT * FROM store
    );
  
[0m14:57:31.805423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:33.133684 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:4e355328-f7b7-41bf-83fb-0ed042b49e0e&page=queryresults
[0m14:57:35.430007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01eac51c-880a-4d68-96b0-a76705b9ecdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be9adbcebc0>]}
[0m14:57:35.431479 [info ] [Thread-1 (]: 6 of 6 OK created sql table model glamira_data_2025.dim_store .................. [[32mCREATE TABLE (83.0 rows, 6.3 MiB processed)[0m in 3.65s]
[0m14:57:35.432622 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_store
[0m14:57:35.434528 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:57:35.438205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:35.439296 [debug] [MainThread]: Connection 'model.dbt_project.dim_store' was properly closed.
[0m14:57:35.441191 [info ] [MainThread]: 
[0m14:57:35.442521 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 34.27 seconds (34.27s).
[0m14:57:35.448486 [debug] [MainThread]: Command end result
[0m14:57:35.537434 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m14:57:35.541623 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m14:57:35.554901 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m14:57:35.555717 [info ] [MainThread]: 
[0m14:57:35.556918 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:57:35.558007 [info ] [MainThread]: 
[0m14:57:35.558824 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m14:57:35.560814 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 38.659847, "process_in_blocks": "0", "process_kernel_time": 0.496748, "process_mem_max_rss": "357188", "process_out_blocks": "2656", "process_user_time": 8.231826}
[0m14:57:35.563021 [debug] [MainThread]: Command `dbt run` succeeded at 14:57:35.562559 after 38.66 seconds
[0m14:57:35.564616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be9d0da95a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be9d11f5ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be9d0505c00>]}
[0m14:57:35.565526 [debug] [MainThread]: Flushing usage events
[0m14:57:37.287061 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:57:44.770313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7075351a9510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707534154700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7075341546a0>]}


============================== 14:57:44.774523 | 715579fc-09e4-418c-9185-58f84b5a6a89 ==============================
[0m14:57:44.774523 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:57:44.775744 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'fail_fast': 'False', 'log_format': 'default', 'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'partial_parse': 'True', 'introspect': 'True', 'log_path': '/home/dunhan/dbt_project/logs', 'no_print': 'None', 'debug': 'False', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'profiles_dir': '/home/dunhan/.dbt', 'invocation_command': 'dbt run', 'write_json': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'cache_selected_only': 'False'}
[0m14:57:48.094792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '715579fc-09e4-418c-9185-58f84b5a6a89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70753437abc0>]}
[0m14:57:48.204579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '715579fc-09e4-418c-9185-58f84b5a6a89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70753411d7e0>]}
[0m14:57:48.205655 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m14:57:48.561870 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:57:48.813253 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:57:48.814612 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:57:48.933219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '715579fc-09e4-418c-9185-58f84b5a6a89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7075146642e0>]}
[0m14:57:49.162483 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m14:57:49.166627 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m14:57:49.190574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '715579fc-09e4-418c-9185-58f84b5a6a89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707514667730>]}
[0m14:57:49.192334 [info ] [MainThread]: Found 14 models, 13 data tests, 3 sources, 495 macros
[0m14:57:49.193655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '715579fc-09e4-418c-9185-58f84b5a6a89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707514649ab0>]}
[0m14:57:49.197362 [info ] [MainThread]: 
[0m14:57:49.198528 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:57:49.199742 [info ] [MainThread]: 
[0m14:57:49.201089 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:57:49.209676 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m14:57:49.210576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:50.007583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:50.794586 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now list_symmetric-fin-469415-q9_glamira_data_2025)
[0m14:57:50.795492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:51.599278 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025, now list_symmetric-fin-469415-q9_glamira_data_2025_staging)
[0m14:57:51.602189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:52.367910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '715579fc-09e4-418c-9185-58f84b5a6a89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707514d7df90>]}
[0m14:57:52.369174 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:57:52.374196 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_customer
[0m14:57:52.375232 [info ] [Thread-1 (]: 1 of 6 START sql table model glamira_data_2025_staging.stag_customer ........... [RUN]
[0m14:57:52.376407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_staging, now model.dbt_project.stag_customer)
[0m14:57:52.377196 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_customer
[0m14:57:52.400651 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_customer"
[0m14:57:52.402611 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_customer
[0m14:57:52.434238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:53.252231 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_customer"
[0m14:57:53.253467 [debug] [Thread-1 (]: On model.dbt_project.stag_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


checkout_success AS (
  SELECT
    _id AS customer_id,
    device_id AS device_id,
    email_address AS email_address,
    resolution AS resolution,
    user_id_db AS user_id_db,
    user_agent AS user_agent 
  FROM src
  WHERE collection = 'checkout_success'
)

SELECT * FROM checkout_success
    );
  
[0m14:57:53.905349 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:9590aa69-2148-46f2-9332-44791a74ae88&page=queryresults
[0m14:57:56.893302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '715579fc-09e4-418c-9185-58f84b5a6a89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7075146675e0>]}
[0m14:57:56.894956 [info ] [Thread-1 (]: 1 of 6 OK created sql table model glamira_data_2025_staging.stag_customer ...... [[32mCREATE TABLE (26.1k rows, 8.8 GiB processed)[0m in 4.51s]
[0m14:57:56.896991 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_customer
[0m14:57:56.898237 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_location
[0m14:57:56.899896 [info ] [Thread-1 (]: 2 of 6 START sql table model glamira_data_2025_staging.stag_location ........... [RUN]
[0m14:57:56.901402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_customer, now model.dbt_project.stag_location)
[0m14:57:56.902692 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_location
[0m14:57:56.908012 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_location"
[0m14:57:56.909304 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_location
[0m14:57:56.916482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:57.708937 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_location"
[0m14:57:57.710192 [debug] [Thread-1 (]: On model.dbt_project.stag_location: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_location"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`location`
),


casted AS (
    SELECT
        src.ip AS ip_address,
        src.city AS city_name, 
        src.country_short AS country_short_name,
        src.country_long AS country_long_name,  
        ROUND(SAFE_CAST(src.latitude AS NUMERIC), 6) AS latitude,
        ROUND(SAFE_CAST(src.longitude AS NUMERIC), 6) AS longitude,
        src.region AS region_name, 
        src.time_zone, 
        src.zip_code
    FROM src
)

SELECT * FROM casted
    );
  
[0m14:57:58.379594 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:13874676-2c00-4848-b630-2ca79c3c0236&page=queryresults
[0m14:58:02.505227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '715579fc-09e4-418c-9185-58f84b5a6a89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70753506e6e0>]}
[0m14:58:02.506516 [info ] [Thread-1 (]: 2 of 6 OK created sql table model glamira_data_2025_staging.stag_location ...... [[32mCREATE TABLE (3.2m rows, 289.2 MiB processed)[0m in 5.60s]
[0m14:58:02.507582 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_location
[0m14:58:02.508326 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_product
[0m14:58:02.509694 [info ] [Thread-1 (]: 3 of 6 START sql table model glamira_data_2025_staging.stag_product ............ [RUN]
[0m14:58:02.510764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_location, now model.dbt_project.stag_product)
[0m14:58:02.511464 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_product
[0m14:58:02.518658 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_product"
[0m14:58:02.520103 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_product
[0m14:58:02.526788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:03.342639 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_product"
[0m14:58:03.343793 [debug] [Thread-1 (]: On model.dbt_project.stag_product: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_product"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`product_name`
),

casted AS (
 SELECT
   src.product_id AS product_id,
   src.name AS product_name,
   src.sku AS sku,
   src.gender AS gender,
   src.max_price_format AS max_price_format,
   src.min_price_format AS min_price_format,
   src.type_id AS type_id,
   src.store_code AS store_code
 FROM src
)

SELECT * FROM casted
    );
  
[0m14:58:04.041853 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:5f8d7090-b0b0-4db6-8741-530f57e1b9cd&page=queryresults
[0m14:58:06.461888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '715579fc-09e4-418c-9185-58f84b5a6a89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70753506e6e0>]}
[0m14:58:06.463330 [info ] [Thread-1 (]: 3 of 6 OK created sql table model glamira_data_2025_staging.stag_product ....... [[32mCREATE TABLE (18.8k rows, 1.8 MiB processed)[0m in 3.95s]
[0m14:58:06.464548 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_product
[0m14:58:06.465575 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_sales
[0m14:58:06.466758 [info ] [Thread-1 (]: 4 of 6 START sql table model glamira_data_2025_staging.stag_sales .............. [RUN]
[0m14:58:06.467615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_product, now model.dbt_project.stag_sales)
[0m14:58:06.468429 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_sales
[0m14:58:06.474422 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_sales"
[0m14:58:06.475997 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_sales
[0m14:58:06.485335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:07.276572 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_sales"
[0m14:58:07.278457 [debug] [Thread-1 (]: On model.dbt_project.stag_sales: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_sales"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


flattened AS (
 SELECT
   GENERATE_UUID() as sales_id,
   CAST(src.order_id AS INT64) AS order_id,
   src._id AS customer_id,
   src.time_stamp AS date_id,
   src.ip AS ip_address,
   src.time_stamp AS time_stamp,
   src.local_time AS local_time,
   CAST(src.store_id AS INT64) AS store_id,
   cp.product_id AS product_id,
   cp.amount AS amount,
   cp.currency AS currency_code,
   cp.price AS price,
 FROM src,
 UNNEST(src.cart_products) AS cp
 WHERE collection = 'checkout_success'
)


SELECT * FROM flattened
    );
  
[0m14:58:07.906582 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:ab78776c-84ad-4f06-9718-71b9054e8260&page=queryresults
[0m14:58:10.868422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '715579fc-09e4-418c-9185-58f84b5a6a89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70753506e6e0>]}
[0m14:58:10.870230 [info ] [Thread-1 (]: 4 of 6 OK created sql table model glamira_data_2025_staging.stag_sales ......... [[32mCREATE TABLE (35.1k rows, 3.7 GiB processed)[0m in 4.40s]
[0m14:58:10.871449 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_sales
[0m14:58:10.872231 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_customer
[0m14:58:10.873341 [info ] [Thread-1 (]: 5 of 6 START sql table model glamira_data_2025.dim_customer .................... [RUN]
[0m14:58:10.874318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_sales, now model.dbt_project.dim_customer)
[0m14:58:10.874991 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_customer
[0m14:58:10.880804 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_customer"
[0m14:58:10.882541 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_customer
[0m14:58:10.892319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:11.838345 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_customer"
[0m14:58:11.839679 [debug] [Thread-1 (]: On model.dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025`.`dim_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
),

customer AS (
    SELECT
        customer_id,
        email_address,
        resolution,
        user_agent
    FROM src 
)

SELECT * FROM customer
    );
  
[0m14:58:12.505598 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:751ecbad-4f30-4cd5-a266-4c8e41dc0b22&page=queryresults
[0m14:58:14.952873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '715579fc-09e4-418c-9185-58f84b5a6a89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707512097eb0>]}
[0m14:58:14.954283 [info ] [Thread-1 (]: 5 of 6 OK created sql table model glamira_data_2025.dim_customer ............... [[32mCREATE TABLE (26.1k rows, 4.4 MiB processed)[0m in 4.08s]
[0m14:58:14.955319 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_customer
[0m14:58:14.956090 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_store
[0m14:58:14.957049 [info ] [Thread-1 (]: 6 of 6 START sql table model glamira_data_2025.dim_store ....................... [RUN]
[0m14:58:14.958468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_customer, now model.dbt_project.dim_store)
[0m14:58:14.959173 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_store
[0m14:58:14.964424 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_store"
[0m14:58:14.965600 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_store
[0m14:58:14.972280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:15.828867 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_store"
[0m14:58:15.829981 [debug] [Thread-1 (]: On model.dbt_project.dim_store: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_store"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025`.`dim_store`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
),

store AS (
    SELECT
        DISTINCT store_id,
        CONCAT("Store ", CAST(store_id AS STRING)) AS store_name
    FROM src
)

SELECT * FROM store
    );
  
[0m14:58:16.506597 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:9884301e-48cf-439c-9946-15e7761779e7&page=queryresults
[0m14:58:18.654505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '715579fc-09e4-418c-9185-58f84b5a6a89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707512097eb0>]}
[0m14:58:18.656104 [info ] [Thread-1 (]: 6 of 6 OK created sql table model glamira_data_2025.dim_store .................. [[32mCREATE TABLE (65.0 rows, 273.9 KiB processed)[0m in 3.70s]
[0m14:58:18.658100 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_store
[0m14:58:18.659608 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:58:18.661916 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:18.662805 [debug] [MainThread]: Connection 'model.dbt_project.dim_store' was properly closed.
[0m14:58:18.663959 [info ] [MainThread]: 
[0m14:58:18.664757 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 29.46 seconds (29.46s).
[0m14:58:18.667903 [debug] [MainThread]: Command end result
[0m14:58:18.747604 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m14:58:18.752095 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m14:58:18.766233 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m14:58:18.768280 [info ] [MainThread]: 
[0m14:58:18.770120 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:58:18.771631 [info ] [MainThread]: 
[0m14:58:18.772855 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m14:58:18.774554 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 34.103584, "process_in_blocks": "0", "process_kernel_time": 0.528286, "process_mem_max_rss": "357308", "process_out_blocks": "2648", "process_user_time": 8.642325}
[0m14:58:18.775735 [debug] [MainThread]: Command `dbt run` succeeded at 14:58:18.775543 after 34.10 seconds
[0m14:58:18.776471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7075351a9510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707535233c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70753437abc0>]}
[0m14:58:18.777606 [debug] [MainThread]: Flushing usage events
[0m14:58:20.309281 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:59:27.822385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e9d3a94e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e9c3506d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e9c350670>]}


============================== 14:59:27.827856 | 635097a3-2777-4313-a280-9e782d1ed3e5 ==============================
[0m14:59:27.827856 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:59:27.829302 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'quiet': 'False', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'empty': 'False', 'profiles_dir': '/home/dunhan/.dbt', 'version_check': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_path': '/home/dunhan/dbt_project/logs', 'static_parser': 'True', 'target_path': 'None', 'debug': 'False', 'invocation_command': 'dbt run', 'introspect': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'partial_parse': 'True'}
[0m14:59:31.705317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '635097a3-2777-4313-a280-9e782d1ed3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e9ee58f70>]}
[0m14:59:31.825760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '635097a3-2777-4313-a280-9e782d1ed3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e9c3197e0>]}
[0m14:59:31.827227 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m14:59:32.194685 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:59:32.445216 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:59:32.445814 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:59:32.552248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '635097a3-2777-4313-a280-9e782d1ed3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e7c82dbd0>]}
[0m14:59:32.777978 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m14:59:32.781188 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m14:59:32.809176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '635097a3-2777-4313-a280-9e782d1ed3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e7c7db670>]}
[0m14:59:32.810779 [info ] [MainThread]: Found 14 models, 38 data tests, 3 sources, 495 macros
[0m14:59:32.812363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '635097a3-2777-4313-a280-9e782d1ed3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e7c9995d0>]}
[0m14:59:32.818592 [info ] [MainThread]: 
[0m14:59:32.819735 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:59:32.820750 [info ] [MainThread]: 
[0m14:59:32.822820 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:59:32.836557 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m14:59:32.838540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:33.638058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:59:34.489866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now create_symmetric-fin-469415-q9_glamira_data_2025_warehouse)
[0m14:59:34.490848 [debug] [ThreadPool]: Creating schema "database: "symmetric-fin-469415-q9"
schema: "glamira_data_2025_warehouse"
"
[0m14:59:34.506502 [debug] [ThreadPool]: On create_symmetric-fin-469415-q9_glamira_data_2025_warehouse: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_symmetric-fin-469415-q9_glamira_data_2025_warehouse"} */
create schema if not exists `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`
  
[0m14:59:34.507235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:59:35.426269 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:8ac9dfb6-d917-4acc-8fb5-bd456d8dce20&page=queryresults
[0m14:59:36.447705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_symmetric-fin-469415-q9_glamira_data_2025_warehouse, now list_symmetric-fin-469415-q9_glamira_data_2025_warehouse)
[0m14:59:36.448732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:59:37.276995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_warehouse, now list_symmetric-fin-469415-q9_glamira_data_2025_staging)
[0m14:59:37.278578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:59:38.147988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_staging, now list_symmetric-fin-469415-q9_glamira_data_2025_mart)
[0m14:59:38.150327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:59:39.355139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '635097a3-2777-4313-a280-9e782d1ed3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e7c6b7610>]}
[0m14:59:39.356099 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:59:39.362722 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_customer
[0m14:59:39.363744 [info ] [Thread-1 (]: 1 of 6 START sql table model glamira_data_2025_staging.stag_customer ........... [RUN]
[0m14:59:39.364664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_mart, now model.dbt_project.stag_customer)
[0m14:59:39.365448 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_customer
[0m14:59:39.385956 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_customer"
[0m14:59:39.387878 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_customer
[0m14:59:39.416919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:59:40.243508 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_customer"
[0m14:59:40.244749 [debug] [Thread-1 (]: On model.dbt_project.stag_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


checkout_success AS (
  SELECT
    _id AS customer_id,
    device_id AS device_id,
    email_address AS email_address,
    resolution AS resolution,
    user_id_db AS user_id_db,
    user_agent AS user_agent 
  FROM src
  WHERE collection = 'checkout_success'
)

SELECT * FROM checkout_success
    );
  
[0m14:59:40.937442 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:1a43ae66-1675-467a-832b-fb663bdc3745&page=queryresults
[0m14:59:44.254226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '635097a3-2777-4313-a280-9e782d1ed3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e7c8a1ae0>]}
[0m14:59:44.256640 [info ] [Thread-1 (]: 1 of 6 OK created sql table model glamira_data_2025_staging.stag_customer ...... [[32mCREATE TABLE (26.1k rows, 8.8 GiB processed)[0m in 4.89s]
[0m14:59:44.258789 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_customer
[0m14:59:44.260676 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_location
[0m14:59:44.262532 [info ] [Thread-1 (]: 2 of 6 START sql table model glamira_data_2025_staging.stag_location ........... [RUN]
[0m14:59:44.264121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_customer, now model.dbt_project.stag_location)
[0m14:59:44.265794 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_location
[0m14:59:44.276956 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_location"
[0m14:59:44.281570 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_location
[0m14:59:44.296806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:59:45.139104 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_location"
[0m14:59:45.141191 [debug] [Thread-1 (]: On model.dbt_project.stag_location: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_location"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`location`
),


casted AS (
    SELECT
        src.ip AS ip_address,
        src.city AS city_name, 
        src.country_short AS country_short_name,
        src.country_long AS country_long_name,  
        ROUND(SAFE_CAST(src.latitude AS NUMERIC), 6) AS latitude,
        ROUND(SAFE_CAST(src.longitude AS NUMERIC), 6) AS longitude,
        src.region AS region_name, 
        src.time_zone, 
        src.zip_code
    FROM src
)

SELECT * FROM casted
    );
  
[0m14:59:45.804499 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:86a16a9e-05c0-4957-9786-4abc7811efbf&page=queryresults
[0m14:59:49.955499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '635097a3-2777-4313-a280-9e782d1ed3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e9d6a3790>]}
[0m14:59:49.957519 [info ] [Thread-1 (]: 2 of 6 OK created sql table model glamira_data_2025_staging.stag_location ...... [[32mCREATE TABLE (3.2m rows, 289.2 MiB processed)[0m in 5.69s]
[0m14:59:49.959318 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_location
[0m14:59:49.960710 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_product
[0m14:59:49.962205 [info ] [Thread-1 (]: 3 of 6 START sql table model glamira_data_2025_staging.stag_product ............ [RUN]
[0m14:59:49.963281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_location, now model.dbt_project.stag_product)
[0m14:59:49.964217 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_product
[0m14:59:49.969826 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_product"
[0m14:59:49.971046 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_product
[0m14:59:49.978573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:59:50.841455 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_product"
[0m14:59:50.842797 [debug] [Thread-1 (]: On model.dbt_project.stag_product: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_product"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`product_name`
),

casted AS (
 SELECT
   src.product_id AS product_id,
   src.name AS product_name,
   src.sku AS sku,
   src.gender AS gender,
   src.max_price_format AS max_price_format,
   src.min_price_format AS min_price_format,
   src.type_id AS type_id,
   src.store_code AS store_code
 FROM src
)

SELECT * FROM casted
    );
  
[0m14:59:51.507817 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:64118d6e-cc79-42b3-b269-8e73d9bc340f&page=queryresults
[0m14:59:53.917526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '635097a3-2777-4313-a280-9e782d1ed3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e7c6b4e20>]}
[0m14:59:53.919560 [info ] [Thread-1 (]: 3 of 6 OK created sql table model glamira_data_2025_staging.stag_product ....... [[32mCREATE TABLE (18.8k rows, 1.8 MiB processed)[0m in 3.95s]
[0m14:59:53.921425 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_product
[0m14:59:53.922505 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_sales
[0m14:59:53.924857 [info ] [Thread-1 (]: 4 of 6 START sql table model glamira_data_2025_staging.stag_sales .............. [RUN]
[0m14:59:53.927124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_product, now model.dbt_project.stag_sales)
[0m14:59:53.928889 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_sales
[0m14:59:53.935098 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_sales"
[0m14:59:53.936365 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_sales
[0m14:59:53.942080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:59:54.760202 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_sales"
[0m14:59:54.761344 [debug] [Thread-1 (]: On model.dbt_project.stag_sales: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_sales"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


flattened AS (
 SELECT
   GENERATE_UUID() as sales_id,
   CAST(src.order_id AS INT64) AS order_id,
   src._id AS customer_id,
   src.time_stamp AS date_id,
   src.ip AS ip_address,
   src.time_stamp AS time_stamp,
   src.local_time AS local_time,
   CAST(src.store_id AS INT64) AS store_id,
   cp.product_id AS product_id,
   cp.amount AS amount,
   cp.currency AS currency_code,
   cp.price AS price,
 FROM src,
 UNNEST(src.cart_products) AS cp
 WHERE collection = 'checkout_success'
)


SELECT * FROM flattened
    );
  
[0m14:59:55.457921 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:65f4dbfd-70c3-4293-a0f8-6e7ae4c36fc5&page=queryresults
[0m14:59:58.789633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '635097a3-2777-4313-a280-9e782d1ed3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e7ba02b90>]}
[0m14:59:58.791311 [info ] [Thread-1 (]: 4 of 6 OK created sql table model glamira_data_2025_staging.stag_sales ......... [[32mCREATE TABLE (35.1k rows, 3.7 GiB processed)[0m in 4.86s]
[0m14:59:58.792678 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_sales
[0m14:59:58.793559 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_customer
[0m14:59:58.795350 [info ] [Thread-1 (]: 5 of 6 START sql table model glamira_data_2025_warehouse.dim_customer .......... [RUN]
[0m14:59:58.796763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_sales, now model.dbt_project.dim_customer)
[0m14:59:58.798215 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_customer
[0m14:59:58.806106 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_customer"
[0m14:59:58.808684 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_customer
[0m14:59:58.819499 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_customer"
[0m14:59:58.821940 [debug] [Thread-1 (]: On model.dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
),

customer AS (
    SELECT
        customer_id,
        email_address,
        resolution,
        user_agent
    FROM src 
)

SELECT * FROM customer
    );
  
[0m14:59:58.823498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:59:59.866380 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:133fb583-4260-46ab-9cd2-3d8840bd4e08&page=queryresults
[0m15:00:02.262675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '635097a3-2777-4313-a280-9e782d1ed3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e9d6a3790>]}
[0m15:00:02.264318 [info ] [Thread-1 (]: 5 of 6 OK created sql table model glamira_data_2025_warehouse.dim_customer ..... [[32mCREATE TABLE (26.1k rows, 4.4 MiB processed)[0m in 3.47s]
[0m15:00:02.265932 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_customer
[0m15:00:02.266804 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_store
[0m15:00:02.267815 [info ] [Thread-1 (]: 6 of 6 START sql table model glamira_data_2025_warehouse.dim_store ............. [RUN]
[0m15:00:02.268670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_customer, now model.dbt_project.dim_store)
[0m15:00:02.269371 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_store
[0m15:00:02.278157 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_store"
[0m15:00:02.280067 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_store
[0m15:00:02.286690 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_store"
[0m15:00:02.287851 [debug] [Thread-1 (]: On model.dbt_project.dim_store: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_store"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_store`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
),

store AS (
    SELECT
        DISTINCT store_id,
        CONCAT("Store ", CAST(store_id AS STRING)) AS store_name
    FROM src
)

SELECT * FROM store
    );
  
[0m15:00:02.289302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:03.406380 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:be706a0f-21a3-47cd-8807-fc69519cc460&page=queryresults
[0m15:00:05.797571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '635097a3-2777-4313-a280-9e782d1ed3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e7ba328c0>]}
[0m15:00:05.799945 [info ] [Thread-1 (]: 6 of 6 OK created sql table model glamira_data_2025_warehouse.dim_store ........ [[32mCREATE TABLE (65.0 rows, 273.9 KiB processed)[0m in 3.53s]
[0m15:00:05.802262 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_store
[0m15:00:05.806674 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:00:05.810824 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:05.812608 [debug] [MainThread]: Connection 'model.dbt_project.dim_store' was properly closed.
[0m15:00:05.814985 [info ] [MainThread]: 
[0m15:00:05.816208 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 32.99 seconds (32.99s).
[0m15:00:05.820543 [debug] [MainThread]: Command end result
[0m15:00:05.939005 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m15:00:05.941956 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m15:00:05.958472 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m15:00:05.959731 [info ] [MainThread]: 
[0m15:00:05.961163 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:00:05.962666 [info ] [MainThread]: 
[0m15:00:05.966133 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m15:00:05.968536 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 38.2936, "process_in_blocks": "0", "process_kernel_time": 0.586803, "process_mem_max_rss": "357176", "process_out_blocks": "2808", "process_user_time": 9.999531}
[0m15:00:05.969857 [debug] [MainThread]: Command `dbt run` succeeded at 15:00:05.969556 after 38.30 seconds
[0m15:00:05.972167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e9d3a94e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e9d2827d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e7c883a60>]}
[0m15:00:05.973761 [debug] [MainThread]: Flushing usage events
[0m15:00:08.331424 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:19:36.676625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3ca34b1540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3ca245c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3ca245c730>]}


============================== 15:19:36.680120 | e1cef334-9c33-4e9b-ad72-eeb7f46a2ee6 ==============================
[0m15:19:36.680120 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:19:36.681259 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/dunhan/dbt_project/logs', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'invocation_command': 'dbt run', 'version_check': 'True', 'static_parser': 'True', 'printer_width': '80', 'log_format': 'default', 'fail_fast': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'quiet': 'False', 'introspect': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/home/dunhan/.dbt', 'empty': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:19:39.700748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1cef334-9c33-4e9b-ad72-eeb7f46a2ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3c8319a8f0>]}
[0m15:19:39.813576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1cef334-9c33-4e9b-ad72-eeb7f46a2ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3c83122620>]}
[0m15:19:39.814558 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:19:40.165615 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:19:40.404916 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:19:40.405892 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:19:40.497180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1cef334-9c33-4e9b-ad72-eeb7f46a2ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3c82a15f90>]}
[0m15:19:40.677875 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m15:19:40.680772 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m15:19:40.704161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1cef334-9c33-4e9b-ad72-eeb7f46a2ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3c82bc9b40>]}
[0m15:19:40.705178 [info ] [MainThread]: Found 14 models, 38 data tests, 3 sources, 495 macros
[0m15:19:40.706115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1cef334-9c33-4e9b-ad72-eeb7f46a2ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3c82bcad10>]}
[0m15:19:40.709639 [info ] [MainThread]: 
[0m15:19:40.710425 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:19:40.711346 [info ] [MainThread]: 
[0m15:19:40.712806 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:19:40.723192 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m15:19:40.724213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:41.655323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:42.529677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now list_symmetric-fin-469415-q9_glamira_data_2025_staging)
[0m15:19:42.531038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:43.345644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_staging, now list_symmetric-fin-469415-q9_glamira_data_2025_mart)
[0m15:19:43.347538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:44.307955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_mart, now list_symmetric-fin-469415-q9_glamira_data_2025_warehouse)
[0m15:19:44.308991 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:45.064993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1cef334-9c33-4e9b-ad72-eeb7f46a2ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3c82b8ead0>]}
[0m15:19:45.066042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:19:45.072068 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_customer
[0m15:19:45.073418 [info ] [Thread-1 (]: 1 of 7 START sql table model glamira_data_2025_staging.stag_customer ........... [RUN]
[0m15:19:45.074531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_warehouse, now model.dbt_project.stag_customer)
[0m15:19:45.075330 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_customer
[0m15:19:45.097460 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_customer"
[0m15:19:45.098685 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_customer
[0m15:19:45.129394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:45.999048 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_customer"
[0m15:19:46.000450 [debug] [Thread-1 (]: On model.dbt_project.stag_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


checkout_success AS (
  SELECT
    _id AS customer_id,
    device_id AS device_id,
    email_address AS email_address,
    resolution AS resolution,
    user_id_db AS user_id_db,
    user_agent AS user_agent 
  FROM src
  WHERE collection = 'checkout_success'
)

SELECT * FROM checkout_success
    );
  
[0m15:19:46.709507 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:d711b742-7c73-4229-bbc9-a98b3dcc9b84&page=queryresults
[0m15:19:51.526902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1cef334-9c33-4e9b-ad72-eeb7f46a2ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3c85f92800>]}
[0m15:19:51.528224 [info ] [Thread-1 (]: 1 of 7 OK created sql table model glamira_data_2025_staging.stag_customer ...... [[32mCREATE TABLE (26.1k rows, 8.8 GiB processed)[0m in 6.45s]
[0m15:19:51.529615 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_customer
[0m15:19:51.530753 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_location
[0m15:19:51.532295 [info ] [Thread-1 (]: 2 of 7 START sql table model glamira_data_2025_staging.stag_location ........... [RUN]
[0m15:19:51.533352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_customer, now model.dbt_project.stag_location)
[0m15:19:51.534365 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_location
[0m15:19:51.541975 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_location"
[0m15:19:51.543553 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_location
[0m15:19:51.550696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:52.356497 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_location"
[0m15:19:52.357790 [debug] [Thread-1 (]: On model.dbt_project.stag_location: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_location"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`location`
),


casted AS (
    SELECT
        src.ip AS ip_address,
        src.city AS city_name, 
        src.country_short AS country_short_name,
        src.country_long AS country_long_name,  
        ROUND(SAFE_CAST(src.latitude AS NUMERIC), 6) AS latitude,
        ROUND(SAFE_CAST(src.longitude AS NUMERIC), 6) AS longitude,
        src.region AS region_name, 
        src.time_zone, 
        src.zip_code
    FROM src
)

SELECT * FROM casted
    );
  
[0m15:19:53.032350 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:a32702c0-74fa-407f-ab3a-dbafd280c8a6&page=queryresults
[0m15:19:57.559472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1cef334-9c33-4e9b-ad72-eeb7f46a2ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3c82ba1bd0>]}
[0m15:19:57.560636 [info ] [Thread-1 (]: 2 of 7 OK created sql table model glamira_data_2025_staging.stag_location ...... [[32mCREATE TABLE (3.2m rows, 289.2 MiB processed)[0m in 6.03s]
[0m15:19:57.562339 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_location
[0m15:19:57.563523 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_product
[0m15:19:57.564692 [info ] [Thread-1 (]: 3 of 7 START sql table model glamira_data_2025_staging.stag_product ............ [RUN]
[0m15:19:57.565574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_location, now model.dbt_project.stag_product)
[0m15:19:57.566616 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_product
[0m15:19:57.573478 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_product"
[0m15:19:57.574369 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_product
[0m15:19:57.581996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:58.415850 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_product"
[0m15:19:58.417242 [debug] [Thread-1 (]: On model.dbt_project.stag_product: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_product"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`product_name`
),

casted AS (
 SELECT
   src.product_id AS product_id,
   src.name AS product_name,
   src.sku AS sku,
   src.gender AS gender,
   src.max_price_format AS max_price_format,
   src.min_price_format AS min_price_format,
   src.type_id AS type_id,
   src.store_code AS store_code
 FROM src
)

SELECT * FROM casted
    );
  
[0m15:19:59.053630 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:c6dc73fe-dba7-496c-99e3-bf6856894659&page=queryresults
[0m15:20:01.715442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1cef334-9c33-4e9b-ad72-eeb7f46a2ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3c85f92800>]}
[0m15:20:01.716844 [info ] [Thread-1 (]: 3 of 7 OK created sql table model glamira_data_2025_staging.stag_product ....... [[32mCREATE TABLE (18.8k rows, 1.8 MiB processed)[0m in 4.15s]
[0m15:20:01.718864 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_product
[0m15:20:01.719821 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_sales
[0m15:20:01.720965 [info ] [Thread-1 (]: 4 of 7 START sql table model glamira_data_2025_staging.stag_sales .............. [RUN]
[0m15:20:01.721867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_product, now model.dbt_project.stag_sales)
[0m15:20:01.722753 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_sales
[0m15:20:01.729215 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_sales"
[0m15:20:01.730287 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_sales
[0m15:20:01.738220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:02.554999 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_sales"
[0m15:20:02.556216 [debug] [Thread-1 (]: On model.dbt_project.stag_sales: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_sales"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


flattened AS (
 SELECT
   GENERATE_UUID() as sales_id,
   CAST(src.order_id AS INT64) AS order_id,
   src._id AS customer_id,
   src.time_stamp AS date_id,
   src.ip AS ip_address,
   src.time_stamp AS time_stamp,
   src.local_time AS local_time,
   CAST(src.store_id AS INT64) AS store_id,
   cp.product_id AS product_id,
   cp.amount AS amount,
   cp.currency AS currency_code,
   cp.price AS price,
 FROM src,
 UNNEST(src.cart_products) AS cp
 WHERE collection = 'checkout_success'
)


SELECT * FROM flattened
    );
  
[0m15:20:03.246295 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:ab5badd4-26c1-4e76-964c-be70596e8075&page=queryresults
[0m15:20:06.535196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1cef334-9c33-4e9b-ad72-eeb7f46a2ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3c82a7e650>]}
[0m15:20:06.536623 [info ] [Thread-1 (]: 4 of 7 OK created sql table model glamira_data_2025_staging.stag_sales ......... [[32mCREATE TABLE (35.1k rows, 3.7 GiB processed)[0m in 4.81s]
[0m15:20:06.537681 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_sales
[0m15:20:06.538371 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_customer
[0m15:20:06.539449 [info ] [Thread-1 (]: 5 of 7 START sql table model glamira_data_2025_warehouse.dim_customer .......... [RUN]
[0m15:20:06.540477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_sales, now model.dbt_project.dim_customer)
[0m15:20:06.541209 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_customer
[0m15:20:06.546819 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_customer"
[0m15:20:06.548102 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_customer
[0m15:20:06.554232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:07.325869 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_customer"
[0m15:20:07.327084 [debug] [Thread-1 (]: On model.dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
),

customer AS (
    SELECT
        customer_id,
        email_address,
        resolution,
        user_agent
    FROM src 
)

SELECT * FROM customer
    );
  
[0m15:20:07.975930 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:49ea7c57-0443-48f1-b3cd-b4ccf6717e87&page=queryresults
[0m15:20:10.426384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1cef334-9c33-4e9b-ad72-eeb7f46a2ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3c82a041c0>]}
[0m15:20:10.427488 [info ] [Thread-1 (]: 5 of 7 OK created sql table model glamira_data_2025_warehouse.dim_customer ..... [[32mCREATE TABLE (26.1k rows, 4.4 MiB processed)[0m in 3.89s]
[0m15:20:10.428535 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_customer
[0m15:20:10.429270 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_date
[0m15:20:10.430393 [info ] [Thread-1 (]: 6 of 7 START sql table model glamira_data_2025_warehouse.dim_date .............. [RUN]
[0m15:20:10.431345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_customer, now model.dbt_project.dim_date)
[0m15:20:10.431973 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_date
[0m15:20:10.438813 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_date"
[0m15:20:10.440023 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_date
[0m15:20:10.450833 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_date"
[0m15:20:10.452423 [debug] [Thread-1 (]: On model.dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_date"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_date`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
),

date_ AS (
    SELECT DISTINCT
        CAST(FORMAT_DATE('%Y%m%d', DATE(TIMESTAMP_SECONDS(src.time_stamp))) AS INT64) AS date_id,
        DATE(TIMESTAMP_SECONDS(src.time_stamp)) AS full_date
    FROM src
)

SELECT
    date_id,
    full_date,
    FORMAT_DATE('%A', full_date) AS day_of_week,
    CASE WHEN EXTRACT(DAYOFWEEK FROM full_date) IN (1,7) THEN TRUE ELSE FALSE END AS is_weekend,
    EXTRACT(DAY FROM full_date) AS day_of_month,
    FORMAT_DATE('%Y-%m', full_date) AS year_month,
    EXTRACT(MONTH FROM full_date) AS month,
    EXTRACT(ISOWEEK FROM full_date) AS week_of_year,
    CONCAT('Q', CAST(EXTRACT(QUARTER FROM full_date) AS STRING)) AS quarter_number,
    CAST(EXTRACT(YEAR FROM full_date) AS STRING) AS year,
    EXTRACT(YEAR FROM full_date) AS year_number
FROM date_
ORDER BY full_date;
    );
  
[0m15:20:10.453361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:11.231952 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:5fd901d5-0d39-49bc-ad98-8ec4d92e900e&page=queryresults
[0m15:20:11.233273 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:5fd901d5-0d39-49bc-ad98-8ec4d92e900e&page=queryresults
[0m15:20:11.252917 [debug] [Thread-1 (]: Database Error in model dim_date (models/warehouse/dim_date.sql)
  Syntax error: Expected ")" but got ";" at [41:19]
  compiled code at target/run/dbt_project/models/warehouse/dim_date.sql
[0m15:20:11.254433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1cef334-9c33-4e9b-ad72-eeb7f46a2ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3c805077f0>]}
[0m15:20:11.256425 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model glamira_data_2025_warehouse.dim_date ..... [[31mERROR[0m in 0.82s]
[0m15:20:11.258344 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_date
[0m15:20:11.259948 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_store
[0m15:20:11.261468 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.dim_date' to be skipped because of status 'error'.  Reason: Database Error in model dim_date (models/warehouse/dim_date.sql)
  Syntax error: Expected ")" but got ";" at [41:19]
  compiled code at target/run/dbt_project/models/warehouse/dim_date.sql.
[0m15:20:11.263686 [info ] [Thread-1 (]: 7 of 7 START sql table model glamira_data_2025_warehouse.dim_store ............. [RUN]
[0m15:20:11.268136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_date, now model.dbt_project.dim_store)
[0m15:20:11.269493 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_store
[0m15:20:11.279967 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_store"
[0m15:20:11.282675 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_store
[0m15:20:11.290504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:12.070435 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_store"
[0m15:20:12.072122 [debug] [Thread-1 (]: On model.dbt_project.dim_store: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_store"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_store`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
),

store AS (
    SELECT
        DISTINCT store_id,
        CONCAT("Store ", CAST(store_id AS STRING)) AS store_name
    FROM src
)

SELECT * FROM store
    );
  
[0m15:20:12.738763 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:f18d8087-d10d-4d1b-a456-37ba7ebd05cd&page=queryresults
[0m15:20:15.000024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1cef334-9c33-4e9b-ad72-eeb7f46a2ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3c805041f0>]}
[0m15:20:15.001633 [info ] [Thread-1 (]: 7 of 7 OK created sql table model glamira_data_2025_warehouse.dim_store ........ [[32mCREATE TABLE (65.0 rows, 273.9 KiB processed)[0m in 3.73s]
[0m15:20:15.003348 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_store
[0m15:20:15.005492 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:20:15.008186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:15.009030 [debug] [MainThread]: Connection 'model.dbt_project.dim_store' was properly closed.
[0m15:20:15.010406 [info ] [MainThread]: 
[0m15:20:15.011531 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 34.30 seconds (34.30s).
[0m15:20:15.016035 [debug] [MainThread]: Command end result
[0m15:20:15.102784 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m15:20:15.106186 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m15:20:15.117090 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m15:20:15.118106 [info ] [MainThread]: 
[0m15:20:15.119087 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:20:15.120292 [info ] [MainThread]: 
[0m15:20:15.121623 [error] [MainThread]: [31mFailure in model dim_date (models/warehouse/dim_date.sql)[0m
[0m15:20:15.122626 [error] [MainThread]:   Database Error in model dim_date (models/warehouse/dim_date.sql)
  Syntax error: Expected ")" but got ";" at [41:19]
  compiled code at target/run/dbt_project/models/warehouse/dim_date.sql
[0m15:20:15.123552 [info ] [MainThread]: 
[0m15:20:15.124719 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/warehouse/dim_date.sql
[0m15:20:15.125725 [info ] [MainThread]: 
[0m15:20:15.126822 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m15:20:15.128869 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 38.54125, "process_in_blocks": "648", "process_kernel_time": 0.486746, "process_mem_max_rss": "357752", "process_out_blocks": "2848", "process_user_time": 8.478589}
[0m15:20:15.130167 [debug] [MainThread]: Command `dbt run` failed at 15:20:15.129914 after 38.54 seconds
[0m15:20:15.130905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3ca34b1540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3c8319a8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3ca33771f0>]}
[0m15:20:15.131891 [debug] [MainThread]: Flushing usage events
[0m15:20:17.333844 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:20:43.547247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71215ca95570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71215ba147c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71215ba14760>]}


============================== 15:20:43.551112 | be6342af-c1c6-4993-8b09-20d38fcb3770 ==============================
[0m15:20:43.551112 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:20:43.552526 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'quiet': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run --select dim_date', 'log_format': 'default', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/dunhan/.dbt', 'log_path': '/home/dunhan/dbt_project/logs', 'fail_fast': 'False', 'printer_width': '80'}
[0m15:20:46.578374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be6342af-c1c6-4993-8b09-20d38fcb3770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71213c6f5c60>]}
[0m15:20:46.678470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be6342af-c1c6-4993-8b09-20d38fcb3770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71215c24f010>]}
[0m15:20:46.679508 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:20:47.025268 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:20:47.256931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:20:47.257894 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:20:47.350084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be6342af-c1c6-4993-8b09-20d38fcb3770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71213bf09cc0>]}
[0m15:20:47.530757 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m15:20:47.533682 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m15:20:47.554203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be6342af-c1c6-4993-8b09-20d38fcb3770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71213bf0a650>]}
[0m15:20:47.554996 [info ] [MainThread]: Found 14 models, 38 data tests, 3 sources, 495 macros
[0m15:20:47.555699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be6342af-c1c6-4993-8b09-20d38fcb3770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71213bf0b670>]}
[0m15:20:47.558334 [info ] [MainThread]: 
[0m15:20:47.559207 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:20:47.559855 [info ] [MainThread]: 
[0m15:20:47.560852 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:20:47.562574 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m15:20:47.563652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:48.501659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now list_symmetric-fin-469415-q9_glamira_data_2025_warehouse)
[0m15:20:48.502524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:49.253349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_warehouse, now list_symmetric-fin-469415-q9_glamira_data_2025_staging)
[0m15:20:49.254678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:50.055508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_staging, now list_symmetric-fin-469415-q9_glamira_data_2025_mart)
[0m15:20:50.057184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:51.160296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be6342af-c1c6-4993-8b09-20d38fcb3770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71215e4f5270>]}
[0m15:20:51.161231 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:20:51.167699 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_date
[0m15:20:51.169181 [info ] [Thread-1 (]: 1 of 1 START sql table model glamira_data_2025_warehouse.dim_date .............. [RUN]
[0m15:20:51.170503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_mart, now model.dbt_project.dim_date)
[0m15:20:51.171759 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_date
[0m15:20:51.198178 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_date"
[0m15:20:51.200279 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_date
[0m15:20:51.274182 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_date"
[0m15:20:51.275685 [debug] [Thread-1 (]: On model.dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_date"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_date`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
),

date_ AS (
    SELECT DISTINCT
        CAST(FORMAT_DATE('%Y%m%d', DATE(TIMESTAMP_SECONDS(src.time_stamp))) AS INT64) AS date_id,
        DATE(TIMESTAMP_SECONDS(src.time_stamp)) AS full_date
    FROM src
)

SELECT
    date_id,
    full_date,
    FORMAT_DATE('%A', full_date) AS day_of_week,
    CASE WHEN EXTRACT(DAYOFWEEK FROM full_date) IN (1,7) THEN TRUE ELSE FALSE END AS is_weekend,
    EXTRACT(DAY FROM full_date) AS day_of_month,
    FORMAT_DATE('%Y-%m', full_date) AS year_month,
    EXTRACT(MONTH FROM full_date) AS month,
    EXTRACT(ISOWEEK FROM full_date) AS week_of_year,
    CONCAT('Q', CAST(EXTRACT(QUARTER FROM full_date) AS STRING)) AS quarter_number,
    CAST(EXTRACT(YEAR FROM full_date) AS STRING) AS year,
    EXTRACT(YEAR FROM full_date) AS year_number
FROM date_
ORDER BY full_date
    );
  
[0m15:20:51.276422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:52.348804 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:681f4004-ff6c-41a6-974d-c3cdfbdaf879&page=queryresults
[0m15:20:58.480025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be6342af-c1c6-4993-8b09-20d38fcb3770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71213f482680>]}
[0m15:20:58.481314 [info ] [Thread-1 (]: 1 of 1 OK created sql table model glamira_data_2025_warehouse.dim_date ......... [[32mCREATE TABLE (65.0 rows, 273.9 KiB processed)[0m in 7.31s]
[0m15:20:58.482606 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_date
[0m15:20:58.484366 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:20:58.486551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:58.487096 [debug] [MainThread]: Connection 'model.dbt_project.dim_date' was properly closed.
[0m15:20:58.488167 [info ] [MainThread]: 
[0m15:20:58.489376 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.93 seconds (10.93s).
[0m15:20:58.491462 [debug] [MainThread]: Command end result
[0m15:20:58.625746 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m15:20:58.630097 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m15:20:58.653098 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m15:20:58.654250 [info ] [MainThread]: 
[0m15:20:58.655726 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:20:58.656880 [info ] [MainThread]: 
[0m15:20:58.658091 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:20:58.660279 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.2014885, "process_in_blocks": "0", "process_kernel_time": 0.464519, "process_mem_max_rss": "356480", "process_out_blocks": "2688", "process_user_time": 7.001679}
[0m15:20:58.661842 [debug] [MainThread]: Command `dbt run` succeeded at 15:20:58.661569 after 15.20 seconds
[0m15:20:58.663204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71215ca95570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71215c917dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71213c2592d0>]}
[0m15:20:58.664558 [debug] [MainThread]: Flushing usage events
[0m15:21:00.091676 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:48:26.991035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce89aa9570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce88a50790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce88a50730>]}


============================== 20:48:26.997895 | b2f9e33a-9c63-4667-9dab-c4373965ee7e ==============================
[0m20:48:26.997895 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:48:26.998954 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'log_path': '/home/dunhan/dbt_project/logs', 'printer_width': '80', 'log_cache_events': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error': 'None', 'use_colors': 'True', 'target_path': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'empty': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'debug': 'False', 'write_json': 'True', 'profiles_dir': '/home/dunhan/.dbt'}
[0m20:48:31.072496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2f9e33a-9c63-4667-9dab-c4373965ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce899532e0>]}
[0m20:48:31.181320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2f9e33a-9c63-4667-9dab-c4373965ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce88c7a770>]}
[0m20:48:31.182515 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m20:48:31.549749 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:48:31.815295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:48:31.815901 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:48:31.924162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2f9e33a-9c63-4667-9dab-c4373965ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce690982b0>]}
[0m20:48:32.125576 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m20:48:32.129885 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m20:48:32.164307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2f9e33a-9c63-4667-9dab-c4373965ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce690a3a30>]}
[0m20:48:32.165489 [info ] [MainThread]: Found 14 models, 1 seed, 38 data tests, 3 sources, 495 macros
[0m20:48:32.166250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2f9e33a-9c63-4667-9dab-c4373965ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce690a2590>]}
[0m20:48:32.169675 [info ] [MainThread]: 
[0m20:48:32.170639 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:48:32.171768 [info ] [MainThread]: 
[0m20:48:32.173398 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:48:32.186310 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m20:48:32.187817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:33.140431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:48:34.087205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now list_symmetric-fin-469415-q9_glamira_data_2025_warehouse)
[0m20:48:34.087870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:48:34.900005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_warehouse, now list_symmetric-fin-469415-q9_glamira_data_2025_staging)
[0m20:48:34.901704 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:48:35.777272 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_staging, now list_symmetric-fin-469415-q9_glamira_data_2025_mart)
[0m20:48:35.779313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:48:36.771409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2f9e33a-9c63-4667-9dab-c4373965ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce69099630>]}
[0m20:48:36.772359 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:48:36.800119 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_customer
[0m20:48:36.801299 [info ] [Thread-1 (]: 1 of 10 START sql table model glamira_data_2025_staging.stag_customer .......... [RUN]
[0m20:48:36.803399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_mart, now model.dbt_project.stag_customer)
[0m20:48:36.804210 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_customer
[0m20:48:36.829632 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_customer"
[0m20:48:36.831744 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_customer
[0m20:48:36.862847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:37.712617 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_customer"
[0m20:48:37.714013 [debug] [Thread-1 (]: On model.dbt_project.stag_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


checkout_success AS (
  SELECT
    _id AS customer_id,
    device_id AS device_id,
    email_address AS email_address,
    resolution AS resolution,
    user_id_db AS user_id_db,
    user_agent AS user_agent 
  FROM src
  WHERE collection = 'checkout_success'
)

SELECT * FROM checkout_success
    );
  
[0m20:48:38.459420 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:128f2a8e-aa6b-41b7-b009-4fb949477040&page=queryresults
[0m20:48:41.276933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f9e33a-9c63-4667-9dab-c4373965ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce6c582830>]}
[0m20:48:41.278517 [info ] [Thread-1 (]: 1 of 10 OK created sql table model glamira_data_2025_staging.stag_customer ..... [[32mCREATE TABLE (26.1k rows, 8.8 GiB processed)[0m in 4.47s]
[0m20:48:41.279686 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_customer
[0m20:48:41.280365 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_location
[0m20:48:41.281516 [info ] [Thread-1 (]: 2 of 10 START sql table model glamira_data_2025_staging.stag_location .......... [RUN]
[0m20:48:41.282630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_customer, now model.dbt_project.stag_location)
[0m20:48:41.283562 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_location
[0m20:48:41.291245 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_location"
[0m20:48:41.292767 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_location
[0m20:48:41.299762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:42.085463 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_location"
[0m20:48:42.086629 [debug] [Thread-1 (]: On model.dbt_project.stag_location: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_location"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`location`
),

casted AS (
    SELECT
        CONCAT(src.city, src.country_short, src.region) AS location_id,
        src.ip AS ip_address,
        src.city AS city_name, 
        src.country_short AS country_short_name,
        src.country_long AS country_long_name,  
        ROUND(SAFE_CAST(src.latitude AS NUMERIC), 6) AS latitude,
        ROUND(SAFE_CAST(src.longitude AS NUMERIC), 6) AS longitude,
        src.region AS region_name, 
        src.time_zone AS time_zone, 
        src.zip_code AS zip_code
    FROM src
)

SELECT * FROM casted
    );
  
[0m20:48:42.742998 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:640e190b-e6ad-47a2-8118-e2e0dccbe566&page=queryresults
[0m20:48:47.909907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f9e33a-9c63-4667-9dab-c4373965ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce686882e0>]}
[0m20:48:47.911422 [info ] [Thread-1 (]: 2 of 10 OK created sql table model glamira_data_2025_staging.stag_location ..... [[32mCREATE TABLE (3.2m rows, 289.2 MiB processed)[0m in 6.63s]
[0m20:48:47.912744 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_location
[0m20:48:47.913424 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_product
[0m20:48:47.914373 [info ] [Thread-1 (]: 3 of 10 START sql table model glamira_data_2025_staging.stag_product ........... [RUN]
[0m20:48:47.915499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_location, now model.dbt_project.stag_product)
[0m20:48:47.916223 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_product
[0m20:48:47.922747 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_product"
[0m20:48:47.924413 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_product
[0m20:48:47.931045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:48.703609 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_product"
[0m20:48:48.704641 [debug] [Thread-1 (]: On model.dbt_project.stag_product: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_product"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`product_name`
),

casted AS (
 SELECT
   src.product_id AS product_id,
   src.name AS product_name,
   src.sku AS sku,
   src.gender AS gender,
   src.max_price_format AS max_price_format,
   src.min_price_format AS min_price_format,
   src.type_id AS type_id,
   src.store_code AS store_code
 FROM src
)

SELECT * FROM casted
    );
  
[0m20:48:49.398026 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:4dd322f8-1d84-4628-98f4-0d5291e18479&page=queryresults
[0m20:48:51.832281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f9e33a-9c63-4667-9dab-c4373965ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce690b6650>]}
[0m20:48:51.834311 [info ] [Thread-1 (]: 3 of 10 OK created sql table model glamira_data_2025_staging.stag_product ...... [[32mCREATE TABLE (18.8k rows, 1.8 MiB processed)[0m in 3.92s]
[0m20:48:51.835905 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_product
[0m20:48:51.836900 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_sales
[0m20:48:51.838080 [info ] [Thread-1 (]: 4 of 10 START sql table model glamira_data_2025_staging.stag_sales ............. [RUN]
[0m20:48:51.839263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_product, now model.dbt_project.stag_sales)
[0m20:48:51.840008 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_sales
[0m20:48:51.849396 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_sales"
[0m20:48:51.850907 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_sales
[0m20:48:51.857925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:52.798876 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_sales"
[0m20:48:52.800468 [debug] [Thread-1 (]: On model.dbt_project.stag_sales: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_sales"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


flattened AS (
 SELECT
   GENERATE_UUID() as sales_id,
   CAST(src.order_id AS INT64) AS order_id,
   src._id AS customer_id,
   src.time_stamp AS date_id,
   src.ip AS ip_address,
   src.time_stamp AS time_stamp,
   src.local_time AS local_time,
   CAST(src.store_id AS INT64) AS store_id,
   cp.product_id AS product_id,
   cp.amount AS amount,
   cp.currency AS currency_code,
   cp.price AS price
 FROM src,
 UNNEST(src.cart_products) AS cp
 WHERE collection = 'checkout_success'
)


SELECT * FROM flattened
    );
  
[0m20:48:53.481555 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:5436e7c5-6254-46c8-8f8a-918b448baf12&page=queryresults
[0m20:48:56.494219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f9e33a-9c63-4667-9dab-c4373965ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce690962c0>]}
[0m20:48:56.495389 [info ] [Thread-1 (]: 4 of 10 OK created sql table model glamira_data_2025_staging.stag_sales ........ [[32mCREATE TABLE (35.1k rows, 3.7 GiB processed)[0m in 4.65s]
[0m20:48:56.496447 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_sales
[0m20:48:56.497415 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_customer
[0m20:48:56.498325 [info ] [Thread-1 (]: 5 of 10 START sql table model glamira_data_2025_warehouse.dim_customer ......... [RUN]
[0m20:48:56.499362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_sales, now model.dbt_project.dim_customer)
[0m20:48:56.500017 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_customer
[0m20:48:56.506213 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_customer"
[0m20:48:56.507155 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_customer
[0m20:48:56.514193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:57.307425 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_customer"
[0m20:48:57.308935 [debug] [Thread-1 (]: On model.dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
),

customer AS (
    SELECT
        customer_id,
        email_address,
        resolution,
        user_agent
    FROM src 
)

SELECT * FROM customer
    );
  
[0m20:48:57.945759 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:3c0b7dfd-cf95-4465-822a-f72b3d7bf574&page=queryresults
[0m20:49:00.077478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f9e33a-9c63-4667-9dab-c4373965ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce68218880>]}
[0m20:49:00.078684 [info ] [Thread-1 (]: 5 of 10 OK created sql table model glamira_data_2025_warehouse.dim_customer .... [[32mCREATE TABLE (26.1k rows, 4.4 MiB processed)[0m in 3.58s]
[0m20:49:00.079765 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_customer
[0m20:49:00.080582 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_location
[0m20:49:00.081394 [info ] [Thread-1 (]: 6 of 10 START sql table model glamira_data_2025_warehouse.dim_location ......... [RUN]
[0m20:49:00.082648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_customer, now model.dbt_project.dim_location)
[0m20:49:00.083642 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_location
[0m20:49:00.088893 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_location"
[0m20:49:00.092924 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_location
[0m20:49:00.101239 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_location"
[0m20:49:00.102773 [debug] [Thread-1 (]: On model.dbt_project.dim_location: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_location"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_location`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`
),

location_data AS (
    SELECT DISTINCT
        location_id,
        city_name, 
        country_short_name,
        country_long_name,  
        latitude,
        longitude,
        region_name, 
        time_zone, 
        zip_code
    FROM src
)

SELECT * FROM location_data
    );
  
[0m20:49:00.103738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:01.207026 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:2e4601a1-bded-40d1-a741-4676891688fe&page=queryresults
[0m20:49:04.548218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f9e33a-9c63-4667-9dab-c4373965ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce68218880>]}
[0m20:49:04.549405 [info ] [Thread-1 (]: 6 of 10 OK created sql table model glamira_data_2025_warehouse.dim_location .... [[32mCREATE TABLE (52.2k rows, 345.3 MiB processed)[0m in 4.47s]
[0m20:49:04.550470 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_location
[0m20:49:04.551286 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_product
[0m20:49:04.552843 [info ] [Thread-1 (]: 7 of 10 START sql table model glamira_data_2025_warehouse.dim_product .......... [RUN]
[0m20:49:04.554101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_location, now model.dbt_project.dim_product)
[0m20:49:04.555248 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_product
[0m20:49:04.563821 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_product"
[0m20:49:04.565158 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_product
[0m20:49:04.572245 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_product"
[0m20:49:04.573600 [debug] [Thread-1 (]: On model.dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_product"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_product`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`
),

product AS (
 SELECT
   product_id,
   product_name,
   sku,
   gender,
   max_price_format AS max_price,
   min_price_format AS min_price,
   type_id,
   store_code
 FROM src
)

SELECT * FROM product
    );
  
[0m20:49:04.574849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:05.648089 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:1b911509-dad6-45cf-bcdb-d39e38c3082c&page=queryresults
[0m20:49:08.111981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f9e33a-9c63-4667-9dab-c4373965ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce6c582830>]}
[0m20:49:08.113439 [info ] [Thread-1 (]: 7 of 10 OK created sql table model glamira_data_2025_warehouse.dim_product ..... [[32mCREATE TABLE (18.8k rows, 1.8 MiB processed)[0m in 3.56s]
[0m20:49:08.115053 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_product
[0m20:49:08.115835 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_date
[0m20:49:08.116764 [info ] [Thread-1 (]: 8 of 10 START sql table model glamira_data_2025_warehouse.dim_date ............. [RUN]
[0m20:49:08.117542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_product, now model.dbt_project.dim_date)
[0m20:49:08.118217 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_date
[0m20:49:08.125477 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_date"
[0m20:49:08.127061 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_date
[0m20:49:08.132929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:08.950142 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_date"
[0m20:49:08.951789 [debug] [Thread-1 (]: On model.dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_date"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_date`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
),

date_ AS (
    SELECT DISTINCT
        CAST(FORMAT_DATE('%Y%m%d', DATE(TIMESTAMP_SECONDS(src.time_stamp))) AS INT64) AS date_id,
        DATE(TIMESTAMP_SECONDS(src.time_stamp)) AS full_date
    FROM src
)

SELECT
    date_id,
    full_date,
    FORMAT_DATE('%A', full_date) AS day_of_week,
    CASE WHEN EXTRACT(DAYOFWEEK FROM full_date) IN (1,7) THEN TRUE ELSE FALSE END AS is_weekend,
    EXTRACT(DAY FROM full_date) AS day_of_month,
    FORMAT_DATE('%Y-%m', full_date) AS year_month,
    EXTRACT(MONTH FROM full_date) AS month,
    EXTRACT(ISOWEEK FROM full_date) AS week_of_year,
    CONCAT('Q', CAST(EXTRACT(QUARTER FROM full_date) AS STRING)) AS quarter_number,
    CAST(EXTRACT(YEAR FROM full_date) AS STRING) AS year,
    EXTRACT(YEAR FROM full_date) AS year_number
FROM date_
ORDER BY full_date
    );
  
[0m20:49:09.552244 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:fd046bf7-2d93-448c-a025-09cbe4e77ac9&page=queryresults
[0m20:49:15.963692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f9e33a-9c63-4667-9dab-c4373965ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce6868ae30>]}
[0m20:49:15.964844 [info ] [Thread-1 (]: 8 of 10 OK created sql table model glamira_data_2025_warehouse.dim_date ........ [[32mCREATE TABLE (65.0 rows, 273.9 KiB processed)[0m in 7.85s]
[0m20:49:15.966531 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_date
[0m20:49:15.967683 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_store
[0m20:49:15.969002 [info ] [Thread-1 (]: 9 of 10 START sql table model glamira_data_2025_warehouse.dim_store ............ [RUN]
[0m20:49:15.969978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_date, now model.dbt_project.dim_store)
[0m20:49:15.971107 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_store
[0m20:49:15.977383 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_store"
[0m20:49:15.978461 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_store
[0m20:49:15.982352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:16.754295 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_store"
[0m20:49:16.755481 [debug] [Thread-1 (]: On model.dbt_project.dim_store: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_store"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_store`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
),

store AS (
    SELECT
        DISTINCT store_id,
        CONCAT("Store ", CAST(store_id AS STRING)) AS store_name
    FROM src
)

SELECT * FROM store
    );
  
[0m20:49:17.389334 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:ae0eef49-950b-40ff-b6af-87e498edbbcc&page=queryresults
[0m20:49:19.531244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f9e33a-9c63-4667-9dab-c4373965ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce6c582830>]}
[0m20:49:19.532371 [info ] [Thread-1 (]: 9 of 10 OK created sql table model glamira_data_2025_warehouse.dim_store ....... [[32mCREATE TABLE (65.0 rows, 273.9 KiB processed)[0m in 3.56s]
[0m20:49:19.533469 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_store
[0m20:49:19.534121 [debug] [Thread-1 (]: Began running node model.dbt_project.fact_sales
[0m20:49:19.535091 [info ] [Thread-1 (]: 10 of 10 START sql table model glamira_data_2025_warehouse.fact_sales .......... [RUN]
[0m20:49:19.535956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_store, now model.dbt_project.fact_sales)
[0m20:49:19.536626 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fact_sales
[0m20:49:19.544090 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fact_sales"
[0m20:49:19.545166 [debug] [Thread-1 (]: Began executing node model.dbt_project.fact_sales
[0m20:49:19.549510 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fact_sales"
[0m20:49:19.550585 [debug] [Thread-1 (]: On model.dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fact_sales"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`fact_sales`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
),

sales AS (
  SELECT 
    src.sales_id,
    src.order_id,
    src.customer_id,

    CAST(FORMAT_DATE('%Y%m%d', DATE(TIMESTAMP_SECONDS(src.time_stamp))) AS INT64) AS date_id,
    TIMESTAMP_SECONDS(src.time_stamp) AS time_stamp,
    src.local_time,

    l.location_id,
    src.ip_address,

    src.store_id,
    src.product_id,
    src.amount,

    CASE
      WHEN src.currency_code IS NULL OR TRIM(src.currency_code) = "" THEN "USD $"
      WHEN TRIM(src.currency_code) = " din." THEN "din."
      WHEN TRIM(src.currency_code) = "د.ك.‏" THEN "د.ك."
      ELSE TRIM(src.currency_code)
    END AS currency_code,

    CASE
      WHEN src.price LIKE '%,%' AND src.price LIKE '%.%' 
        THEN SAFE_CAST(REPLACE(REPLACE(src.price, '.', ''), ',', '.') AS FLOAT64)
      WHEN src.price LIKE '%,%' 
        THEN SAFE_CAST(REPLACE(src.price, ',', '.') AS FLOAT64)
      ELSE
        SAFE_CAST(src.price AS FLOAT64)
    END AS price
  FROM src
  LEFT JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location` l
    ON src.ip_address = l.ip_address
),

with_rates AS (
  SELECT
    s.*,
    COALESCE(c.exchange_rate, 1.0) AS exchange_rate,
    s.price * COALESCE(c.exchange_rate, 1.0) AS price_in_usd
  FROM sales s
  LEFT JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_currency` c
    ON s.currency_code = c.code OR s.currency_code = c.symbol
)

SELECT
  sales_id,
  order_id,
  customer_id,
  date_id,
  time_stamp,
  local_time,
  location_id,
  ip_address,
  store_id,
  product_id,
  amount,
  price_in_usd,
  price_in_usd * amount AS line_total
FROM with_rates
    );
  
[0m20:49:19.551853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:20.615967 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:71abfa7d-df9f-41e6-b14e-30afc82148fa&page=queryresults
[0m20:49:20.617087 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:71abfa7d-df9f-41e6-b14e-30afc82148fa&page=queryresults
[0m20:49:20.630490 [debug] [Thread-1 (]: Database Error in model fact_sales (models/warehouse/fact_sales.sql)
  Not found: Table symmetric-fin-469415-q9:glamira_data_2025_warehouse.dim_currency was not found in location US
  compiled code at target/run/dbt_project/models/warehouse/fact_sales.sql
[0m20:49:20.631801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f9e33a-9c63-4667-9dab-c4373965ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce68652620>]}
[0m20:49:20.634058 [error] [Thread-1 (]: 10 of 10 ERROR creating sql table model glamira_data_2025_warehouse.fact_sales . [[31mERROR[0m in 1.10s]
[0m20:49:20.636100 [debug] [Thread-1 (]: Finished running node model.dbt_project.fact_sales
[0m20:49:20.637285 [debug] [Thread-4 (]: Marking all children of 'model.dbt_project.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models/warehouse/fact_sales.sql)
  Not found: Table symmetric-fin-469415-q9:glamira_data_2025_warehouse.dim_currency was not found in location US
  compiled code at target/run/dbt_project/models/warehouse/fact_sales.sql.
[0m20:49:20.639855 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:49:20.643881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:20.644884 [debug] [MainThread]: Connection 'model.dbt_project.fact_sales' was properly closed.
[0m20:49:20.645655 [info ] [MainThread]: 
[0m20:49:20.646431 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 48.47 seconds (48.47s).
[0m20:49:20.653440 [debug] [MainThread]: Command end result
[0m20:49:20.731027 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m20:49:20.733613 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m20:49:20.744784 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m20:49:20.745578 [info ] [MainThread]: 
[0m20:49:20.746368 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:49:20.747195 [info ] [MainThread]: 
[0m20:49:20.748044 [error] [MainThread]: [31mFailure in model fact_sales (models/warehouse/fact_sales.sql)[0m
[0m20:49:20.749034 [error] [MainThread]:   Database Error in model fact_sales (models/warehouse/fact_sales.sql)
  Not found: Table symmetric-fin-469415-q9:glamira_data_2025_warehouse.dim_currency was not found in location US
  compiled code at target/run/dbt_project/models/warehouse/fact_sales.sql
[0m20:49:20.749766 [info ] [MainThread]: 
[0m20:49:20.750734 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/warehouse/fact_sales.sql
[0m20:49:20.751747 [info ] [MainThread]: 
[0m20:49:20.752733 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=10
[0m20:49:20.754805 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 53.857456, "process_in_blocks": "181040", "process_kernel_time": 0.730467, "process_mem_max_rss": "358216", "process_out_blocks": "2992", "process_user_time": 9.228008}
[0m20:49:20.755901 [debug] [MainThread]: Command `dbt run` failed at 20:49:20.755732 after 53.86 seconds
[0m20:49:20.756742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce89aa9570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce899532e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce8996a860>]}
[0m20:49:20.757952 [debug] [MainThread]: Flushing usage events
[0m20:49:22.885849 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:51:18.616952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51767b9480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51757586d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5175758670>]}


============================== 20:51:18.622049 | c149c879-faa9-448f-83c1-54d8bc31f5dd ==============================
[0m20:51:18.622049 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:51:18.623084 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'target_path': 'None', 'partial_parse': 'True', 'profiles_dir': '/home/dunhan/.dbt', 'log_format': 'default', 'static_parser': 'True', 'debug': 'False', 'fail_fast': 'False', 'version_check': 'True', 'invocation_command': 'dbt seed', 'no_print': 'None', 'warn_error': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'quiet': 'False', 'empty': 'None', 'log_path': '/home/dunhan/dbt_project/logs', 'use_experimental_parser': 'False', 'introspect': 'True', 'cache_selected_only': 'False'}
[0m20:51:21.617497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c149c879-faa9-448f-83c1-54d8bc31f5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a517825bdf0>]}
[0m20:51:21.716916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c149c879-faa9-448f-83c1-54d8bc31f5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51758a96f0>]}
[0m20:51:21.717924 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m20:51:22.051996 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:51:22.308114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:51:22.308733 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:51:22.414822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c149c879-faa9-448f-83c1-54d8bc31f5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5155acc130>]}
[0m20:51:22.629634 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m20:51:22.632249 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m20:51:22.653395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c149c879-faa9-448f-83c1-54d8bc31f5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5155ade860>]}
[0m20:51:22.654212 [info ] [MainThread]: Found 14 models, 1 seed, 38 data tests, 3 sources, 495 macros
[0m20:51:22.654792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c149c879-faa9-448f-83c1-54d8bc31f5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5155bca1d0>]}
[0m20:51:22.657780 [info ] [MainThread]: 
[0m20:51:22.659027 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:51:22.660084 [info ] [MainThread]: 
[0m20:51:22.661322 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:51:22.662805 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m20:51:22.663586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:23.747511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now list_symmetric-fin-469415-q9_glamira_data_2025_warehouse)
[0m20:51:23.748534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:24.563409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_warehouse, now list_symmetric-fin-469415-q9_glamira_data_2025_staging)
[0m20:51:24.565256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:25.360466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_staging, now list_symmetric-fin-469415-q9_glamira_data_2025_mart)
[0m20:51:25.362186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:26.278070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c149c879-faa9-448f-83c1-54d8bc31f5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51563640d0>]}
[0m20:51:26.278946 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:51:26.286220 [debug] [Thread-1 (]: Began running node seed.dbt_project.dim_currency
[0m20:51:26.287685 [info ] [Thread-1 (]: 1 of 1 START seed file glamira_data_2025_warehouse.dim_currency ................ [RUN]
[0m20:51:26.289376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_mart, now seed.dbt_project.dim_currency)
[0m20:51:26.290039 [debug] [Thread-1 (]: Began compiling node seed.dbt_project.dim_currency
[0m20:51:26.290704 [debug] [Thread-1 (]: Began executing node seed.dbt_project.dim_currency
[0m20:51:26.382026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:31.782439 [debug] [Thread-1 (]: On seed.dbt_project.dim_currency: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "seed.dbt_project.dim_currency"} */

    alter table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_currency` set OPTIONS()
  
[0m20:51:32.232498 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:ae40f110-b3dd-4515-ad71-9faaead79cf1&page=queryresults
[0m20:51:32.940334 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_project.dim_currency"
[0m20:51:32.975633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c149c879-faa9-448f-83c1-54d8bc31f5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5155aab2e0>]}
[0m20:51:32.976617 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file glamira_data_2025_warehouse.dim_currency ............ [[32mINSERT 35[0m in 6.68s]
[0m20:51:32.977612 [debug] [Thread-1 (]: Finished running node seed.dbt_project.dim_currency
[0m20:51:32.979285 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:51:32.981679 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:51:32.982922 [debug] [MainThread]: Connection 'seed.dbt_project.dim_currency' was properly closed.
[0m20:51:32.984094 [info ] [MainThread]: 
[0m20:51:32.985266 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 10.32 seconds (10.32s).
[0m20:51:32.987267 [debug] [MainThread]: Command end result
[0m20:51:33.070946 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m20:51:33.073594 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m20:51:33.082476 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m20:51:33.083085 [info ] [MainThread]: 
[0m20:51:33.084445 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:51:33.085534 [info ] [MainThread]: 
[0m20:51:33.086599 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:51:33.088093 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 14.558339, "process_in_blocks": "24", "process_kernel_time": 0.450425, "process_mem_max_rss": "357308", "process_out_blocks": "2712", "process_user_time": 6.893904}
[0m20:51:33.088823 [debug] [MainThread]: Command `dbt seed` succeeded at 20:51:33.088672 after 14.56 seconds
[0m20:51:33.089560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51767b9480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a517825bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51766b2d10>]}
[0m20:51:33.090998 [debug] [MainThread]: Flushing usage events
[0m20:51:34.582719 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:52:34.441018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c5c8a54e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c5b84c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c5b84c670>]}


============================== 20:52:34.444726 | 49669c43-b6f3-4ed1-b780-3c8212792d40 ==============================
[0m20:52:34.444726 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:52:34.445669 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'printer_width': '80', 'static_parser': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'log_path': '/home/dunhan/dbt_project/logs', 'use_experimental_parser': 'False', 'warn_error': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'profiles_dir': '/home/dunhan/.dbt', 'debug': 'False', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'introspect': 'True', 'log_format': 'default'}
[0m20:52:37.422808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49669c43-b6f3-4ed1-b780-3c8212792d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c5e31cf70>]}
[0m20:52:37.518121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49669c43-b6f3-4ed1-b780-3c8212792d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3c40a290>]}
[0m20:52:37.519118 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m20:52:37.837008 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:52:38.111868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:52:38.112527 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:52:38.221453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49669c43-b6f3-4ed1-b780-3c8212792d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3bd8c130>]}
[0m20:52:38.427090 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m20:52:38.429518 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m20:52:38.451448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49669c43-b6f3-4ed1-b780-3c8212792d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3bd9e890>]}
[0m20:52:38.452402 [info ] [MainThread]: Found 14 models, 1 seed, 38 data tests, 3 sources, 495 macros
[0m20:52:38.453286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49669c43-b6f3-4ed1-b780-3c8212792d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3bd9d4b0>]}
[0m20:52:38.456650 [info ] [MainThread]: 
[0m20:52:38.457478 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:52:38.458327 [info ] [MainThread]: 
[0m20:52:38.459511 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:52:38.471074 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m20:52:38.472444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:39.378296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:40.170137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now list_symmetric-fin-469415-q9_glamira_data_2025_mart)
[0m20:52:40.171221 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:41.285248 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_mart, now list_symmetric-fin-469415-q9_glamira_data_2025_warehouse)
[0m20:52:41.286380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:42.177473 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_warehouse, now list_symmetric-fin-469415-q9_glamira_data_2025_staging)
[0m20:52:42.180296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:42.993037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49669c43-b6f3-4ed1-b780-3c8212792d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3bd8fe80>]}
[0m20:52:42.993840 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:52:42.999283 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_customer
[0m20:52:43.000942 [info ] [Thread-1 (]: 1 of 10 START sql table model glamira_data_2025_staging.stag_customer .......... [RUN]
[0m20:52:43.002181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_staging, now model.dbt_project.stag_customer)
[0m20:52:43.003002 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_customer
[0m20:52:43.022982 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_customer"
[0m20:52:43.024949 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_customer
[0m20:52:43.054888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:43.877239 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_customer"
[0m20:52:43.878606 [debug] [Thread-1 (]: On model.dbt_project.stag_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


checkout_success AS (
  SELECT
    _id AS customer_id,
    device_id AS device_id,
    email_address AS email_address,
    resolution AS resolution,
    user_id_db AS user_id_db,
    user_agent AS user_agent 
  FROM src
  WHERE collection = 'checkout_success'
)

SELECT * FROM checkout_success
    );
  
[0m20:52:44.647100 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:c8cd9e7d-f842-41e8-b447-ac45c7926ff3&page=queryresults
[0m20:52:49.535038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49669c43-b6f3-4ed1-b780-3c8212792d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3f2766b0>]}
[0m20:52:49.536501 [info ] [Thread-1 (]: 1 of 10 OK created sql table model glamira_data_2025_staging.stag_customer ..... [[32mCREATE TABLE (26.1k rows, 8.8 GiB processed)[0m in 6.53s]
[0m20:52:49.537477 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_customer
[0m20:52:49.538265 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_location
[0m20:52:49.539218 [info ] [Thread-1 (]: 2 of 10 START sql table model glamira_data_2025_staging.stag_location .......... [RUN]
[0m20:52:49.540190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_customer, now model.dbt_project.stag_location)
[0m20:52:49.541028 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_location
[0m20:52:49.546353 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_location"
[0m20:52:49.547413 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_location
[0m20:52:49.553579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:50.299380 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_location"
[0m20:52:50.300887 [debug] [Thread-1 (]: On model.dbt_project.stag_location: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_location"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`location`
),

casted AS (
    SELECT
        CONCAT(src.city, src.country_short, src.region) AS location_id,
        src.ip AS ip_address,
        src.city AS city_name, 
        src.country_short AS country_short_name,
        src.country_long AS country_long_name,  
        ROUND(SAFE_CAST(src.latitude AS NUMERIC), 6) AS latitude,
        ROUND(SAFE_CAST(src.longitude AS NUMERIC), 6) AS longitude,
        src.region AS region_name, 
        src.time_zone AS time_zone, 
        src.zip_code AS zip_code
    FROM src
)

SELECT * FROM casted
    );
  
[0m20:52:50.940821 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:09321c62-5169-42af-9a29-98411aadb6e3&page=queryresults
[0m20:52:55.138229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49669c43-b6f3-4ed1-b780-3c8212792d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3c43dcf0>]}
[0m20:52:55.139728 [info ] [Thread-1 (]: 2 of 10 OK created sql table model glamira_data_2025_staging.stag_location ..... [[32mCREATE TABLE (3.2m rows, 289.2 MiB processed)[0m in 5.60s]
[0m20:52:55.141375 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_location
[0m20:52:55.142185 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_product
[0m20:52:55.143331 [info ] [Thread-1 (]: 3 of 10 START sql table model glamira_data_2025_staging.stag_product ........... [RUN]
[0m20:52:55.144213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_location, now model.dbt_project.stag_product)
[0m20:52:55.144876 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_product
[0m20:52:55.151229 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_product"
[0m20:52:55.152443 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_product
[0m20:52:55.156955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:55.957757 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_product"
[0m20:52:55.958827 [debug] [Thread-1 (]: On model.dbt_project.stag_product: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_product"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`product_name`
),

casted AS (
 SELECT
   src.product_id AS product_id,
   src.name AS product_name,
   src.sku AS sku,
   src.gender AS gender,
   src.max_price_format AS max_price_format,
   src.min_price_format AS min_price_format,
   src.type_id AS type_id,
   src.store_code AS store_code
 FROM src
)

SELECT * FROM casted
    );
  
[0m20:52:56.578464 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:15fee3f1-ac8c-4286-a8d4-5dc587c0f633&page=queryresults
[0m20:52:58.993913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49669c43-b6f3-4ed1-b780-3c8212792d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3bd9c430>]}
[0m20:52:58.995462 [info ] [Thread-1 (]: 3 of 10 OK created sql table model glamira_data_2025_staging.stag_product ...... [[32mCREATE TABLE (18.8k rows, 1.8 MiB processed)[0m in 3.85s]
[0m20:52:58.996544 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_product
[0m20:52:58.997302 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_sales
[0m20:52:58.999105 [info ] [Thread-1 (]: 4 of 10 START sql table model glamira_data_2025_staging.stag_sales ............. [RUN]
[0m20:52:59.000376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_product, now model.dbt_project.stag_sales)
[0m20:52:59.001276 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_sales
[0m20:52:59.012118 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_sales"
[0m20:52:59.013777 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_sales
[0m20:52:59.021947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:59.805684 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_sales"
[0m20:52:59.806788 [debug] [Thread-1 (]: On model.dbt_project.stag_sales: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_sales"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


flattened AS (
 SELECT
   GENERATE_UUID() as sales_id,
   CAST(src.order_id AS INT64) AS order_id,
   src._id AS customer_id,
   src.time_stamp AS date_id,
   src.ip AS ip_address,
   src.time_stamp AS time_stamp,
   src.local_time AS local_time,
   CAST(src.store_id AS INT64) AS store_id,
   cp.product_id AS product_id,
   cp.amount AS amount,
   cp.currency AS currency_code,
   cp.price AS price
 FROM src,
 UNNEST(src.cart_products) AS cp
 WHERE collection = 'checkout_success'
)


SELECT * FROM flattened
    );
  
[0m20:53:00.501017 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:e381cdc3-29b2-4eb5-aa88-241d7fb54011&page=queryresults
[0m20:53:03.217236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49669c43-b6f3-4ed1-b780-3c8212792d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3f2766b0>]}
[0m20:53:03.219093 [info ] [Thread-1 (]: 4 of 10 OK created sql table model glamira_data_2025_staging.stag_sales ........ [[32mCREATE TABLE (35.1k rows, 3.7 GiB processed)[0m in 4.22s]
[0m20:53:03.220987 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_sales
[0m20:53:03.222495 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_customer
[0m20:53:03.224102 [info ] [Thread-1 (]: 5 of 10 START sql table model glamira_data_2025_warehouse.dim_customer ......... [RUN]
[0m20:53:03.225574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_sales, now model.dbt_project.dim_customer)
[0m20:53:03.227037 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_customer
[0m20:53:03.235454 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_customer"
[0m20:53:03.237353 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_customer
[0m20:53:03.245554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:04.099468 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_customer"
[0m20:53:04.100883 [debug] [Thread-1 (]: On model.dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
),

customer AS (
    SELECT
        customer_id,
        email_address,
        resolution,
        user_agent
    FROM src 
)

SELECT * FROM customer
    );
  
[0m20:53:04.737021 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:56cca761-c836-4cdd-ab7a-5738ef78f916&page=queryresults
[0m20:53:07.136938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49669c43-b6f3-4ed1-b780-3c8212792d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3bd6a440>]}
[0m20:53:07.138267 [info ] [Thread-1 (]: 5 of 10 OK created sql table model glamira_data_2025_warehouse.dim_customer .... [[32mCREATE TABLE (26.1k rows, 4.4 MiB processed)[0m in 3.91s]
[0m20:53:07.139427 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_customer
[0m20:53:07.140088 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_location
[0m20:53:07.141037 [info ] [Thread-1 (]: 6 of 10 START sql table model glamira_data_2025_warehouse.dim_location ......... [RUN]
[0m20:53:07.141972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_customer, now model.dbt_project.dim_location)
[0m20:53:07.143069 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_location
[0m20:53:07.151712 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_location"
[0m20:53:07.153311 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_location
[0m20:53:07.159652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:07.966591 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_location"
[0m20:53:07.968152 [debug] [Thread-1 (]: On model.dbt_project.dim_location: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_location"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_location`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`
),

location_data AS (
    SELECT DISTINCT
        location_id,
        city_name, 
        country_short_name,
        country_long_name,  
        latitude,
        longitude,
        region_name, 
        time_zone, 
        zip_code
    FROM src
)

SELECT * FROM location_data
    );
  
[0m20:53:08.592555 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:ec4faacf-4da5-40bf-8b2c-8951267f1279&page=queryresults
[0m20:53:11.805330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49669c43-b6f3-4ed1-b780-3c8212792d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3c43dcf0>]}
[0m20:53:11.807125 [info ] [Thread-1 (]: 6 of 10 OK created sql table model glamira_data_2025_warehouse.dim_location .... [[32mCREATE TABLE (52.2k rows, 345.3 MiB processed)[0m in 4.66s]
[0m20:53:11.808604 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_location
[0m20:53:11.809697 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_product
[0m20:53:11.811044 [info ] [Thread-1 (]: 7 of 10 START sql table model glamira_data_2025_warehouse.dim_product .......... [RUN]
[0m20:53:11.812682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_location, now model.dbt_project.dim_product)
[0m20:53:11.814115 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_product
[0m20:53:11.827060 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_product"
[0m20:53:11.829028 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_product
[0m20:53:11.838099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:12.618644 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_product"
[0m20:53:12.619936 [debug] [Thread-1 (]: On model.dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_product"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_product`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`
),

product AS (
 SELECT
   product_id,
   product_name,
   sku,
   gender,
   max_price_format AS max_price,
   min_price_format AS min_price,
   type_id,
   store_code
 FROM src
)

SELECT * FROM product
    );
  
[0m20:53:13.239022 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:26d1ca10-721d-4714-bf0e-0831e60b8ef5&page=queryresults
[0m20:53:15.416096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49669c43-b6f3-4ed1-b780-3c8212792d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3bd8eb00>]}
[0m20:53:15.417498 [info ] [Thread-1 (]: 7 of 10 OK created sql table model glamira_data_2025_warehouse.dim_product ..... [[32mCREATE TABLE (18.8k rows, 1.8 MiB processed)[0m in 3.60s]
[0m20:53:15.418537 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_product
[0m20:53:15.419248 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_date
[0m20:53:15.420437 [info ] [Thread-1 (]: 8 of 10 START sql table model glamira_data_2025_warehouse.dim_date ............. [RUN]
[0m20:53:15.421621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_product, now model.dbt_project.dim_date)
[0m20:53:15.422340 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_date
[0m20:53:15.430488 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_date"
[0m20:53:15.432045 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_date
[0m20:53:15.437913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:16.197079 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_date"
[0m20:53:16.198980 [debug] [Thread-1 (]: On model.dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_date"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_date`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
),

date_ AS (
    SELECT DISTINCT
        CAST(FORMAT_DATE('%Y%m%d', DATE(TIMESTAMP_SECONDS(src.time_stamp))) AS INT64) AS date_id,
        DATE(TIMESTAMP_SECONDS(src.time_stamp)) AS full_date
    FROM src
)

SELECT
    date_id,
    full_date,
    FORMAT_DATE('%A', full_date) AS day_of_week,
    CASE WHEN EXTRACT(DAYOFWEEK FROM full_date) IN (1,7) THEN TRUE ELSE FALSE END AS is_weekend,
    EXTRACT(DAY FROM full_date) AS day_of_month,
    FORMAT_DATE('%Y-%m', full_date) AS year_month,
    EXTRACT(MONTH FROM full_date) AS month,
    EXTRACT(ISOWEEK FROM full_date) AS week_of_year,
    CONCAT('Q', CAST(EXTRACT(QUARTER FROM full_date) AS STRING)) AS quarter_number,
    CAST(EXTRACT(YEAR FROM full_date) AS STRING) AS year,
    EXTRACT(YEAR FROM full_date) AS year_number
FROM date_
ORDER BY full_date
    );
  
[0m20:53:16.881923 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:fdead761-b799-40eb-b593-4510416bab80&page=queryresults
[0m20:53:19.079755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49669c43-b6f3-4ed1-b780-3c8212792d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3b384940>]}
[0m20:53:19.081594 [info ] [Thread-1 (]: 8 of 10 OK created sql table model glamira_data_2025_warehouse.dim_date ........ [[32mCREATE TABLE (65.0 rows, 273.9 KiB processed)[0m in 3.66s]
[0m20:53:19.083766 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_date
[0m20:53:19.085307 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_store
[0m20:53:19.086929 [info ] [Thread-1 (]: 9 of 10 START sql table model glamira_data_2025_warehouse.dim_store ............ [RUN]
[0m20:53:19.088715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_date, now model.dbt_project.dim_store)
[0m20:53:19.090259 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_store
[0m20:53:19.098624 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_store"
[0m20:53:19.101165 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_store
[0m20:53:19.108793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:19.973424 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_store"
[0m20:53:19.974512 [debug] [Thread-1 (]: On model.dbt_project.dim_store: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_store"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_store`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
),

store AS (
    SELECT
        DISTINCT store_id,
        CONCAT("Store ", CAST(store_id AS STRING)) AS store_name
    FROM src
)

SELECT * FROM store
    );
  
[0m20:53:20.668004 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:25dd079a-475d-4a6b-8977-146c8605765a&page=queryresults
[0m20:53:25.705753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49669c43-b6f3-4ed1-b780-3c8212792d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c397e7130>]}
[0m20:53:25.707432 [info ] [Thread-1 (]: 9 of 10 OK created sql table model glamira_data_2025_warehouse.dim_store ....... [[32mCREATE TABLE (65.0 rows, 273.9 KiB processed)[0m in 6.62s]
[0m20:53:25.708995 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_store
[0m20:53:25.710035 [debug] [Thread-1 (]: Began running node model.dbt_project.fact_sales
[0m20:53:25.711015 [info ] [Thread-1 (]: 10 of 10 START sql table model glamira_data_2025_warehouse.fact_sales .......... [RUN]
[0m20:53:25.711807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_store, now model.dbt_project.fact_sales)
[0m20:53:25.712493 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fact_sales
[0m20:53:25.723070 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fact_sales"
[0m20:53:25.725787 [debug] [Thread-1 (]: Began executing node model.dbt_project.fact_sales
[0m20:53:25.734682 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fact_sales"
[0m20:53:25.736757 [debug] [Thread-1 (]: On model.dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fact_sales"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`fact_sales`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
),

sales AS (
  SELECT 
    src.sales_id,
    src.order_id,
    src.customer_id,

    CAST(FORMAT_DATE('%Y%m%d', DATE(TIMESTAMP_SECONDS(src.time_stamp))) AS INT64) AS date_id,
    TIMESTAMP_SECONDS(src.time_stamp) AS time_stamp,
    src.local_time,

    l.location_id,
    src.ip_address,

    src.store_id,
    src.product_id,
    src.amount,

    CASE
      WHEN src.currency_code IS NULL OR TRIM(src.currency_code) = "" THEN "USD $"
      WHEN TRIM(src.currency_code) = " din." THEN "din."
      WHEN TRIM(src.currency_code) = "د.ك.‏" THEN "د.ك."
      ELSE TRIM(src.currency_code)
    END AS currency_code,

    CASE
      WHEN src.price LIKE '%,%' AND src.price LIKE '%.%' 
        THEN SAFE_CAST(REPLACE(REPLACE(src.price, '.', ''), ',', '.') AS FLOAT64)
      WHEN src.price LIKE '%,%' 
        THEN SAFE_CAST(REPLACE(src.price, ',', '.') AS FLOAT64)
      ELSE
        SAFE_CAST(src.price AS FLOAT64)
    END AS price
  FROM src
  LEFT JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location` l
    ON src.ip_address = l.ip_address
),

with_rates AS (
  SELECT
    s.*,
    COALESCE(c.exchange_rate, 1.0) AS exchange_rate,
    s.price * COALESCE(c.exchange_rate, 1.0) AS price_in_usd
  FROM sales s
  LEFT JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_currency` c
    ON s.currency_code = c.code OR s.currency_code = c.symbol
)

SELECT
  sales_id,
  order_id,
  customer_id,
  date_id,
  time_stamp,
  local_time,
  location_id,
  ip_address,
  store_id,
  product_id,
  amount,
  price_in_usd,
  price_in_usd * amount AS line_total
FROM with_rates
    );
  
[0m20:53:25.737788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:26.755872 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:abe658c7-dd6e-49ee-a60a-d53c2a52770d&page=queryresults
[0m20:53:29.757815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49669c43-b6f3-4ed1-b780-3c8212792d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3bd9c6d0>]}
[0m20:53:29.759023 [info ] [Thread-1 (]: 10 of 10 OK created sql table model glamira_data_2025_warehouse.fact_sales ..... [[32mCREATE TABLE (35.1k rows, 123.6 MiB processed)[0m in 4.05s]
[0m20:53:29.760374 [debug] [Thread-1 (]: Finished running node model.dbt_project.fact_sales
[0m20:53:29.762244 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:53:29.765972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:53:29.767179 [debug] [MainThread]: Connection 'model.dbt_project.fact_sales' was properly closed.
[0m20:53:29.768466 [info ] [MainThread]: 
[0m20:53:29.769981 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 51.31 seconds (51.31s).
[0m20:53:29.775414 [debug] [MainThread]: Command end result
[0m20:53:29.859098 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m20:53:29.862084 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m20:53:29.873534 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m20:53:29.874282 [info ] [MainThread]: 
[0m20:53:29.874998 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:53:29.876122 [info ] [MainThread]: 
[0m20:53:29.877108 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m20:53:29.879196 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 55.529053, "process_in_blocks": "0", "process_kernel_time": 0.497915, "process_mem_max_rss": "357764", "process_out_blocks": "3016", "process_user_time": 9.047466}
[0m20:53:29.880390 [debug] [MainThread]: Command `dbt run` succeeded at 20:53:29.880162 after 55.53 seconds
[0m20:53:29.881458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c5c8a54e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c5c77e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3becb490>]}
[0m20:53:29.882158 [debug] [MainThread]: Flushing usage events
[0m20:53:31.846245 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:37:15.917757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e247cb15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e246c4c760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e246c4c700>]}


============================== 15:37:15.921890 | c6ec47d9-0254-4b56-8212-08cfa81cd81f ==============================
[0m15:37:15.921890 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:37:15.923345 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt ', 'version_check': 'True', 'static_parser': 'True', 'warn_error': 'None', 'no_print': 'None', 'empty': 'None', 'use_colors': 'True', 'quiet': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'debug': 'False', 'profiles_dir': '/home/dunhan/.dbt', 'fail_fast': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'target_path': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/dunhan/dbt_project/logs'}
[0m15:37:16.089138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6ec47d9-0254-4b56-8212-08cfa81cd81f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e2474e9930>]}
[0m15:37:16.110632 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:37:16.112292 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:37:16.115604 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.27852166, "process_in_blocks": "392", "process_kernel_time": 0.125292, "process_mem_max_rss": "96320", "process_out_blocks": "16", "process_user_time": 2.283106}
[0m15:37:16.117078 [debug] [MainThread]: Command `cli deps` succeeded at 15:37:16.116861 after 0.28 seconds
[0m15:37:16.117689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e247cb15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e2474e9930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e246c27340>]}
[0m15:37:16.118304 [debug] [MainThread]: Flushing usage events
[0m15:37:18.062906 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:49:07.120316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76185eab1510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76185da58730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76185da586d0>]}


============================== 15:49:07.125108 | 44acd47e-f39e-4f30-b0d5-0ae7d01fdfa5 ==============================
[0m15:49:07.125108 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:49:07.126415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'profiles_dir': '/home/dunhan/.dbt', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/dunhan/dbt_project/logs', 'write_json': 'True', 'quiet': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run', 'no_print': 'None', 'version_check': 'True', 'debug': 'False', 'introspect': 'True', 'warn_error': 'None', 'empty': 'False'}
[0m15:49:11.279628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44acd47e-f39e-4f30-b0d5-0ae7d01fdfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761860528f40>]}
[0m15:49:11.420605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44acd47e-f39e-4f30-b0d5-0ae7d01fdfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76185da5abf0>]}
[0m15:49:11.421578 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:49:11.844685 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:49:12.175253 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:49:12.175968 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:49:12.303611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44acd47e-f39e-4f30-b0d5-0ae7d01fdfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76183dea4130>]}
[0m15:49:12.508727 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m15:49:12.512600 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m15:49:12.538820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44acd47e-f39e-4f30-b0d5-0ae7d01fdfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76183dec8c10>]}
[0m15:49:12.539650 [info ] [MainThread]: Found 14 models, 1 seed, 38 data tests, 3 sources, 495 macros
[0m15:49:12.540334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44acd47e-f39e-4f30-b0d5-0ae7d01fdfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76183deca6e0>]}
[0m15:49:12.545362 [info ] [MainThread]: 
[0m15:49:12.546592 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:49:12.547950 [info ] [MainThread]: 
[0m15:49:12.549660 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:49:12.562193 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m15:49:12.563107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:13.539080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:14.311053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now list_symmetric-fin-469415-q9_glamira_data_2025_staging)
[0m15:49:14.311879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:15.125577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_staging, now list_symmetric-fin-469415-q9_glamira_data_2025_warehouse)
[0m15:49:15.127400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:15.940331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_warehouse, now list_symmetric-fin-469415-q9_glamira_data_2025_mart)
[0m15:49:15.941022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:16.952546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44acd47e-f39e-4f30-b0d5-0ae7d01fdfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76183dea4220>]}
[0m15:49:16.953474 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:49:16.962402 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_customer
[0m15:49:16.963383 [info ] [Thread-1 (]: 1 of 10 START sql table model glamira_data_2025_staging.stag_customer .......... [RUN]
[0m15:49:16.964273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_mart, now model.dbt_project.stag_customer)
[0m15:49:16.964960 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_customer
[0m15:49:16.986531 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_customer"
[0m15:49:16.987905 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_customer
[0m15:49:17.011959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:17.821134 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_customer"
[0m15:49:17.822390 [debug] [Thread-1 (]: On model.dbt_project.stag_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


checkout_success AS (
  SELECT
    _id AS customer_id,
    device_id AS device_id,
    email_address AS email_address,
    resolution AS resolution,
    user_id_db AS user_id_db,
    user_agent AS user_agent 
  FROM src
  WHERE collection = 'checkout_success'
)

SELECT * FROM checkout_success
    );
  
[0m15:49:18.518811 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:436a7fa7-9e7f-4f69-a370-bacc98d47b36&page=queryresults
[0m15:49:22.460216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44acd47e-f39e-4f30-b0d5-0ae7d01fdfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761841396710>]}
[0m15:49:22.462142 [info ] [Thread-1 (]: 1 of 10 OK created sql table model glamira_data_2025_staging.stag_customer ..... [[32mCREATE TABLE (26.1k rows, 8.8 GiB processed)[0m in 5.49s]
[0m15:49:22.463735 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_customer
[0m15:49:22.464881 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_location
[0m15:49:22.466076 [info ] [Thread-1 (]: 2 of 10 START sql table model glamira_data_2025_staging.stag_location .......... [RUN]
[0m15:49:22.467109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_customer, now model.dbt_project.stag_location)
[0m15:49:22.467763 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_location
[0m15:49:22.474190 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_location"
[0m15:49:22.475340 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_location
[0m15:49:22.479335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:23.253023 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_location"
[0m15:49:23.254221 [debug] [Thread-1 (]: On model.dbt_project.stag_location: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_location"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`location`
),

casted AS (
    SELECT
        CONCAT(src.city, src.country_short, src.region) AS location_id,
        src.ip AS ip_address,
        src.city AS city_name, 
        src.country_short AS country_short_name,
        src.country_long AS country_long_name,  
        ROUND(SAFE_CAST(src.latitude AS NUMERIC), 6) AS latitude,
        ROUND(SAFE_CAST(src.longitude AS NUMERIC), 6) AS longitude,
        src.region AS region_name, 
        src.time_zone AS time_zone, 
        src.zip_code AS zip_code
    FROM src
)

SELECT * FROM casted
    );
  
[0m15:49:23.944824 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:cc9e28b0-e619-4b03-90ec-361c92fe64c6&page=queryresults
[0m15:49:28.158059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44acd47e-f39e-4f30-b0d5-0ae7d01fdfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76185e974d00>]}
[0m15:49:28.161318 [info ] [Thread-1 (]: 2 of 10 OK created sql table model glamira_data_2025_staging.stag_location ..... [[32mCREATE TABLE (3.2m rows, 289.2 MiB processed)[0m in 5.69s]
[0m15:49:28.165286 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_location
[0m15:49:28.167531 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_product
[0m15:49:28.171640 [info ] [Thread-1 (]: 3 of 10 START sql table model glamira_data_2025_staging.stag_product ........... [RUN]
[0m15:49:28.174993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_location, now model.dbt_project.stag_product)
[0m15:49:28.176919 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_product
[0m15:49:28.197182 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_product"
[0m15:49:28.198741 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_product
[0m15:49:28.222033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:29.128946 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_product"
[0m15:49:29.130300 [debug] [Thread-1 (]: On model.dbt_project.stag_product: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_product"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`product_name`
),

casted AS (
 SELECT
   src.product_id AS product_id,
   src.name AS product_name,
   src.sku AS sku,
   src.gender AS gender,
   src.max_price_format AS max_price_format,
   src.min_price_format AS min_price_format,
   src.type_id AS type_id,
   src.store_code AS store_code
 FROM src
)

SELECT * FROM casted
    );
  
[0m15:49:29.712030 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:617e056d-790e-4e3c-85c2-0245aefa77cb&page=queryresults
[0m15:49:32.194942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44acd47e-f39e-4f30-b0d5-0ae7d01fdfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76183d478d60>]}
[0m15:49:32.197099 [info ] [Thread-1 (]: 3 of 10 OK created sql table model glamira_data_2025_staging.stag_product ...... [[32mCREATE TABLE (18.8k rows, 1.8 MiB processed)[0m in 4.02s]
[0m15:49:32.200812 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_product
[0m15:49:32.202635 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_sales
[0m15:49:32.207993 [info ] [Thread-1 (]: 4 of 10 START sql table model glamira_data_2025_staging.stag_sales ............. [RUN]
[0m15:49:32.211891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_product, now model.dbt_project.stag_sales)
[0m15:49:32.216766 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_sales
[0m15:49:32.247288 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_sales"
[0m15:49:32.249415 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_sales
[0m15:49:32.259239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:33.100998 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_sales"
[0m15:49:33.103430 [debug] [Thread-1 (]: On model.dbt_project.stag_sales: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_sales"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
      
    
    

    
    OPTIONS()
    as (
      


WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
),


flattened AS (
 SELECT
   GENERATE_UUID() as sales_id,
   CAST(src.order_id AS INT64) AS order_id,
   src._id AS customer_id,
   src.time_stamp AS date_id,
   src.ip AS ip_address,
   src.time_stamp AS time_stamp,
   src.local_time AS local_time,
   CAST(src.store_id AS INT64) AS store_id,
   cp.product_id AS product_id,
   cp.amount AS amount,
   cp.currency AS currency_code,
   cp.price AS price
 FROM src,
 UNNEST(src.cart_products) AS cp
 WHERE collection = 'checkout_success'
)


SELECT * FROM flattened
    );
  
[0m15:49:33.727343 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:f5459535-e6cc-4d83-8b02-9507331ab4eb&page=queryresults
[0m15:49:41.313386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44acd47e-f39e-4f30-b0d5-0ae7d01fdfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76185e974d00>]}
[0m15:49:41.315320 [info ] [Thread-1 (]: 4 of 10 OK created sql table model glamira_data_2025_staging.stag_sales ........ [[32mCREATE TABLE (35.1k rows, 3.7 GiB processed)[0m in 9.10s]
[0m15:49:41.317051 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_sales
[0m15:49:41.318515 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_customer
[0m15:49:41.320289 [info ] [Thread-1 (]: 5 of 10 START sql table model glamira_data_2025_warehouse.dim_customer ......... [RUN]
[0m15:49:41.321651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_sales, now model.dbt_project.dim_customer)
[0m15:49:41.322818 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_customer
[0m15:49:41.329990 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_customer"
[0m15:49:41.331705 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_customer
[0m15:49:41.339520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:42.201983 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_customer"
[0m15:49:42.203656 [debug] [Thread-1 (]: On model.dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
),

customer AS (
    SELECT
        customer_id,
        email_address,
        resolution,
        user_agent
    FROM src 
)

SELECT * FROM customer
    );
  
[0m15:49:42.874365 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:583b8dd7-b4b4-4627-897b-a4afd6c24d0f&page=queryresults
[0m15:49:45.248118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44acd47e-f39e-4f30-b0d5-0ae7d01fdfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76185e974d00>]}
[0m15:49:45.249927 [info ] [Thread-1 (]: 5 of 10 OK created sql table model glamira_data_2025_warehouse.dim_customer .... [[32mCREATE TABLE (26.1k rows, 4.4 MiB processed)[0m in 3.93s]
[0m15:49:45.251805 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_customer
[0m15:49:45.252886 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_location
[0m15:49:45.254207 [info ] [Thread-1 (]: 6 of 10 START sql table model glamira_data_2025_warehouse.dim_location ......... [RUN]
[0m15:49:45.255790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_customer, now model.dbt_project.dim_location)
[0m15:49:45.257092 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_location
[0m15:49:45.262313 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_location"
[0m15:49:45.263551 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_location
[0m15:49:45.270729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:46.090190 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_location"
[0m15:49:46.091923 [debug] [Thread-1 (]: On model.dbt_project.dim_location: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_location"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_location`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`
),

location_data AS (
    SELECT DISTINCT
        location_id,
        city_name, 
        country_short_name,
        country_long_name,  
        latitude,
        longitude,
        region_name, 
        time_zone, 
        zip_code
    FROM src
)

SELECT * FROM location_data
    );
  
[0m15:49:46.919545 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:0ccb449f-3ea6-41a1-9e20-027dc282c6f6&page=queryresults
[0m15:49:50.435819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44acd47e-f39e-4f30-b0d5-0ae7d01fdfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76185e974d00>]}
[0m15:49:50.437482 [info ] [Thread-1 (]: 6 of 10 OK created sql table model glamira_data_2025_warehouse.dim_location .... [[32mCREATE TABLE (52.2k rows, 345.3 MiB processed)[0m in 5.18s]
[0m15:49:50.438996 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_location
[0m15:49:50.440293 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_product
[0m15:49:50.441650 [info ] [Thread-1 (]: 7 of 10 START sql table model glamira_data_2025_warehouse.dim_product .......... [RUN]
[0m15:49:50.442955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_location, now model.dbt_project.dim_product)
[0m15:49:50.443713 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_product
[0m15:49:50.450973 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_product"
[0m15:49:50.452950 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_product
[0m15:49:50.462036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:51.256140 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_product"
[0m15:49:51.257767 [debug] [Thread-1 (]: On model.dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_product"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_product`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`
),

product AS (
 SELECT
   product_id,
   product_name,
   sku,
   gender,
   max_price_format AS max_price,
   min_price_format AS min_price,
   type_id,
   store_code
 FROM src
)

SELECT * FROM product
    );
  
[0m15:49:51.880438 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:2731b580-c34e-425f-992d-99dd75cadd94&page=queryresults
[0m15:49:54.427979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44acd47e-f39e-4f30-b0d5-0ae7d01fdfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76182f7388b0>]}
[0m15:49:54.429195 [info ] [Thread-1 (]: 7 of 10 OK created sql table model glamira_data_2025_warehouse.dim_product ..... [[32mCREATE TABLE (18.8k rows, 1.8 MiB processed)[0m in 3.98s]
[0m15:49:54.430367 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_product
[0m15:49:54.431050 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_date
[0m15:49:54.431971 [info ] [Thread-1 (]: 8 of 10 START sql table model glamira_data_2025_warehouse.dim_date ............. [RUN]
[0m15:49:54.432789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_product, now model.dbt_project.dim_date)
[0m15:49:54.433508 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_date
[0m15:49:54.439233 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_date"
[0m15:49:54.441027 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_date
[0m15:49:54.447136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:55.191433 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_date"
[0m15:49:55.192993 [debug] [Thread-1 (]: On model.dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_date"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_date`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
),

date_ AS (
    SELECT DISTINCT
        CAST(FORMAT_DATE('%Y%m%d', DATE(TIMESTAMP_SECONDS(src.time_stamp))) AS INT64) AS date_id,
        DATE(TIMESTAMP_SECONDS(src.time_stamp)) AS full_date
    FROM src
)

SELECT
    date_id,
    full_date,
    FORMAT_DATE('%A', full_date) AS day_of_week,
    CASE WHEN EXTRACT(DAYOFWEEK FROM full_date) IN (1,7) THEN TRUE ELSE FALSE END AS is_weekend,
    EXTRACT(DAY FROM full_date) AS day_of_month,
    FORMAT_DATE('%Y-%m', full_date) AS year_month,
    EXTRACT(MONTH FROM full_date) AS month,
    EXTRACT(ISOWEEK FROM full_date) AS week_of_year,
    CONCAT('Q', CAST(EXTRACT(QUARTER FROM full_date) AS STRING)) AS quarter_number,
    CAST(EXTRACT(YEAR FROM full_date) AS STRING) AS year,
    EXTRACT(YEAR FROM full_date) AS year_number
FROM date_
ORDER BY full_date
    );
  
[0m15:49:55.874353 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:ab1581d8-4981-4cfe-a32d-ceef7870c383&page=queryresults
[0m15:49:58.244817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44acd47e-f39e-4f30-b0d5-0ae7d01fdfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76182f7388b0>]}
[0m15:49:58.246162 [info ] [Thread-1 (]: 8 of 10 OK created sql table model glamira_data_2025_warehouse.dim_date ........ [[32mCREATE TABLE (65.0 rows, 273.9 KiB processed)[0m in 3.81s]
[0m15:49:58.247194 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_date
[0m15:49:58.247968 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_store
[0m15:49:58.248969 [info ] [Thread-1 (]: 9 of 10 START sql table model glamira_data_2025_warehouse.dim_store ............ [RUN]
[0m15:49:58.249789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_date, now model.dbt_project.dim_store)
[0m15:49:58.250470 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_store
[0m15:49:58.255568 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_store"
[0m15:49:58.256634 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_store
[0m15:49:58.264216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:59.014703 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_store"
[0m15:49:59.015909 [debug] [Thread-1 (]: On model.dbt_project.dim_store: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_store"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_store`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
),

store AS (
    SELECT
        DISTINCT store_id,
        CONCAT("Store ", CAST(store_id AS STRING)) AS store_name
    FROM src
)

SELECT * FROM store
    );
  
[0m15:49:59.723886 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:bde19f35-1a67-494c-b9af-30715268fb38&page=queryresults
[0m15:50:02.648476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44acd47e-f39e-4f30-b0d5-0ae7d01fdfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76185e974d00>]}
[0m15:50:02.649677 [info ] [Thread-1 (]: 9 of 10 OK created sql table model glamira_data_2025_warehouse.dim_store ....... [[32mCREATE TABLE (65.0 rows, 273.9 KiB processed)[0m in 4.40s]
[0m15:50:02.651012 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_store
[0m15:50:02.652074 [debug] [Thread-1 (]: Began running node model.dbt_project.fact_sales
[0m15:50:02.653051 [info ] [Thread-1 (]: 10 of 10 START sql table model glamira_data_2025_warehouse.fact_sales .......... [RUN]
[0m15:50:02.654216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_store, now model.dbt_project.fact_sales)
[0m15:50:02.655383 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fact_sales
[0m15:50:02.666527 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fact_sales"
[0m15:50:02.668328 [debug] [Thread-1 (]: Began executing node model.dbt_project.fact_sales
[0m15:50:02.675066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:03.475832 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fact_sales"
[0m15:50:03.477740 [debug] [Thread-1 (]: On model.dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fact_sales"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`fact_sales`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
),

sales AS (
  SELECT 
    src.sales_id,
    src.order_id,
    src.customer_id,

    CAST(FORMAT_DATE('%Y%m%d', DATE(TIMESTAMP_SECONDS(src.time_stamp))) AS INT64) AS date_id,
    DATE(TIMESTAMP_SECONDS(src.time_stamp)) AS time_stamp,
    src.local_time,

    l.location_id,
    src.ip_address,

    src.store_id,
    src.product_id,
    src.amount,

    CASE
      WHEN src.currency_code IS NULL OR TRIM(src.currency_code) = "" THEN "USD $"
      WHEN TRIM(src.currency_code) = " din." THEN "din."
      WHEN TRIM(src.currency_code) = "د.ك.‏" THEN "د.ك."
      ELSE TRIM(src.currency_code)
    END AS currency_code,

    CASE
      WHEN src.price LIKE '%,%' AND src.price LIKE '%.%' 
        THEN SAFE_CAST(REPLACE(REPLACE(src.price, '.', ''), ',', '.') AS FLOAT64)
      WHEN src.price LIKE '%,%' 
        THEN SAFE_CAST(REPLACE(src.price, ',', '.') AS FLOAT64)
      ELSE
        SAFE_CAST(src.price AS FLOAT64)
    END AS price
  FROM src
  LEFT JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location` l
    ON src.ip_address = l.ip_address
),

with_rates AS (
  SELECT
    s.*,
    COALESCE(c.exchange_rate, 1.0) AS exchange_rate,
    s.price * COALESCE(c.exchange_rate, 1.0) AS price_in_usd
  FROM sales s
  LEFT JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_currency` c
    ON s.currency_code = c.code OR s.currency_code = c.symbol
)

SELECT
  sales_id,
  order_id,
  customer_id,
  date_id,
  time_stamp,
  local_time,
  location_id,
  ip_address,
  store_id,
  product_id,
  amount,
  currency_code,
  ROUND(price_in_usd, 3) AS price_in_usd,
  ROUND(price_in_usd * amount, 3) AS line_total
FROM with_rates
    );
  
[0m15:50:04.099587 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:3724f0b6-7ecd-477d-8e30-47a02044c260&page=queryresults
[0m15:50:08.640952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44acd47e-f39e-4f30-b0d5-0ae7d01fdfa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76182f607eb0>]}
[0m15:50:08.642225 [info ] [Thread-1 (]: 10 of 10 OK created sql table model glamira_data_2025_warehouse.fact_sales ..... [[32mCREATE TABLE (35.1k rows, 123.6 MiB processed)[0m in 5.99s]
[0m15:50:08.643446 [debug] [Thread-1 (]: Finished running node model.dbt_project.fact_sales
[0m15:50:08.645359 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:50:08.648014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:08.649150 [debug] [MainThread]: Connection 'model.dbt_project.fact_sales' was properly closed.
[0m15:50:08.650344 [info ] [MainThread]: 
[0m15:50:08.651548 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 56.10 seconds (56.10s).
[0m15:50:08.657751 [debug] [MainThread]: Command end result
[0m15:50:08.744242 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m15:50:08.746824 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m15:50:08.760000 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m15:50:08.760938 [info ] [MainThread]: 
[0m15:50:08.761991 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:50:08.763038 [info ] [MainThread]: 
[0m15:50:08.764136 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m15:50:08.766118 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 61.755383, "process_in_blocks": "2280", "process_kernel_time": 0.603896, "process_mem_max_rss": "357968", "process_out_blocks": "2968", "process_user_time": 10.478744}
[0m15:50:08.767390 [debug] [MainThread]: Command `dbt run` succeeded at 15:50:08.767129 after 61.76 seconds
[0m15:50:08.768432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76185eab1510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76185eb1bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76183dfe19c0>]}
[0m15:50:08.769424 [debug] [MainThread]: Flushing usage events
[0m15:50:10.323074 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:09:07.523836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d32b3b1510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d32a35c730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d32a35c6d0>]}


============================== 16:09:07.527346 | 4b65a973-89ef-474a-96e4-f0fdeccacf28 ==============================
[0m16:09:07.527346 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:09:07.528436 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'warn_error': 'None', 'printer_width': '80', 'empty': 'False', 'profiles_dir': '/home/dunhan/.dbt', 'write_json': 'True', 'fail_fast': 'False', 'quiet': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'introspect': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'no_print': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_path': '/home/dunhan/dbt_project/logs', 'version_check': 'True'}
[0m16:09:11.118718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b65a973-89ef-474a-96e4-f0fdeccacf28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d32ce54f40>]}
[0m16:09:11.209501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b65a973-89ef-474a-96e4-f0fdeccacf28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d32a35ebf0>]}
[0m16:09:11.210460 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:09:11.597645 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m16:09:12.025538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:09:12.026148 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:09:12.147239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b65a973-89ef-474a-96e4-f0fdeccacf28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d30a844130>]}
[0m16:09:12.433262 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m16:09:12.435828 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m16:09:12.459922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b65a973-89ef-474a-96e4-f0fdeccacf28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d30a842b60>]}
[0m16:09:12.460795 [info ] [MainThread]: Found 14 models, 1 seed, 38 data tests, 3 sources, 495 macros
[0m16:09:12.461405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b65a973-89ef-474a-96e4-f0fdeccacf28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d30a9b3df0>]}
[0m16:09:12.464543 [info ] [MainThread]: 
[0m16:09:12.465221 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:09:12.465732 [info ] [MainThread]: 
[0m16:09:12.466624 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:09:12.480217 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m16:09:12.481778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:13.379871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:14.221431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now create_symmetric-fin-469415-q9_glamira_data_2025_core)
[0m16:09:14.223055 [debug] [ThreadPool]: Creating schema "database: "symmetric-fin-469415-q9"
schema: "glamira_data_2025_core"
"
[0m16:09:14.249711 [debug] [ThreadPool]: On create_symmetric-fin-469415-q9_glamira_data_2025_core: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_symmetric-fin-469415-q9_glamira_data_2025_core"} */
create schema if not exists `symmetric-fin-469415-q9`.`glamira_data_2025_core`
  
[0m16:09:14.250896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:15.099457 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:7824a7a5-f7c2-4782-b143-d9d0e6513fb3&page=queryresults
[0m16:09:16.112510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_symmetric-fin-469415-q9_glamira_data_2025_core, now list_symmetric-fin-469415-q9_glamira_data_2025_staging)
[0m16:09:16.113368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:16.917286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_staging, now list_symmetric-fin-469415-q9_glamira_data_2025_warehouse)
[0m16:09:16.919752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:17.697323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_warehouse, now list_symmetric-fin-469415-q9_glamira_data_2025_core)
[0m16:09:17.701001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:18.575386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_core, now list_symmetric-fin-469415-q9_glamira_data_2025_mart)
[0m16:09:18.576423 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:19.516949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b65a973-89ef-474a-96e4-f0fdeccacf28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d30a8446d0>]}
[0m16:09:19.517872 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:19.524628 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_customer
[0m16:09:19.525516 [info ] [Thread-1 (]: 1 of 10 START sql table model glamira_data_2025_staging.stag_customer .......... [RUN]
[0m16:09:19.526356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_mart, now model.dbt_project.stag_customer)
[0m16:09:19.527519 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_customer
[0m16:09:19.546070 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_customer"
[0m16:09:19.547910 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_customer
[0m16:09:19.573012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:20.432336 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_customer"
[0m16:09:20.433782 [debug] [Thread-1 (]: On model.dbt_project.stag_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
)

,checkout_success AS (
  SELECT
    _id AS customer_id
    ,device_id AS device_id
    ,email_address AS email_address
    ,resolution AS resolution
    ,user_id_db AS user_id_db
    ,user_agent AS user_agent
  FROM src
  WHERE collection = 'checkout_success'
)

SELECT * FROM checkout_success
    );
  
[0m16:09:21.117132 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:9185809c-a386-450b-8f30-44f2e0d84fd9&page=queryresults
[0m16:09:24.104210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b65a973-89ef-474a-96e4-f0fdeccacf28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d30a8b6fb0>]}
[0m16:09:24.105315 [info ] [Thread-1 (]: 1 of 10 OK created sql table model glamira_data_2025_staging.stag_customer ..... [[32mCREATE TABLE (26.1k rows, 8.8 GiB processed)[0m in 4.58s]
[0m16:09:24.106473 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_customer
[0m16:09:24.107178 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_location
[0m16:09:24.108093 [info ] [Thread-1 (]: 2 of 10 START sql table model glamira_data_2025_staging.stag_location .......... [RUN]
[0m16:09:24.109056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_customer, now model.dbt_project.stag_location)
[0m16:09:24.109874 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_location
[0m16:09:24.116280 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_location"
[0m16:09:24.117210 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_location
[0m16:09:24.125831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:24.937311 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_location"
[0m16:09:24.938358 [debug] [Thread-1 (]: On model.dbt_project.stag_location: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_location"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`location`
)

,casted AS (
    SELECT
        CONCAT(src.city, src.country_short, src.region) AS location_id
        ,src.ip AS ip_address
        ,src.city AS city_name
        ,src.country_short AS country_short_name
        ,src.country_long AS country_long_name
        ,ROUND(SAFE_CAST(src.latitude AS NUMERIC), 6) AS latitude
        ,ROUND(SAFE_CAST(src.longitude AS NUMERIC), 6) AS longitude
        ,src.region AS region_name
        ,src.time_zone AS time_zone
        ,src.zip_code AS zip_code
    FROM src
)

SELECT * FROM casted
    );
  
[0m16:09:25.625686 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:8a78be9a-a68c-4213-8c24-01fd455a7ce0&page=queryresults
[0m16:09:31.127110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b65a973-89ef-474a-96e4-f0fdeccacf28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d32b274d00>]}
[0m16:09:31.128752 [info ] [Thread-1 (]: 2 of 10 OK created sql table model glamira_data_2025_staging.stag_location ..... [[32mCREATE TABLE (3.2m rows, 289.2 MiB processed)[0m in 7.02s]
[0m16:09:31.129897 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_location
[0m16:09:31.130595 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_product
[0m16:09:31.131519 [info ] [Thread-1 (]: 3 of 10 START sql table model glamira_data_2025_staging.stag_product ........... [RUN]
[0m16:09:31.132629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_location, now model.dbt_project.stag_product)
[0m16:09:31.133600 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_product
[0m16:09:31.140519 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_product"
[0m16:09:31.141934 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_product
[0m16:09:31.147897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:31.914398 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_product"
[0m16:09:31.915437 [debug] [Thread-1 (]: On model.dbt_project.stag_product: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_product"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`product_name`
)

,casted AS (
  SELECT
    src.product_id AS product_id
    ,src.name AS product_name
    ,src.sku AS sku
    ,src.gender AS gender
    ,src.max_price_format AS max_price_format
    ,src.min_price_format AS min_price_format
    ,src.type_id AS type_id
    ,src.store_code AS store_code
  FROM src
)

SELECT * FROM casted
    );
  
[0m16:09:32.688232 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:7a00f17d-4306-40f2-9cba-37edcfcd2b9a&page=queryresults
[0m16:09:35.665957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b65a973-89ef-474a-96e4-f0fdeccacf28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d3082041c0>]}
[0m16:09:35.667587 [info ] [Thread-1 (]: 3 of 10 OK created sql table model glamira_data_2025_staging.stag_product ...... [[32mCREATE TABLE (18.8k rows, 1.8 MiB processed)[0m in 4.53s]
[0m16:09:35.669065 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_product
[0m16:09:35.669752 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_sales
[0m16:09:35.670838 [info ] [Thread-1 (]: 4 of 10 START sql table model glamira_data_2025_staging.stag_sales ............. [RUN]
[0m16:09:35.671853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_product, now model.dbt_project.stag_sales)
[0m16:09:35.672700 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_sales
[0m16:09:35.680538 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_sales"
[0m16:09:35.682156 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_sales
[0m16:09:35.689076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:36.457861 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_sales"
[0m16:09:36.459259 [debug] [Thread-1 (]: On model.dbt_project.stag_sales: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_sales"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
)

,flattened AS (
  SELECT
    GENERATE_UUID() as sales_id
    ,CAST(src.order_id AS INT64) AS order_id
    ,src._id AS customer_id
    ,src.time_stamp AS date_id
    ,src.ip AS ip_address
    ,src.time_stamp AS time_stamp
    ,src.local_time AS local_time
    ,CAST(src.store_id AS INT64) AS store_id
    ,cp.product_id AS product_id
    ,cp.amount AS amount
    ,cp.currency AS currency_code
    ,cp.price AS price
  FROM src
  ,UNNEST(src.cart_products) AS cp
  WHERE collection = 'checkout_success'
)

SELECT * FROM flattened
    );
  
[0m16:09:37.611247 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:a2f3be53-f22d-48aa-aa5e-56613661cd4e&page=queryresults
[0m16:09:41.098469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b65a973-89ef-474a-96e4-f0fdeccacf28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d32b274d00>]}
[0m16:09:41.099785 [info ] [Thread-1 (]: 4 of 10 OK created sql table model glamira_data_2025_staging.stag_sales ........ [[32mCREATE TABLE (35.1k rows, 3.7 GiB processed)[0m in 5.43s]
[0m16:09:41.100886 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_sales
[0m16:09:41.101581 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_customer
[0m16:09:41.102857 [info ] [Thread-1 (]: 5 of 10 START sql table model glamira_data_2025_core.dim_customer .............. [RUN]
[0m16:09:41.103725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_sales, now model.dbt_project.dim_customer)
[0m16:09:41.104406 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_customer
[0m16:09:41.110912 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_customer"
[0m16:09:41.115790 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_customer
[0m16:09:41.124369 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_customer"
[0m16:09:41.125825 [debug] [Thread-1 (]: On model.dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
)

,customer AS (
    SELECT
        customer_id
        ,email_address
        ,resolution
        ,user_agent
    FROM src 
)

SELECT * FROM customer
    );
  
[0m16:09:41.126736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:42.453202 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:c4c7c07c-d945-4af0-89ce-47bad54bda89&page=queryresults
[0m16:09:44.904685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b65a973-89ef-474a-96e4-f0fdeccacf28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d32b274d00>]}
[0m16:09:44.906193 [info ] [Thread-1 (]: 5 of 10 OK created sql table model glamira_data_2025_core.dim_customer ......... [[32mCREATE TABLE (26.1k rows, 4.4 MiB processed)[0m in 3.80s]
[0m16:09:44.907181 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_customer
[0m16:09:44.907924 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_location
[0m16:09:44.908750 [info ] [Thread-1 (]: 6 of 10 START sql table model glamira_data_2025_core.dim_location .............. [RUN]
[0m16:09:44.909615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_customer, now model.dbt_project.dim_location)
[0m16:09:44.910282 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_location
[0m16:09:44.915764 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_location"
[0m16:09:44.916813 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_location
[0m16:09:44.923201 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_location"
[0m16:09:44.924382 [debug] [Thread-1 (]: On model.dbt_project.dim_location: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_location"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_location`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`
)

,location_data AS (
    SELECT DISTINCT
        location_id
        ,city_name
        ,country_short_name
        ,country_long_name
        ,latitude
        ,longitude
        ,region_name
        ,time_zone
        ,zip_code
    FROM src
)

SELECT * FROM location_data
    );
  
[0m16:09:44.926219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:46.220393 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:aa595f3e-1976-408b-b07c-ec8a51987aa7&page=queryresults
[0m16:09:49.703336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b65a973-89ef-474a-96e4-f0fdeccacf28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d32b274d00>]}
[0m16:09:49.706107 [info ] [Thread-1 (]: 6 of 10 OK created sql table model glamira_data_2025_core.dim_location ......... [[32mCREATE TABLE (52.2k rows, 345.3 MiB processed)[0m in 4.79s]
[0m16:09:49.708287 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_location
[0m16:09:49.709974 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_product
[0m16:09:49.711760 [info ] [Thread-1 (]: 7 of 10 START sql table model glamira_data_2025_core.dim_product ............... [RUN]
[0m16:09:49.713182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_location, now model.dbt_project.dim_product)
[0m16:09:49.714837 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_product
[0m16:09:49.724130 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_product"
[0m16:09:49.725658 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_product
[0m16:09:49.733057 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_product"
[0m16:09:49.735014 [debug] [Thread-1 (]: On model.dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_product"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_product`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`
)

,product AS (
  SELECT
    product_id
    ,product_name
    ,sku
    ,gender
    ,max_price_format AS max_price
    ,min_price_format AS min_price
    ,type_id
    ,store_code
  FROM src
)

SELECT * FROM product
    );
  
[0m16:09:49.736686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:50.935628 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:0bd7af89-5abd-4837-a578-a709020e4933&page=queryresults
[0m16:09:53.382240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b65a973-89ef-474a-96e4-f0fdeccacf28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d30a8a9db0>]}
[0m16:09:53.383349 [info ] [Thread-1 (]: 7 of 10 OK created sql table model glamira_data_2025_core.dim_product .......... [[32mCREATE TABLE (18.8k rows, 1.8 MiB processed)[0m in 3.67s]
[0m16:09:53.384368 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_product
[0m16:09:53.385036 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_date
[0m16:09:53.385852 [info ] [Thread-1 (]: 8 of 10 START sql table model glamira_data_2025_core.dim_date .................. [RUN]
[0m16:09:53.386899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_product, now model.dbt_project.dim_date)
[0m16:09:53.387968 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_date
[0m16:09:53.398827 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_date"
[0m16:09:53.400494 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_date
[0m16:09:53.408697 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_date"
[0m16:09:53.410009 [debug] [Thread-1 (]: On model.dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_date"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_date`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
)

,date_ AS (
    SELECT DISTINCT
        CAST(FORMAT_DATE('%Y%m%d', DATE(TIMESTAMP_SECONDS(src.time_stamp))) AS INT64) AS date_id
        ,DATE(TIMESTAMP_SECONDS(src.time_stamp)) AS full_date
    FROM src
)

SELECT
    date_id
    ,full_date
    ,FORMAT_DATE('%A', full_date) AS day_of_week
    ,CASE WHEN EXTRACT(DAYOFWEEK FROM full_date) IN (1,7) THEN TRUE ELSE FALSE END AS is_weekend
    ,EXTRACT(DAY FROM full_date) AS day_of_month
    ,FORMAT_DATE('%Y-%m', full_date) AS year_month
    ,EXTRACT(MONTH FROM full_date) AS month
    ,EXTRACT(ISOWEEK FROM full_date) AS week_of_year
    ,CONCAT('Q', CAST(EXTRACT(QUARTER FROM full_date) AS STRING)) AS quarter_number
    ,CAST(EXTRACT(YEAR FROM full_date) AS STRING) AS year
    ,EXTRACT(YEAR FROM full_date) AS year_number
FROM date_
ORDER BY full_date
    );
  
[0m16:09:53.410993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:54.510176 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:b059c99a-7656-440f-9bda-fb650fee52d1&page=queryresults
[0m16:09:57.219738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b65a973-89ef-474a-96e4-f0fdeccacf28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d3082067a0>]}
[0m16:09:57.221037 [info ] [Thread-1 (]: 8 of 10 OK created sql table model glamira_data_2025_core.dim_date ............. [[32mCREATE TABLE (65.0 rows, 273.9 KiB processed)[0m in 3.83s]
[0m16:09:57.222132 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_date
[0m16:09:57.222812 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_store
[0m16:09:57.223736 [info ] [Thread-1 (]: 9 of 10 START sql table model glamira_data_2025_core.dim_store ................. [RUN]
[0m16:09:57.224719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_date, now model.dbt_project.dim_store)
[0m16:09:57.225448 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_store
[0m16:09:57.230793 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_store"
[0m16:09:57.232049 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_store
[0m16:09:57.241770 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_store"
[0m16:09:57.243518 [debug] [Thread-1 (]: On model.dbt_project.dim_store: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_store"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_store`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
)

,store AS (
    SELECT
        DISTINCT store_id
        ,CONCAT("Store ", CAST(store_id AS STRING)) AS store_name
    FROM src
)

SELECT * FROM store
    );
  
[0m16:09:57.244549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:58.292128 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:f14d25ba-e8d9-42c7-a781-e049d9e3462f&page=queryresults
[0m16:10:00.743676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b65a973-89ef-474a-96e4-f0fdeccacf28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d309b2af80>]}
[0m16:10:00.745344 [info ] [Thread-1 (]: 9 of 10 OK created sql table model glamira_data_2025_core.dim_store ............ [[32mCREATE TABLE (65.0 rows, 273.9 KiB processed)[0m in 3.52s]
[0m16:10:00.746980 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_store
[0m16:10:00.748045 [debug] [Thread-1 (]: Began running node model.dbt_project.fact_sales
[0m16:10:00.749449 [info ] [Thread-1 (]: 10 of 10 START sql table model glamira_data_2025_core.fact_sales ............... [RUN]
[0m16:10:00.750941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_store, now model.dbt_project.fact_sales)
[0m16:10:00.752207 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fact_sales
[0m16:10:00.761869 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fact_sales"
[0m16:10:00.764072 [debug] [Thread-1 (]: Began executing node model.dbt_project.fact_sales
[0m16:10:00.771691 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fact_sales"
[0m16:10:00.773008 [debug] [Thread-1 (]: On model.dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fact_sales"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`fact_sales`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
)

,sales AS (
  SELECT 
    src.sales_id
    ,src.order_id
    ,src.customer_id

    ,CAST(FORMAT_DATE('%Y%m%d', DATE(TIMESTAMP_SECONDS(src.time_stamp))) AS INT64) AS date_id
    ,DATE(TIMESTAMP_SECONDS(src.time_stamp)) AS time_stamp
    ,src.local_time
    
    ,l.location_id
    ,src.ip_address

    ,src.store_id
    ,src.product_id
    ,src.amount

    ,CASE
      WHEN src.currency_code IS NULL OR TRIM(src.currency_code) = "" THEN "USD $"
      WHEN TRIM(src.currency_code) = " din." THEN "din."
      WHEN TRIM(src.currency_code) = "د.ك.‏" THEN "د.ك."
      ELSE TRIM(src.currency_code)
    END AS currency_code
    
    ,CASE
      WHEN src.price LIKE '%,%' AND src.price LIKE '%.%' 
        THEN SAFE_CAST(REPLACE(REPLACE(src.price, '.', ''), ',', '.') AS FLOAT64)
      WHEN src.price LIKE '%,%' 
        THEN SAFE_CAST(REPLACE(src.price, ',', '.') AS FLOAT64)
      ELSE
        SAFE_CAST(src.price AS FLOAT64)
    END AS price
  FROM src
  LEFT JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location` l
    ON src.ip_address = l.ip_address
),

with_rates AS (
  SELECT
    s.*
    ,COALESCE(c.exchange_rate, 1.0) AS exchange_rate
    ,s.price * COALESCE(c.exchange_rate, 1.0) AS price_in_usd
  FROM sales s
  LEFT JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_currency` c
    ON s.currency_code = c.code OR s.currency_code = c.symbol
)

SELECT
  sales_id
  ,order_id
  ,customer_id
  ,date_id
  ,time_stamp
  ,local_time
  ,location_id
  ,ip_address
  ,store_id
  ,product_id
  ,amount
  ,currency_code
  ,ROUND(price_in_usd, 3) AS price_in_usd
  ,ROUND(price_in_usd * amount, 3) AS line_total
FROM with_rates
    );
  
[0m16:10:00.773774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:01.963321 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:29f9173b-e8d7-45d2-b4bd-79cbf8f296b7&page=queryresults
[0m16:10:06.737599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b65a973-89ef-474a-96e4-f0fdeccacf28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d3082935e0>]}
[0m16:10:06.738986 [info ] [Thread-1 (]: 10 of 10 OK created sql table model glamira_data_2025_core.fact_sales .......... [[32mCREATE TABLE (35.1k rows, 123.6 MiB processed)[0m in 5.99s]
[0m16:10:06.740002 [debug] [Thread-1 (]: Finished running node model.dbt_project.fact_sales
[0m16:10:06.741517 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:10:06.743700 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:06.744306 [debug] [MainThread]: Connection 'model.dbt_project.fact_sales' was properly closed.
[0m16:10:06.745061 [info ] [MainThread]: 
[0m16:10:06.746060 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 54.28 seconds (54.28s).
[0m16:10:06.749524 [debug] [MainThread]: Command end result
[0m16:10:06.828544 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m16:10:06.832375 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m16:10:06.846213 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m16:10:06.846797 [info ] [MainThread]: 
[0m16:10:06.847513 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:10:06.848099 [info ] [MainThread]: 
[0m16:10:06.849054 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m16:10:06.850731 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 59.404068, "process_in_blocks": "304", "process_kernel_time": 0.562353, "process_mem_max_rss": "357352", "process_out_blocks": "2960", "process_user_time": 10.249765}
[0m16:10:06.851495 [debug] [MainThread]: Command `dbt run` succeeded at 16:10:06.851353 after 59.40 seconds
[0m16:10:06.852408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d32b3b1510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d32b41bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d32abb5270>]}
[0m16:10:06.853560 [debug] [MainThread]: Flushing usage events
[0m16:10:08.367011 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:10:55.843678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7921307b5570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79212f760790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79212f760730>]}


============================== 16:10:55.850314 | 805c5db0-dad9-4e73-a20e-bf8772325bd9 ==============================
[0m16:10:55.850314 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:10:55.851951 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/dunhan/.dbt', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'invocation_command': 'dbt seed', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'target_path': 'None', 'log_format': 'default', 'empty': 'None', 'no_print': 'None', 'introspect': 'True', 'debug': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_path': '/home/dunhan/dbt_project/logs', 'static_parser': 'True', 'partial_parse': 'True', 'version_check': 'True'}
[0m16:10:58.914121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '805c5db0-dad9-4e73-a20e-bf8772325bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792132220d60>]}
[0m16:10:59.009616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '805c5db0-dad9-4e73-a20e-bf8772325bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79212fff2bc0>]}
[0m16:10:59.011336 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:10:59.495965 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m16:10:59.767373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:10:59.768297 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:10:59.946759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '805c5db0-dad9-4e73-a20e-bf8772325bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79210fc48130>]}
[0m16:11:00.224246 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m16:11:00.228212 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m16:11:00.254417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '805c5db0-dad9-4e73-a20e-bf8772325bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79210fc45480>]}
[0m16:11:00.255381 [info ] [MainThread]: Found 14 models, 1 seed, 38 data tests, 3 sources, 495 macros
[0m16:11:00.256487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '805c5db0-dad9-4e73-a20e-bf8772325bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79210fdb5750>]}
[0m16:11:00.259576 [info ] [MainThread]: 
[0m16:11:00.260413 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:11:00.261602 [info ] [MainThread]: 
[0m16:11:00.263238 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:11:00.266002 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m16:11:00.267454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:01.186482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now list_symmetric-fin-469415-q9_glamira_data_2025_staging)
[0m16:11:01.187495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:01.993562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_staging, now list_symmetric-fin-469415-q9_glamira_data_2025_core)
[0m16:11:01.995800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:02.753277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_core, now list_symmetric-fin-469415-q9_glamira_data_2025_mart)
[0m16:11:02.755972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:03.688147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '805c5db0-dad9-4e73-a20e-bf8772325bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79211038e050>]}
[0m16:11:03.688999 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:11:03.695303 [debug] [Thread-1 (]: Began running node seed.dbt_project.dim_currency
[0m16:11:03.696546 [info ] [Thread-1 (]: 1 of 1 START seed file glamira_data_2025_core.dim_currency ..................... [RUN]
[0m16:11:03.697500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_mart, now seed.dbt_project.dim_currency)
[0m16:11:03.698280 [debug] [Thread-1 (]: Began compiling node seed.dbt_project.dim_currency
[0m16:11:03.698928 [debug] [Thread-1 (]: Began executing node seed.dbt_project.dim_currency
[0m16:11:03.824194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:09.382893 [debug] [Thread-1 (]: On seed.dbt_project.dim_currency: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "seed.dbt_project.dim_currency"} */

    alter table `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_currency` set OPTIONS()
  
[0m16:11:09.856650 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:c839ccab-1e7d-4131-850c-938823331182&page=queryresults
[0m16:11:10.503730 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_project.dim_currency"
[0m16:11:10.552824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '805c5db0-dad9-4e73-a20e-bf8772325bd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79210fc552a0>]}
[0m16:11:10.554643 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file glamira_data_2025_core.dim_currency ................. [[32mINSERT 35[0m in 6.85s]
[0m16:11:10.556130 [debug] [Thread-1 (]: Finished running node seed.dbt_project.dim_currency
[0m16:11:10.557946 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:11:10.561009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:10.562044 [debug] [MainThread]: Connection 'seed.dbt_project.dim_currency' was properly closed.
[0m16:11:10.562819 [info ] [MainThread]: 
[0m16:11:10.563908 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 10.30 seconds (10.30s).
[0m16:11:10.565280 [debug] [MainThread]: Command end result
[0m16:11:10.662676 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m16:11:10.666380 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m16:11:10.681027 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m16:11:10.681979 [info ] [MainThread]: 
[0m16:11:10.683300 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:10.684361 [info ] [MainThread]: 
[0m16:11:10.685492 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:11:10.687528 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 14.96283, "process_in_blocks": "16", "process_kernel_time": 0.485065, "process_mem_max_rss": "356732", "process_out_blocks": "2704", "process_user_time": 7.259046}
[0m16:11:10.688836 [debug] [MainThread]: Command `dbt seed` succeeded at 16:11:10.688549 after 14.96 seconds
[0m16:11:10.689988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7921307b5570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79211020f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792130665060>]}
[0m16:11:10.691019 [debug] [MainThread]: Flushing usage events
[0m16:11:12.174309 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:01:29.969967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2feec54b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2fde606d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2fde60670>]}


============================== 23:01:29.975172 | 0e1dbbb3-bc70-4e85-ab73-b06c5584dad3 ==============================
[0m23:01:29.975172 [info ] [MainThread]: Running with dbt=1.10.11
[0m23:01:29.976121 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'partial_parse': 'True', 'log_format': 'default', 'quiet': 'False', 'debug': 'False', 'log_cache_events': 'False', 'log_path': '/home/dunhan/dbt_project/logs', 'no_print': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'printer_width': '80', 'warn_error': 'None', 'version_check': 'True', 'empty': 'False', 'write_json': 'True', 'profiles_dir': '/home/dunhan/.dbt', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'target_path': 'None', 'introspect': 'True'}
[0m23:01:34.364686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e1dbbb3-bc70-4e85-ab73-b06c5584dad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2fdfb1c30>]}
[0m23:01:34.461612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e1dbbb3-bc70-4e85-ab73-b06c5584dad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2fe6a3850>]}
[0m23:01:34.462906 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m23:01:34.791207 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m23:01:35.065117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:01:35.065741 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:01:35.193882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e1dbbb3-bc70-4e85-ab73-b06c5584dad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2de209a50>]}
[0m23:01:35.437215 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m23:01:35.468761 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m23:01:35.500982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e1dbbb3-bc70-4e85-ab73-b06c5584dad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2de251720>]}
[0m23:01:35.502176 [info ] [MainThread]: Found 18 models, 1 seed, 58 data tests, 3 sources, 495 macros
[0m23:01:35.503208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e1dbbb3-bc70-4e85-ab73-b06c5584dad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2de250790>]}
[0m23:01:35.509921 [info ] [MainThread]: 
[0m23:01:35.511334 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:01:35.512646 [info ] [MainThread]: 
[0m23:01:35.513597 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:01:35.526647 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_symmetric-fin-469415-q9'
[0m23:01:35.528159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:36.489581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:01:37.371092 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:01:38.206337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9, now create_symmetric-fin-469415-q9_glamira_data_2025_mart)
[0m23:01:38.221362 [debug] [ThreadPool]: Creating schema "database: "symmetric-fin-469415-q9"
schema: "glamira_data_2025_mart"
"
[0m23:01:38.235236 [debug] [ThreadPool]: On create_symmetric-fin-469415-q9_glamira_data_2025_mart: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_symmetric-fin-469415-q9_glamira_data_2025_mart"} */
create schema if not exists `symmetric-fin-469415-q9`.`glamira_data_2025_mart`
  
[0m23:01:38.235907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:01:39.745207 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:5024c5f2-fd61-4e6d-8a9d-75184c46ddd4&page=queryresults
[0m23:01:40.871603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_symmetric-fin-469415-q9_glamira_data_2025_mart, now list_symmetric-fin-469415-q9_glamira_data_2025_core)
[0m23:01:40.873352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:01:41.882012 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_core, now list_symmetric-fin-469415-q9_glamira_data_2025_staging)
[0m23:01:41.887001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:01:42.714601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_staging, now list_symmetric-fin-469415-q9_glamira_data_2025_mart)
[0m23:01:42.716742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:01:43.864693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e1dbbb3-bc70-4e85-ab73-b06c5584dad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2de91a560>]}
[0m23:01:43.865835 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:01:43.900081 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_customer
[0m23:01:43.901002 [info ] [Thread-1 (]: 1 of 18 START sql table model glamira_data_2025_staging.stag_customer .......... [RUN]
[0m23:01:43.901882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_symmetric-fin-469415-q9_glamira_data_2025_mart, now model.dbt_project.stag_customer)
[0m23:01:43.902512 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_customer
[0m23:01:43.914732 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_customer"
[0m23:01:43.916003 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_customer
[0m23:01:43.950671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:01:44.812188 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_customer"
[0m23:01:44.829426 [debug] [Thread-1 (]: On model.dbt_project.stag_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
)

,checkout_success AS (
  SELECT
    _id AS customer_id
    ,device_id AS device_id
    ,email_address AS email_address
    ,resolution AS resolution
    ,user_id_db AS user_id_db
    ,user_agent AS user_agent
  FROM src
  WHERE collection = 'checkout_success'
)

SELECT * FROM checkout_success
    );
  
[0m23:01:45.555021 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:ff210e5b-9d35-486e-ada1-89c93852ae73&page=queryresults
[0m23:01:48.651581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1dbbb3-bc70-4e85-ab73-b06c5584dad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2e18aa680>]}
[0m23:01:48.653497 [info ] [Thread-1 (]: 1 of 18 OK created sql table model glamira_data_2025_staging.stag_customer ..... [[32mCREATE TABLE (26.1k rows, 8.8 GiB processed)[0m in 4.73s]
[0m23:01:48.655160 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_customer
[0m23:01:48.656295 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_location
[0m23:01:48.657166 [info ] [Thread-1 (]: 2 of 18 START sql table model glamira_data_2025_staging.stag_location .......... [RUN]
[0m23:01:48.658410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_customer, now model.dbt_project.stag_location)
[0m23:01:48.659248 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_location
[0m23:01:48.667875 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_location"
[0m23:01:48.669457 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_location
[0m23:01:48.676940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:01:49.519111 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_location"
[0m23:01:49.520573 [debug] [Thread-1 (]: On model.dbt_project.stag_location: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_location"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`location`
)

,casted AS (
    SELECT
        CONCAT(src.city, src.country_short, src.region) AS location_id
        ,src.ip AS ip_address
        ,src.city AS city_name
        ,src.country_short AS country_short_name
        ,src.country_long AS country_long_name
        ,ROUND(SAFE_CAST(src.latitude AS NUMERIC), 6) AS latitude
        ,ROUND(SAFE_CAST(src.longitude AS NUMERIC), 6) AS longitude
        ,src.region AS region_name
        ,src.time_zone AS time_zone
        ,src.zip_code AS zip_code
    FROM src
)

SELECT * FROM casted
    );
  
[0m23:01:50.258431 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:8242cd7e-7715-4ae8-a96d-c705e842bdc3&page=queryresults
[0m23:01:55.094577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1dbbb3-bc70-4e85-ab73-b06c5584dad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2dd51b0d0>]}
[0m23:01:55.096093 [info ] [Thread-1 (]: 2 of 18 OK created sql table model glamira_data_2025_staging.stag_location ..... [[32mCREATE TABLE (3.2m rows, 289.2 MiB processed)[0m in 6.44s]
[0m23:01:55.097523 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_location
[0m23:01:55.098706 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_product
[0m23:01:55.100157 [info ] [Thread-1 (]: 3 of 18 START sql table model glamira_data_2025_staging.stag_product ........... [RUN]
[0m23:01:55.101458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_location, now model.dbt_project.stag_product)
[0m23:01:55.102768 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_product
[0m23:01:55.107454 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_product"
[0m23:01:55.108367 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_product
[0m23:01:55.113740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:01:55.894555 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_product"
[0m23:01:55.897545 [debug] [Thread-1 (]: On model.dbt_project.stag_product: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_product"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`product_name`
)

,casted AS (
  SELECT
    src.product_id AS product_id
    ,src.name AS product_name
    ,src.sku AS sku
    ,src.gender AS gender
    ,src.max_price_format AS max_price_format
    ,src.min_price_format AS min_price_format
    ,src.type_id AS type_id
    ,src.store_code AS store_code
  FROM src
)

SELECT * FROM casted
    );
  
[0m23:01:56.701342 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:8a620658-dfd0-4699-9d7f-94c836ca7fc1&page=queryresults
[0m23:01:59.172185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1dbbb3-bc70-4e85-ab73-b06c5584dad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2de22c5e0>]}
[0m23:01:59.173337 [info ] [Thread-1 (]: 3 of 18 OK created sql table model glamira_data_2025_staging.stag_product ...... [[32mCREATE TABLE (18.8k rows, 1.8 MiB processed)[0m in 4.07s]
[0m23:01:59.174481 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_product
[0m23:01:59.175304 [debug] [Thread-1 (]: Began running node model.dbt_project.stag_sales
[0m23:01:59.176302 [info ] [Thread-1 (]: 4 of 18 START sql table model glamira_data_2025_staging.stag_sales ............. [RUN]
[0m23:01:59.177537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_product, now model.dbt_project.stag_sales)
[0m23:01:59.178418 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stag_sales
[0m23:01:59.186779 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stag_sales"
[0m23:01:59.187821 [debug] [Thread-1 (]: Began executing node model.dbt_project.stag_sales
[0m23:01:59.192041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:00.003165 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stag_sales"
[0m23:02:00.006197 [debug] [Thread-1 (]: On model.dbt_project.stag_sales: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stag_sales"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
 SELECT *
 FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`
)

,flattened AS (
  SELECT
    GENERATE_UUID() as sales_id
    ,CAST(src.order_id AS INT64) AS order_id
    ,src._id AS customer_id
    ,src.time_stamp AS date_id
    ,src.time_stamp AS time_stamp
    ,src.local_time AS local_time
    ,src.ip AS ip_address
    ,CAST(src.store_id AS INT64) AS store_id
    ,cp.product_id AS product_id
    ,cp.amount AS amount
    ,cp.currency AS currency_code
    ,cp.price AS price
  FROM src
  ,UNNEST(src.cart_products) AS cp
  WHERE collection = 'checkout_success'
)

SELECT * FROM flattened
    );
  
[0m23:02:00.764447 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:6d6e4148-e151-4900-b1c0-ce432fe8c533&page=queryresults
[0m23:02:03.861773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1dbbb3-bc70-4e85-ab73-b06c5584dad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2de22c460>]}
[0m23:02:03.863896 [info ] [Thread-1 (]: 4 of 18 OK created sql table model glamira_data_2025_staging.stag_sales ........ [[32mCREATE TABLE (35.1k rows, 3.7 GiB processed)[0m in 4.68s]
[0m23:02:03.865706 [debug] [Thread-1 (]: Finished running node model.dbt_project.stag_sales
[0m23:02:03.866666 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_customer
[0m23:02:03.868112 [info ] [Thread-1 (]: 5 of 18 START sql table model glamira_data_2025_core.dim_customer .............. [RUN]
[0m23:02:03.869273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stag_sales, now model.dbt_project.dim_customer)
[0m23:02:03.870451 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_customer
[0m23:02:03.878120 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_customer"
[0m23:02:03.879041 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_customer
[0m23:02:03.882702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:04.714743 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_customer"
[0m23:02:04.716067 [debug] [Thread-1 (]: On model.dbt_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customer"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_customer`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`
)

,customer AS (
    SELECT
        customer_id
        ,email_address
        ,resolution
        ,user_agent
    FROM src 
)

SELECT * FROM customer
    );
  
[0m23:02:05.397256 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:61b6deb3-a2b7-4857-8f05-6bb03e2086cc&page=queryresults
[0m23:02:09.544120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1dbbb3-bc70-4e85-ab73-b06c5584dad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2de855b70>]}
[0m23:02:09.545447 [info ] [Thread-1 (]: 5 of 18 OK created sql table model glamira_data_2025_core.dim_customer ......... [[32mCREATE TABLE (26.1k rows, 4.4 MiB processed)[0m in 5.67s]
[0m23:02:09.546636 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_customer
[0m23:02:09.547398 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_location
[0m23:02:09.548235 [info ] [Thread-1 (]: 6 of 18 START sql table model glamira_data_2025_core.dim_location .............. [RUN]
[0m23:02:09.549154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_customer, now model.dbt_project.dim_location)
[0m23:02:09.549787 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_location
[0m23:02:09.554900 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_location"
[0m23:02:09.555889 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_location
[0m23:02:09.560011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:10.495651 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_location"
[0m23:02:10.497041 [debug] [Thread-1 (]: On model.dbt_project.dim_location: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_location"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_location`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`
)

,location_data AS (
    SELECT DISTINCT
        location_id
        ,city_name
        ,country_short_name
        ,country_long_name
        ,latitude
        ,longitude
        ,region_name
        ,time_zone
        ,zip_code
    FROM src
)

SELECT * FROM location_data
    );
  
[0m23:02:11.124196 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:21ab6cca-fc14-4b40-928d-6a5215b79abb&page=queryresults
[0m23:02:14.475390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1dbbb3-bc70-4e85-ab73-b06c5584dad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2e18aa680>]}
[0m23:02:14.476625 [info ] [Thread-1 (]: 6 of 18 OK created sql table model glamira_data_2025_core.dim_location ......... [[32mCREATE TABLE (52.2k rows, 345.3 MiB processed)[0m in 4.93s]
[0m23:02:14.477655 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_location
[0m23:02:14.478388 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_product
[0m23:02:14.479283 [info ] [Thread-1 (]: 7 of 18 START sql table model glamira_data_2025_core.dim_product ............... [RUN]
[0m23:02:14.480084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_location, now model.dbt_project.dim_product)
[0m23:02:14.480704 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_product
[0m23:02:14.485324 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_product"
[0m23:02:14.486384 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_product
[0m23:02:14.489963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:15.295773 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_product"
[0m23:02:15.297269 [debug] [Thread-1 (]: On model.dbt_project.dim_product: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_product"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_product`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`
)

,product AS (
  SELECT
    product_id
    ,product_name
    ,sku
    ,gender
    ,max_price_format AS max_price
    ,min_price_format AS min_price
    ,type_id
    ,store_code
  FROM src
)

SELECT * FROM product
    );
  
[0m23:02:15.978420 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:96131141-43df-47a7-8b6d-804984797391&page=queryresults
[0m23:02:18.521377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1dbbb3-bc70-4e85-ab73-b06c5584dad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2dc41e230>]}
[0m23:02:18.522894 [info ] [Thread-1 (]: 7 of 18 OK created sql table model glamira_data_2025_core.dim_product .......... [[32mCREATE TABLE (18.8k rows, 1.8 MiB processed)[0m in 4.04s]
[0m23:02:18.524354 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_product
[0m23:02:18.525729 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_date
[0m23:02:18.527683 [info ] [Thread-1 (]: 8 of 18 START sql table model glamira_data_2025_core.dim_date .................. [RUN]
[0m23:02:18.530021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_product, now model.dbt_project.dim_date)
[0m23:02:18.531776 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_date
[0m23:02:18.540445 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_date"
[0m23:02:18.541818 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_date
[0m23:02:18.546581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:19.371147 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_date"
[0m23:02:19.372260 [debug] [Thread-1 (]: On model.dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_date"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_date`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
)

,date_ AS (
    SELECT DISTINCT
        CAST(FORMAT_DATE('%Y%m%d', DATE(TIMESTAMP_SECONDS(src.time_stamp))) AS INT64) AS date_id
        ,DATE(TIMESTAMP_SECONDS(src.time_stamp)) AS full_date
    FROM src
)

SELECT
    date_id
    ,full_date
    ,FORMAT_DATE('%A', full_date) AS day_of_week

    ,CASE 
        WHEN EXTRACT(DAYOFWEEK FROM full_date) IN (1,7) THEN TRUE 
        ELSE FALSE 
    END AS is_weekend
    
    ,EXTRACT(DAY FROM full_date) AS day_of_month
    ,FORMAT_DATE('%Y-%m', full_date) AS year_month
    ,EXTRACT(MONTH FROM full_date) AS month
    ,EXTRACT(ISOWEEK FROM full_date) AS week_of_year
    ,CONCAT('Q', CAST(EXTRACT(QUARTER FROM full_date) AS STRING)) AS quarter_number
    ,CAST(EXTRACT(YEAR FROM full_date) AS STRING) AS year
    ,EXTRACT(YEAR FROM full_date) AS year_number
FROM date_
ORDER BY full_date
    );
  
[0m23:02:20.058982 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:0173f358-110e-49ae-aefe-c37f1c377866&page=queryresults
[0m23:02:22.998853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1dbbb3-bc70-4e85-ab73-b06c5584dad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2de2ac790>]}
[0m23:02:23.000152 [info ] [Thread-1 (]: 8 of 18 OK created sql table model glamira_data_2025_core.dim_date ............. [[32mCREATE TABLE (65.0 rows, 273.9 KiB processed)[0m in 4.47s]
[0m23:02:23.001495 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_date
[0m23:02:23.002381 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_store
[0m23:02:23.003895 [info ] [Thread-1 (]: 9 of 18 START sql table model glamira_data_2025_core.dim_store ................. [RUN]
[0m23:02:23.005167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_date, now model.dbt_project.dim_store)
[0m23:02:23.005891 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_store
[0m23:02:23.011774 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_store"
[0m23:02:23.012667 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_store
[0m23:02:23.019803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:23.867357 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_store"
[0m23:02:23.869725 [debug] [Thread-1 (]: On model.dbt_project.dim_store: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_store"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_store`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
    SELECT *
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
)

,store AS (
    SELECT
        DISTINCT store_id
        ,CONCAT("Store ", CAST(store_id AS STRING)) AS store_name
    FROM src
)

SELECT * FROM store
    );
  
[0m23:02:24.550633 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:5d5683c0-28c7-4472-baaf-4ecff91f6919&page=queryresults
[0m23:02:27.008938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1dbbb3-bc70-4e85-ab73-b06c5584dad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2e18aa680>]}
[0m23:02:27.010216 [info ] [Thread-1 (]: 9 of 18 OK created sql table model glamira_data_2025_core.dim_store ............ [[32mCREATE TABLE (65.0 rows, 273.9 KiB processed)[0m in 4.00s]
[0m23:02:27.011371 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_store
[0m23:02:27.012073 [debug] [Thread-1 (]: Began running node model.dbt_project.fact_sales
[0m23:02:27.013005 [info ] [Thread-1 (]: 10 of 18 START sql table model glamira_data_2025_core.fact_sales ............... [RUN]
[0m23:02:27.013994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_store, now model.dbt_project.fact_sales)
[0m23:02:27.015457 [debug] [Thread-1 (]: Began compiling node model.dbt_project.fact_sales
[0m23:02:27.027861 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.fact_sales"
[0m23:02:27.029451 [debug] [Thread-1 (]: Began executing node model.dbt_project.fact_sales
[0m23:02:27.036134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:27.809441 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.fact_sales"
[0m23:02:27.811217 [debug] [Thread-1 (]: On model.dbt_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fact_sales"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`fact_sales`
      
    
    

    
    OPTIONS()
    as (
      

WITH src AS (
  SELECT *
  FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`
)

,sales AS (
  SELECT 
    src.sales_id
    ,src.order_id
    ,src.customer_id

    ,CAST(FORMAT_DATE('%Y%m%d', DATE(TIMESTAMP_SECONDS(src.time_stamp))) AS INT64) AS date_id
    ,DATE(TIMESTAMP_SECONDS(src.time_stamp)) AS time_stamp
    ,src.local_time
    
    ,l.location_id
    ,src.ip_address

    ,src.store_id
    ,src.product_id
    ,src.amount

    ,CASE
      WHEN src.currency_code IS NULL OR TRIM(src.currency_code) = "" THEN "USD $"
      WHEN TRIM(src.currency_code) = " din." THEN "din."
      WHEN TRIM(src.currency_code) = "د.ك.‏" THEN "د.ك."
      ELSE TRIM(src.currency_code)
    END AS currency_code
    
    ,CASE
      WHEN src.price LIKE '%,%' AND src.price LIKE '%.%' 
        THEN SAFE_CAST(REPLACE(REPLACE(src.price, '.', ''), ',', '.') AS FLOAT64)
      WHEN src.price LIKE '%,%' 
        THEN SAFE_CAST(REPLACE(src.price, ',', '.') AS FLOAT64)
      ELSE
        SAFE_CAST(src.price AS FLOAT64)
    END AS price
  FROM src
  LEFT JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location` l
    ON src.ip_address = l.ip_address
),

with_rates AS (
  SELECT
    s.*
    ,COALESCE(c.exchange_rate, 1.0) AS exchange_rate
    ,s.price * COALESCE(c.exchange_rate, 1.0) AS price_in_usd
  FROM sales s
  LEFT JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_currency` c
    ON s.currency_code = c.code OR s.currency_code = c.symbol
)

SELECT
  sales_id
  ,order_id
  ,customer_id
  ,date_id
  ,time_stamp
  ,local_time
  ,location_id
  ,ip_address
  ,store_id
  ,product_id
  ,amount
  ,currency_code
  ,ROUND(price_in_usd, 3) AS price_in_usd
  ,ROUND(price_in_usd * amount, 3) AS line_total
FROM with_rates
    );
  
[0m23:02:28.479682 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:fed05299-679d-4269-a1c9-08fa9878eba9&page=queryresults
[0m23:02:32.953113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1dbbb3-bc70-4e85-ab73-b06c5584dad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2dc419b10>]}
[0m23:02:32.954483 [info ] [Thread-1 (]: 10 of 18 OK created sql table model glamira_data_2025_core.fact_sales .......... [[32mCREATE TABLE (35.1k rows, 123.6 MiB processed)[0m in 5.94s]
[0m23:02:32.955509 [debug] [Thread-1 (]: Finished running node model.dbt_project.fact_sales
[0m23:02:32.957984 [debug] [Thread-1 (]: Began running node model.dbt_project.agg_orders_and_revenue_by_month
[0m23:02:32.959545 [info ] [Thread-1 (]: 11 of 18 START sql table model glamira_data_2025_mart.agg_orders_and_revenue_by_month  [RUN]
[0m23:02:32.961619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.fact_sales, now model.dbt_project.agg_orders_and_revenue_by_month)
[0m23:02:32.963291 [debug] [Thread-1 (]: Began compiling node model.dbt_project.agg_orders_and_revenue_by_month
[0m23:02:32.972143 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.agg_orders_and_revenue_by_month"
[0m23:02:32.973762 [debug] [Thread-1 (]: Began executing node model.dbt_project.agg_orders_and_revenue_by_month
[0m23:02:32.984310 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.agg_orders_and_revenue_by_month"
[0m23:02:32.985898 [debug] [Thread-1 (]: On model.dbt_project.agg_orders_and_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.agg_orders_and_revenue_by_month"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_mart`.`agg_orders_and_revenue_by_month`
      
    
    

    
    OPTIONS()
    as (
      

SELECT
    d.year_month
    ,COUNT(DISTINCT f.order_id) AS orders
    ,SUM(f.line_total) AS revenue
FROM `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`fact_sales` f
JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_date` d USING (date_id)
GROUP BY d.year_month
ORDER BY d.year_month
    );
  
[0m23:02:32.986794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:34.112350 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:351d2e34-cdfb-4d5b-a98f-a8e06ecef030&page=queryresults
[0m23:02:37.377696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1dbbb3-bc70-4e85-ab73-b06c5584dad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2e18aa680>]}
[0m23:02:37.379222 [info ] [Thread-1 (]: 11 of 18 OK created sql table model glamira_data_2025_mart.agg_orders_and_revenue_by_month  [[32mCREATE TABLE (3.0 rows, 821.5 KiB processed)[0m in 4.42s]
[0m23:02:37.381994 [debug] [Thread-1 (]: Finished running node model.dbt_project.agg_orders_and_revenue_by_month
[0m23:02:37.384175 [debug] [Thread-1 (]: Began running node model.dbt_project.agg_orders_by_day_region
[0m23:02:37.386118 [info ] [Thread-1 (]: 12 of 18 START sql table model glamira_data_2025_mart.agg_orders_by_day_region . [RUN]
[0m23:02:37.387751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.agg_orders_and_revenue_by_month, now model.dbt_project.agg_orders_by_day_region)
[0m23:02:37.388965 [debug] [Thread-1 (]: Began compiling node model.dbt_project.agg_orders_by_day_region
[0m23:02:37.394547 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.agg_orders_by_day_region"
[0m23:02:37.395917 [debug] [Thread-1 (]: Began executing node model.dbt_project.agg_orders_by_day_region
[0m23:02:37.409624 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.agg_orders_by_day_region"
[0m23:02:37.410835 [debug] [Thread-1 (]: On model.dbt_project.agg_orders_by_day_region: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.agg_orders_by_day_region"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_mart`.`agg_orders_by_day_region`
      
    
    

    
    OPTIONS()
    as (
      

SELECT
    d.full_date
    ,l.country_long_name
    ,l.region_name
    ,COUNT(DISTINCT f.order_id) AS orders
FROM `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`fact_sales` f
JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_date` d USING (date_id)
JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_location` l USING (location_id)
GROUP BY d.full_date, l.country_long_name, l.region_name
ORDER BY d.full_date, l.country_long_name, l.region_name
    );
  
[0m23:02:37.411557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:38.637179 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:bde14f66-6710-48da-967f-79f00521b1b5&page=queryresults
[0m23:02:41.700115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1dbbb3-bc70-4e85-ab73-b06c5584dad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2e18aa680>]}
[0m23:02:41.702105 [info ] [Thread-1 (]: 12 of 18 OK created sql table model glamira_data_2025_mart.agg_orders_by_day_region  [[32mCREATE TABLE (10.5k rows, 3.9 MiB processed)[0m in 4.31s]
[0m23:02:41.703753 [debug] [Thread-1 (]: Finished running node model.dbt_project.agg_orders_by_day_region
[0m23:02:41.704528 [debug] [Thread-1 (]: Began running node model.dbt_project.agg_orders_by_region
[0m23:02:41.705604 [info ] [Thread-1 (]: 13 of 18 START sql table model glamira_data_2025_mart.agg_orders_by_region ..... [RUN]
[0m23:02:41.706717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.agg_orders_by_day_region, now model.dbt_project.agg_orders_by_region)
[0m23:02:41.707554 [debug] [Thread-1 (]: Began compiling node model.dbt_project.agg_orders_by_region
[0m23:02:41.714253 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.agg_orders_by_region"
[0m23:02:41.715676 [debug] [Thread-1 (]: Began executing node model.dbt_project.agg_orders_by_region
[0m23:02:41.722437 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.agg_orders_by_region"
[0m23:02:41.723571 [debug] [Thread-1 (]: On model.dbt_project.agg_orders_by_region: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.agg_orders_by_region"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_mart`.`agg_orders_by_region`
      
    
    

    
    OPTIONS()
    as (
      

SELECT
    l.country_long_name
    ,l.region_name
    ,COUNT(DISTINCT f.order_id) AS orders
FROM `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`fact_sales` f
JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_location` l USING (location_id)
GROUP BY l.country_long_name, l.region_name
ORDER BY orders DESC
    );
  
[0m23:02:41.724421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:42.916138 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:f8bb4dbd-ccc3-4853-b706-458f75d464d8&page=queryresults
[0m23:02:46.076032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1dbbb3-bc70-4e85-ab73-b06c5584dad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2dc43bb20>]}
[0m23:02:46.078132 [info ] [Thread-1 (]: 13 of 18 OK created sql table model glamira_data_2025_mart.agg_orders_by_region  [[32mCREATE TABLE (715.0 rows, 3.6 MiB processed)[0m in 4.37s]
[0m23:02:46.079242 [debug] [Thread-1 (]: Finished running node model.dbt_project.agg_orders_by_region
[0m23:02:46.079964 [debug] [Thread-1 (]: Began running node model.dbt_project.agg_revenue_by_month
[0m23:02:46.081168 [info ] [Thread-1 (]: 14 of 18 START sql table model glamira_data_2025_mart.agg_revenue_by_month ..... [RUN]
[0m23:02:46.083109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.agg_orders_by_region, now model.dbt_project.agg_revenue_by_month)
[0m23:02:46.084240 [debug] [Thread-1 (]: Began compiling node model.dbt_project.agg_revenue_by_month
[0m23:02:46.091939 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.agg_revenue_by_month"
[0m23:02:46.093351 [debug] [Thread-1 (]: Began executing node model.dbt_project.agg_revenue_by_month
[0m23:02:46.098981 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.agg_revenue_by_month"
[0m23:02:46.100229 [debug] [Thread-1 (]: On model.dbt_project.agg_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.agg_revenue_by_month"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_mart`.`agg_revenue_by_month`
      
    
    

    
    OPTIONS()
    as (
      

SELECT
    d.year_month
    ,SUM(f.line_total) AS revenue
FROM `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`fact_sales` f
JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_date` d USING (date_id)
GROUP BY d.year_month
ORDER BY d.year_month
    );
  
[0m23:02:46.101195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:47.150218 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:f73cd09a-ca10-4ff5-b77a-d0ffb78b0767&page=queryresults
[0m23:02:49.701579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1dbbb3-bc70-4e85-ab73-b06c5584dad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2e18aa680>]}
[0m23:02:49.702721 [info ] [Thread-1 (]: 14 of 18 OK created sql table model glamira_data_2025_mart.agg_revenue_by_month  [[32mCREATE TABLE (3.0 rows, 547.6 KiB processed)[0m in 3.62s]
[0m23:02:49.704038 [debug] [Thread-1 (]: Finished running node model.dbt_project.agg_revenue_by_month
[0m23:02:49.705323 [debug] [Thread-1 (]: Began running node model.dbt_project.agg_revenue_by_region
[0m23:02:49.706778 [info ] [Thread-1 (]: 15 of 18 START sql table model glamira_data_2025_mart.agg_revenue_by_region .... [RUN]
[0m23:02:49.708264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.agg_revenue_by_month, now model.dbt_project.agg_revenue_by_region)
[0m23:02:49.709124 [debug] [Thread-1 (]: Began compiling node model.dbt_project.agg_revenue_by_region
[0m23:02:49.719217 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.agg_revenue_by_region"
[0m23:02:49.720590 [debug] [Thread-1 (]: Began executing node model.dbt_project.agg_revenue_by_region
[0m23:02:49.728257 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.agg_revenue_by_region"
[0m23:02:49.729638 [debug] [Thread-1 (]: On model.dbt_project.agg_revenue_by_region: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.agg_revenue_by_region"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_mart`.`agg_revenue_by_region`
      
    
    

    
    OPTIONS()
    as (
      

SELECT
    l.country_long_name
    ,l.region_name
    ,SUM(f.line_total) AS revenue
FROM `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`fact_sales` f
JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_location` l USING (location_id)
GROUP BY l.country_long_name, l.region_name
ORDER BY revenue DESC
    );
  
[0m23:02:49.731046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:50.886002 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:06540f62-340b-48d4-9e0b-318896f0dc3c&page=queryresults
[0m23:02:53.555271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1dbbb3-bc70-4e85-ab73-b06c5584dad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2e18aa680>]}
[0m23:02:53.557352 [info ] [Thread-1 (]: 15 of 18 OK created sql table model glamira_data_2025_mart.agg_revenue_by_region  [[32mCREATE TABLE (715.0 rows, 3.6 MiB processed)[0m in 3.85s]
[0m23:02:53.559361 [debug] [Thread-1 (]: Finished running node model.dbt_project.agg_revenue_by_region
[0m23:02:53.561108 [debug] [Thread-1 (]: Began running node model.dbt_project.agg_top_product_by_month
[0m23:02:53.563026 [info ] [Thread-1 (]: 16 of 18 START sql table model glamira_data_2025_mart.agg_top_product_by_month . [RUN]
[0m23:02:53.565436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.agg_revenue_by_region, now model.dbt_project.agg_top_product_by_month)
[0m23:02:53.566719 [debug] [Thread-1 (]: Began compiling node model.dbt_project.agg_top_product_by_month
[0m23:02:53.578197 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.agg_top_product_by_month"
[0m23:02:53.580650 [debug] [Thread-1 (]: Began executing node model.dbt_project.agg_top_product_by_month
[0m23:02:53.590472 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.agg_top_product_by_month"
[0m23:02:53.592278 [debug] [Thread-1 (]: On model.dbt_project.agg_top_product_by_month: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.agg_top_product_by_month"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_mart`.`agg_top_product_by_month`
      
    
    

    
    OPTIONS()
    as (
      

WITH ranked AS (
    SELECT
        d.year_month
        ,p.product_id
        ,p.product_name
        ,SUM(f.amount) AS total_qty
        ,RANK() OVER (PARTITION BY d.year_month ORDER BY SUM(f.amount) DESC) AS rnk
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`fact_sales` f
    JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_date` d USING (date_id)
    JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_product` p USING (product_id)
    GROUP BY d.year_month, p.product_id, p.product_name
)
SELECT 
    year_month
    ,product_id
    ,product_name
    ,total_qty
FROM ranked
WHERE rnk = 1
ORDER BY year_month
    );
  
[0m23:02:53.594424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:02:55.304631 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:d7da8aca-8c5d-438b-bf87-d2a727dcd48b&page=queryresults
[0m23:02:59.101602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1dbbb3-bc70-4e85-ab73-b06c5584dad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2dc4a3be0>]}
[0m23:02:59.105813 [info ] [Thread-1 (]: 16 of 18 OK created sql table model glamira_data_2025_mart.agg_top_product_by_month  [[32mCREATE TABLE (3.0 rows, 1.5 MiB processed)[0m in 5.54s]
[0m23:02:59.108915 [debug] [Thread-1 (]: Finished running node model.dbt_project.agg_top_product_by_month
[0m23:02:59.111672 [debug] [Thread-1 (]: Began running node model.dbt_project.agg_top_product_by_region
[0m23:02:59.114906 [info ] [Thread-1 (]: 17 of 18 START sql table model glamira_data_2025_mart.agg_top_product_by_region  [RUN]
[0m23:02:59.116686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.agg_top_product_by_month, now model.dbt_project.agg_top_product_by_region)
[0m23:02:59.119441 [debug] [Thread-1 (]: Began compiling node model.dbt_project.agg_top_product_by_region
[0m23:02:59.144010 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.agg_top_product_by_region"
[0m23:02:59.147058 [debug] [Thread-1 (]: Began executing node model.dbt_project.agg_top_product_by_region
[0m23:02:59.155425 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.agg_top_product_by_region"
[0m23:02:59.157549 [debug] [Thread-1 (]: On model.dbt_project.agg_top_product_by_region: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.agg_top_product_by_region"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_mart`.`agg_top_product_by_region`
      
    
    

    
    OPTIONS()
    as (
      

WITH ranked AS (
    SELECT
        l.country_long_name
        ,l.region_name
        ,p.product_id
        ,p.product_name
        ,SUM(f.amount) AS total_qty
        ,RANK() OVER (
            PARTITION BY l.country_long_name, l.region_name
            ORDER BY SUM(f.amount) DESC
        ) AS rnk
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`fact_sales` f
    JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_location` l USING (location_id)
    JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_product` p USING (product_id)
    GROUP BY l.country_long_name, l.region_name, p.product_id, p.product_name
)

SELECT 
    country_long_name
    ,region_name
    ,product_id
    ,product_name
    ,total_qty
FROM ranked
WHERE rnk = 1
ORDER BY country_long_name, region_name
    );
  
[0m23:02:59.158952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:03:00.357558 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:a4a3b1ae-c5e7-4e9c-b33b-9f939821d074&page=queryresults
[0m23:03:07.093569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1dbbb3-bc70-4e85-ab73-b06c5584dad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2dc4a3be0>]}
[0m23:03:07.094958 [info ] [Thread-1 (]: 17 of 18 OK created sql table model glamira_data_2025_mart.agg_top_product_by_region  [[32mCREATE TABLE (2.1k rows, 4.6 MiB processed)[0m in 7.98s]
[0m23:03:07.096119 [debug] [Thread-1 (]: Finished running node model.dbt_project.agg_top_product_by_region
[0m23:03:07.096899 [debug] [Thread-1 (]: Began running node model.dbt_project.agg_top_product_overall
[0m23:03:07.097837 [info ] [Thread-1 (]: 18 of 18 START sql table model glamira_data_2025_mart.agg_top_product_overall .. [RUN]
[0m23:03:07.098704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.agg_top_product_by_region, now model.dbt_project.agg_top_product_overall)
[0m23:03:07.099334 [debug] [Thread-1 (]: Began compiling node model.dbt_project.agg_top_product_overall
[0m23:03:07.106925 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.agg_top_product_overall"
[0m23:03:07.107924 [debug] [Thread-1 (]: Began executing node model.dbt_project.agg_top_product_overall
[0m23:03:07.112132 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.agg_top_product_overall"
[0m23:03:07.113226 [debug] [Thread-1 (]: On model.dbt_project.agg_top_product_overall: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.agg_top_product_overall"} */

  
    

    create or replace table `symmetric-fin-469415-q9`.`glamira_data_2025_mart`.`agg_top_product_overall`
      
    
    

    
    OPTIONS()
    as (
      

WITH ranked AS (
    SELECT
        p.product_id
        ,p.product_name
        ,SUM(f.amount) AS total_qty
        ,RANK() OVER (ORDER BY SUM(f.amount) DESC) AS rnk
    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`fact_sales` f
    JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_product` p USING (product_id)
    GROUP BY p.product_id, p.product_name
)
SELECT
    product_id
    ,product_name
    ,total_qty
FROM ranked
WHERE rnk = 1
    );
  
[0m23:03:07.114542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:03:08.256185 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=symmetric-fin-469415-q9&j=bq:US:5eb4063a-40f5-4a69-a9cc-06662dc22a6d&page=queryresults
[0m23:03:12.369232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1dbbb3-bc70-4e85-ab73-b06c5584dad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2dc4a3be0>]}
[0m23:03:12.370512 [info ] [Thread-1 (]: 18 of 18 OK created sql table model glamira_data_2025_mart.agg_top_product_overall  [[32mCREATE TABLE (1.0 rows, 1.2 MiB processed)[0m in 5.27s]
[0m23:03:12.371917 [debug] [Thread-1 (]: Finished running node model.dbt_project.agg_top_product_overall
[0m23:03:12.373492 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:03:12.375730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:03:12.376403 [debug] [MainThread]: Connection 'model.dbt_project.agg_top_product_overall' was properly closed.
[0m23:03:12.377537 [info ] [MainThread]: 
[0m23:03:12.378876 [info ] [MainThread]: Finished running 18 table models in 0 hours 1 minutes and 36.86 seconds (96.86s).
[0m23:03:12.387599 [debug] [MainThread]: Command end result
[0m23:03:12.670615 [debug] [MainThread]: Wrote artifact WritableManifest to /home/dunhan/dbt_project/target/manifest.json
[0m23:03:12.674169 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/dunhan/dbt_project/target/semantic_manifest.json
[0m23:03:12.684896 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/dunhan/dbt_project/target/run_results.json
[0m23:03:12.685866 [info ] [MainThread]: 
[0m23:03:12.686517 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:03:12.687143 [info ] [MainThread]: 
[0m23:03:12.687794 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=18
[0m23:03:12.690474 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 102.7999, "process_in_blocks": "320672", "process_kernel_time": 0.759542, "process_mem_max_rss": "358108", "process_out_blocks": "3528", "process_user_time": 12.276943}
[0m23:03:12.692043 [debug] [MainThread]: Command `dbt run` succeeded at 23:03:12.691719 after 102.80 seconds
[0m23:03:12.693315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2feec54b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2fed468c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2de419e70>]}
[0m23:03:12.694570 [debug] [MainThread]: Flushing usage events
[0m23:03:14.896693 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:57:07.597181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea0c85a95a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea0c7550700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea0c75506a0>]}


============================== 20:57:07.603646 | a711ed17-9a50-431a-95b5-e31ad03f7f62 ==============================
[0m20:57:07.603646 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:57:07.604830 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'static_parser': 'True', 'quiet': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'log_path': '/home/dunhan/dbt_project/logs', 'empty': 'None', 'fail_fast': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'profiles_dir': '/home/dunhan/.dbt', 'version_check': 'True'}
[0m20:57:07.868456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a711ed17-9a50-431a-95b5-e31ad03f7f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea0c741e170>]}
[0m20:57:07.919334 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:57:07.921431 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:57:07.924826 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4719986, "process_in_blocks": "656", "process_kernel_time": 0.21637, "process_mem_max_rss": "96400", "process_out_blocks": "8", "process_user_time": 3.347266}
[0m20:57:07.926486 [debug] [MainThread]: Command `cli deps` succeeded at 20:57:07.926139 after 0.47 seconds
[0m20:57:07.927477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea0c85a95a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea0c741e170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea0c741e020>]}
[0m20:57:07.928796 [debug] [MainThread]: Flushing usage events
[0m20:57:09.538627 [debug] [MainThread]: An error was encountered while trying to flush usage events
