{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.11", "generated_at": "2025-09-29T08:22:13.202761Z", "invocation_id": "19330d41-a223-4f84-9d50-4842b3b28e9a", "invocation_started_at": "2025-09-29T08:20:48.458854Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-29T08:20:57.960455Z", "completed_at": "2025-09-29T08:20:57.975764Z"}, {"name": "execute", "started_at": "2025-09-29T08:20:57.977244Z", "completed_at": "2025-09-29T08:21:02.327880Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.370584011077881, "adapter_response": {"_message": "CREATE TABLE (26.1k rows, 8.8 GiB processed)", "code": "CREATE TABLE", "rows_affected": 26079, "bytes_processed": 9484937846, "bytes_billed": 9485418496, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "861c76d0-e237-4870-a385-b3b6dff9a18f", "slot_ms": 54721}, "message": "CREATE TABLE (26.1k rows, 8.8 GiB processed)", "failures": null, "unique_id": "model.dbt_project.stag_customer", "compiled": true, "compiled_code": "\n\nWITH src AS (\n\tSELECT *\n\tFROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`\n)\n\n,checkout_success AS (\n\tSELECT\n\t\t_id \t\t\tAS customer_id\n\t\t,device_id \t\tAS device_id\n\t\t,email_address \tAS email_address\n\t\t,resolution \tAS resolution\n\t\t,user_id_db \tAS user_id_db\n\t\t,user_agent \tAS user_agent\n\tFROM src\n\tWHERE collection = 'checkout_success'\n)\n\nSELECT * FROM checkout_success", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-29T08:21:02.340605Z", "completed_at": "2025-09-29T08:21:02.346381Z"}, {"name": "execute", "started_at": "2025-09-29T08:21:02.347106Z", "completed_at": "2025-09-29T08:21:08.164842Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.828359603881836, "adapter_response": {"_message": "CREATE TABLE (3.2m rows, 267.9 MiB processed)", "code": "CREATE TABLE", "rows_affected": 3238153, "bytes_processed": 280955629, "bytes_billed": 281018368, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "56e4f12c-a725-49f9-a79f-9d4bfa8489d1", "slot_ms": 61451}, "message": "CREATE TABLE (3.2m rows, 267.9 MiB processed)", "failures": null, "unique_id": "model.dbt_project.stag_location", "compiled": true, "compiled_code": "\n\nWITH src AS (\n    SELECT *\n    FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`location`\n)\n\n,casted AS (\n    SELECT\n        CAST(\n        FARM_FINGERPRINT(\n            CONCAT(\n            COALESCE(src.city, ''), \n            COALESCE(src.country_short, ''), \n            COALESCE(src.region, '')\n            )\n        ) AS STRING\n        ) AS location_id\n\n        ,src.ip                 AS ip_address\n        ,src.city               AS city_name\n        ,src.country_short      AS country_short_name\n        ,src.country_long       AS country_long_name\n\n        ,ROUND(SAFE_CAST(src.latitude AS NUMERIC), 6)   AS latitude\n        ,ROUND(SAFE_CAST(src.longitude AS NUMERIC), 6)  AS longitude\n\n        ,src.region             AS region_name\n        ,src.time_zone          AS time_zone\n    FROM src\n    WHERE REGEXP_CONTAINS(\n        src.ip,\n        r'^(25[0-5]|2[0-4]\\d|[01]?\\d?\\d)(\\.(25[0-5]|2[0-4]\\d|[01]?\\d?\\d)){3}$'\n    )\n)\n\nSELECT * FROM casted", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-29T08:21:08.175408Z", "completed_at": "2025-09-29T08:21:08.181202Z"}, {"name": "execute", "started_at": "2025-09-29T08:21:08.182125Z", "completed_at": "2025-09-29T08:21:12.448775Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.2776830196380615, "adapter_response": {"_message": "CREATE TABLE (35.1k rows, 3.7 GiB processed)", "code": "CREATE TABLE", "rows_affected": 35062, "bytes_processed": 3947010899, "bytes_billed": 3947888640, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "e7d9f5b2-aa6d-4a2d-96df-ac621f1f4197", "slot_ms": 51186}, "message": "CREATE TABLE (35.1k rows, 3.7 GiB processed)", "failures": null, "unique_id": "model.dbt_project.stag_sales", "compiled": true, "compiled_code": "\n\nWITH src AS (\n\tSELECT *\n \tFROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`\n)\n\n,flattened AS (\n\tSELECT\n\t\tGENERATE_UUID() \t\t\t\tAS sales_id\n\t\t,CAST(src.order_id AS INT64) \tAS order_id\n\t\t,src._id \t\t\t\t\t\tAS customer_id\n\t\t\n\t\t,src.time_stamp \t\t\t\tAS date_id\n\t\t,src.time_stamp \t\t\t\tAS time_stamp\n\t\t,src.local_time \t\t\t\tAS local_time\n\n\t\t,src.ip \t\t\t\t\t\tAS ip_address\n\n\t\t,CAST(src.store_id AS INT64) \tAS store_id\n\t\t\n\t\t,cp.product_id \t\t\t\t\tAS product_id\n\t\t,cp.amount \t\t\t\t\t\tAS amount\n\t\t,cp.currency \t\t\t\t\tAS currency_code\n\t\t,cp.price \t\t\t\t\t\tAS price\n  \tFROM src\n  \t,UNNEST(src.cart_products) AS cp\n  \tWHERE collection = 'checkout_success' \n\tAND REGEXP_CONTAINS(\n        src.ip,\n        r'^(25[0-5]|2[0-4]\\d|[01]?\\d?\\d)(\\.(25[0-5]|2[0-4]\\d|[01]?\\d?\\d)){3}$'\n    )\n)\n\nSELECT * FROM flattened", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-29T08:21:12.460159Z", "completed_at": "2025-09-29T08:21:12.467842Z"}, {"name": "execute", "started_at": "2025-09-29T08:21:12.468648Z", "completed_at": "2025-09-29T08:21:16.125593Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.6714773178100586, "adapter_response": {"_message": "CREATE TABLE (26.1k rows, 4.4 MiB processed)", "code": "CREATE TABLE", "rows_affected": 26079, "bytes_processed": 4625154, "bytes_billed": 10485760, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "50e4f88e-588d-4dbf-a5bf-1d97a162adae", "slot_ms": 5951}, "message": "CREATE TABLE (26.1k rows, 4.4 MiB processed)", "failures": null, "unique_id": "model.dbt_project.dim_customer", "compiled": true, "compiled_code": "\n\nWITH src AS (\n    SELECT *\n    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`\n)\n\n,customer AS (\n    SELECT\n        customer_id\n        ,email_address\n        ,resolution\n        ,user_agent\n    FROM src \n)\n\nSELECT * FROM customer", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_customer`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-29T08:21:16.144221Z", "completed_at": "2025-09-29T08:21:16.155283Z"}, {"name": "execute", "started_at": "2025-09-29T08:21:16.156307Z", "completed_at": "2025-09-29T08:21:20.966977Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.828058958053589, "adapter_response": {"_message": "CREATE TABLE (47.3k rows, 317.8 MiB processed)", "code": "CREATE TABLE", "rows_affected": 47252, "bytes_processed": 333260342, "bytes_billed": 333447168, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "45132726-1fad-4226-ab1e-76f0163cd03d", "slot_ms": 11274}, "message": "CREATE TABLE (47.3k rows, 317.8 MiB processed)", "failures": null, "unique_id": "model.dbt_project.dim_location", "compiled": true, "compiled_code": "\n\nWITH src AS (\n    SELECT *\n    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`\n)\n\n,location_data AS (\n    SELECT\n        location_id,\n        ANY_VALUE(city_name)            AS city_name,\n        ANY_VALUE(country_short_name)   AS country_short_name,\n        ANY_VALUE(country_long_name)    AS country_long_name,\n        AVG(latitude)                   AS latitude,         \n        AVG(longitude)                  AS longitude,\n        ANY_VALUE(region_name)          AS region_name,\n        ANY_VALUE(time_zone)            AS time_zone\n    FROM src\n    GROUP BY location_id\n)\n\nSELECT * FROM location_data", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_location`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-29T08:21:20.976342Z", "completed_at": "2025-09-29T08:21:20.982007Z"}, {"name": "execute", "started_at": "2025-09-29T08:21:20.983285Z", "completed_at": "2025-09-29T08:21:24.762682Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.789785623550415, "adapter_response": {"_message": "CREATE TABLE (65.0 rows, 273.9 KiB processed)", "code": "CREATE TABLE", "rows_affected": 65, "bytes_processed": 280496, "bytes_billed": 10485760, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "329575d5-9008-41e1-a89e-8a65fd9233ec", "slot_ms": 448}, "message": "CREATE TABLE (65.0 rows, 273.9 KiB processed)", "failures": null, "unique_id": "model.dbt_project.dim_date", "compiled": true, "compiled_code": "\n\nWITH src AS (\n    SELECT *\n    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`\n)\n\n,date_ AS (\n    SELECT DISTINCT\n        CAST(FORMAT_DATE('%Y%m%d', DATE(TIMESTAMP_SECONDS(src.time_stamp))) AS INT64) AS date_id\n        ,DATE(TIMESTAMP_SECONDS(src.time_stamp)) AS full_date\n    FROM src\n)\n\nSELECT\n    date_id\n    ,full_date\n    ,FORMAT_DATE('%A', full_date) AS day_of_week\n\n    ,CASE \n        WHEN EXTRACT(DAYOFWEEK FROM full_date) IN (1,7) \n            THEN TRUE \n        ELSE \n            FALSE \n    END AS is_weekend\n    \n    ,EXTRACT(DAY FROM full_date)        AS day_of_month\n    ,FORMAT_DATE('%Y-%m', full_date)    AS year_month\n    ,EXTRACT(MONTH FROM full_date)      AS month\n    ,EXTRACT(ISOWEEK FROM full_date)    AS week_of_year\n    ,CONCAT('Q', CAST(EXTRACT(QUARTER FROM full_date) AS STRING)) AS quarter_number\n    ,CAST(EXTRACT(YEAR FROM full_date) AS STRING) AS year\n    ,EXTRACT(YEAR FROM full_date) AS year_number\nFROM date_\nORDER BY full_date", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_date`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-29T08:21:24.773479Z", "completed_at": "2025-09-29T08:21:24.781963Z"}, {"name": "execute", "started_at": "2025-09-29T08:21:24.783235Z", "completed_at": "2025-09-29T08:21:28.440034Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.670900821685791, "adapter_response": {"_message": "CREATE TABLE (65.0 rows, 273.9 KiB processed)", "code": "CREATE TABLE", "rows_affected": 65, "bytes_processed": 280496, "bytes_billed": 10485760, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "39b5b1d6-b05b-4ca7-8eb6-7703f4ec623e", "slot_ms": 5123}, "message": "CREATE TABLE (65.0 rows, 273.9 KiB processed)", "failures": null, "unique_id": "model.dbt_project.dim_store", "compiled": true, "compiled_code": "\n\nWITH src AS (\n    SELECT *\n    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`\n)\n\n,store AS (\n    SELECT\n        DISTINCT store_id\n        ,CONCAT(\"Store \", CAST(store_id AS STRING)) AS store_name\n    FROM src\n)\n\nSELECT * FROM store", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_store`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-29T08:21:28.449172Z", "completed_at": "2025-09-29T08:21:28.457010Z"}, {"name": "execute", "started_at": "2025-09-29T08:21:28.457743Z", "completed_at": "2025-09-29T08:21:34.061856Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.616034269332886, "adapter_response": {"_message": "CREATE TABLE (35.1k rows, 117.6 MiB processed)", "code": "CREATE TABLE", "rows_affected": 35062, "bytes_processed": 123273096, "bytes_billed": 123731968, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "1b744a5d-eead-41c2-a248-6695a6a3d2f2", "slot_ms": 27172}, "message": "CREATE TABLE (35.1k rows, 117.6 MiB processed)", "failures": null, "unique_id": "model.dbt_project.fact_sales", "compiled": true, "compiled_code": "\n\nWITH src AS (\n\tSELECT *\n\tFROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`\n)\n\n,sales AS (\n\tSELECT \n\t\tsrc.sales_id\n\t\t,src.order_id\n\t\t,src.customer_id\n\n\t\t,CAST(FORMAT_DATE('%Y%m%d', DATE(TIMESTAMP_SECONDS(src.time_stamp))) AS INT64) AS date_id\n\t\t,DATE(TIMESTAMP_SECONDS(src.time_stamp)) AS time_stamp\n\t\t,src.local_time\n\t\t\n\t\t,l.location_id\n\t\t,src.ip_address\n\n\t\t,src.store_id\n\t\t,src.product_id\n\t\t,src.amount\n\n\t\t,CASE\n\t\tWHEN src.currency_code IS NULL OR TRIM(src.currency_code) = \"\" \n\t\t\tTHEN \"USD $\"\n\t\tWHEN TRIM(src.currency_code) = \" din.\" \n\t\t\tTHEN \"din.\"\n\t\tWHEN TRIM(src.currency_code) = \"\u062f.\u0643.\u200f\" \n\t\t\tTHEN \"\u062f.\u0643.\"\n\t\tELSE \n\t\t\tTRIM(src.currency_code)\n\t\tEND AS currency_code\n\t\t\n\t\t,CASE\n\t\tWHEN src.price LIKE '%,%' AND src.price LIKE '%.%' \n\t\t\tTHEN SAFE_CAST(REPLACE(REPLACE(src.price, '.', ''), ',', '.') AS FLOAT64)\n\t\tWHEN src.price LIKE '%,%' \n\t\t\tTHEN SAFE_CAST(REPLACE(src.price, ',', '.') AS FLOAT64)\n\t\tELSE\n\t\t\tSAFE_CAST(src.price AS FLOAT64)\n\t\tEND AS price\n\tFROM src\n\tLEFT JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location` l\n\t\tON src.ip_address = l.ip_address\n),\n\nwith_rates AS (\n\tSELECT\n\t\ts.*\n\t\t,COALESCE(c.exchange_rate, 1.0) AS exchange_rate\n\t\t,s.price * COALESCE(c.exchange_rate, 1.0) AS price_in_usd\n\tFROM sales s\n\tLEFT JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_currency` c\n\t\tON s.currency_code = c.code OR s.currency_code = c.symbol\n)\n\nSELECT\n\tsales_id\n\t,order_id\n\t,customer_id\n\t,date_id\n\t,time_stamp\n\t,local_time\n\t,location_id\n\t,ip_address\n\t,store_id\n\t,product_id\n\t,amount\n\t,currency_code\n\t,ROUND(price_in_usd, 3) \t\t\tAS price_in_usd\n\t,ROUND(price_in_usd * amount, 3) \tAS line_total\nFROM with_rates", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_core`.`fact_sales`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-29T08:21:34.072667Z", "completed_at": "2025-09-29T08:21:34.080931Z"}, {"name": "execute", "started_at": "2025-09-29T08:21:34.082488Z", "completed_at": "2025-09-29T08:21:37.699376Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.630795955657959, "adapter_response": {"_message": "CREATE TABLE (19.1k rows, 2.0 MiB processed)", "code": "CREATE TABLE", "rows_affected": 19064, "bytes_processed": 2133223, "bytes_billed": 20971520, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "f36ad903-8b69-4ee5-ae14-3a10207807a4", "slot_ms": 5180}, "message": "CREATE TABLE (19.1k rows, 2.0 MiB processed)", "failures": null, "unique_id": "model.dbt_project.stag_product", "compiled": true, "compiled_code": "\n\nWITH src AS (\n\tSELECT *\n\tFROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`product_name`\n)\n\n,casted AS (\n\tSELECT\n\t\tsrc.product_id \t\t\tAS product_id\n\t\t,src.name \t\t\t\tAS product_name\n\t\t,src.sku \t\t\t\tAS sku\n\t\t,src.gender \t\t\tAS gender\n\t\t,src.max_price_format \tAS max_price_format\n\t\t,src.min_price_format \tAS min_price_format\n\t\t,src.type_id \t\t\tAS type_id\n\t\t,src.store_code \t\tAS store_code\n\tFROM src\n)\n\n,missing_from_sales AS (\n    -- find product_ids used in sales but missing in product_name\n    SELECT DISTINCT\n        s.product_id\n\t\t,'Unknown Product' \tAS product_name\n\t\t,'Unknown'         \tAS sku\n\t\t,'Unknown'         \tAS gender\n\t\t,'Unknown'         \tAS max_price_format\n\t\t,'Unknown'         \tAS min_price_format\n\t\t,'Unknown'         \tAS type_id\n\t\t,'Unknown'         \tAS store_code\n    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales` s\n    LEFT JOIN casted p\n      \tON s.product_id = p.product_id\n    WHERE s.product_id IS NOT NULL\n      \tAND p.product_id IS NULL\n)\n\nSELECT * FROM casted\nUNION ALL\nSELECT * FROM missing_from_sales", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-29T08:21:37.708954Z", "completed_at": "2025-09-29T08:21:37.717896Z"}, {"name": "execute", "started_at": "2025-09-29T08:21:37.719284Z", "completed_at": "2025-09-29T08:21:41.613444Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.9082255363464355, "adapter_response": {"_message": "CREATE TABLE (3.0 rows, 821.5 KiB processed)", "code": "CREATE TABLE", "rows_affected": 3, "bytes_processed": 841185, "bytes_billed": 20971520, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "39d6c57f-eb52-4ec2-9e31-69697f73dadf", "slot_ms": 758}, "message": "CREATE TABLE (3.0 rows, 821.5 KiB processed)", "failures": null, "unique_id": "model.dbt_project.agg_orders_and_revenue_by_month", "compiled": true, "compiled_code": "\n\nSELECT\n    d.year_month\n    ,COUNT(DISTINCT f.order_id) AS orders\n    ,SUM(f.line_total) AS revenue\nFROM `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`fact_sales` f\nJOIN `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_date` d USING (date_id)\nGROUP BY d.year_month\nORDER BY d.year_month", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_mart`.`agg_orders_and_revenue_by_month`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-29T08:21:41.622110Z", "completed_at": "2025-09-29T08:21:41.629756Z"}, {"name": "execute", "started_at": "2025-09-29T08:21:41.630940Z", "completed_at": "2025-09-29T08:21:45.309674Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.690854787826538, "adapter_response": {"_message": "CREATE TABLE (10.5k rows, 3.5 MiB processed)", "code": "CREATE TABLE", "rows_affected": 10494, "bytes_processed": 3657819, "bytes_billed": 31457280, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "b4b4b802-d1df-4e5c-a1a5-ec6547265a40", "slot_ms": 691}, "message": "CREATE TABLE (10.5k rows, 3.5 MiB processed)", "failures": null, "unique_id": "model.dbt_project.agg_orders_by_day_region", "compiled": true, "compiled_code": "\n\nSELECT\n    d.full_date\n    ,l.country_long_name\n    ,l.region_name\n    ,COUNT(DISTINCT f.order_id) AS orders\nFROM `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`fact_sales` f\nJOIN `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_date` d USING (date_id)\nJOIN `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_location` l USING (location_id)\nGROUP BY d.full_date, l.country_long_name, l.region_name\nORDER BY d.full_date, l.country_long_name, l.region_name", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_mart`.`agg_orders_by_day_region`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-29T08:21:45.318659Z", "completed_at": "2025-09-29T08:21:45.325390Z"}, {"name": "execute", "started_at": "2025-09-29T08:21:45.326293Z", "completed_at": "2025-09-29T08:21:48.893526Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.5781407356262207, "adapter_response": {"_message": "CREATE TABLE (714.0 rows, 3.2 MiB processed)", "code": "CREATE TABLE", "rows_affected": 714, "bytes_processed": 3376283, "bytes_billed": 20971520, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "04470eb7-73b8-4efe-9679-ba3b9815ae1c", "slot_ms": 543}, "message": "CREATE TABLE (714.0 rows, 3.2 MiB processed)", "failures": null, "unique_id": "model.dbt_project.agg_orders_by_region", "compiled": true, "compiled_code": "\n\nSELECT\n    l.country_long_name\n    ,l.region_name\n    ,COUNT(DISTINCT f.order_id) AS orders\nFROM `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`fact_sales` f\nJOIN `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_location` l USING (location_id)\nGROUP BY l.country_long_name, l.region_name\nORDER BY orders DESC", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_mart`.`agg_orders_by_region`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-29T08:21:48.903256Z", "completed_at": "2025-09-29T08:21:48.910589Z"}, {"name": "execute", "started_at": "2025-09-29T08:21:48.911499Z", "completed_at": "2025-09-29T08:21:52.505956Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.607273578643799, "adapter_response": {"_message": "CREATE TABLE (3.0 rows, 547.5 KiB processed)", "code": "CREATE TABLE", "rows_affected": 3, "bytes_processed": 560689, "bytes_billed": 20971520, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "ebb87c2c-f47c-4748-a007-1770dc0d6449", "slot_ms": 368}, "message": "CREATE TABLE (3.0 rows, 547.5 KiB processed)", "failures": null, "unique_id": "model.dbt_project.agg_revenue_by_month", "compiled": true, "compiled_code": "\n\nSELECT\n    d.year_month\n    ,SUM(f.line_total) AS revenue\nFROM `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`fact_sales` f\nJOIN `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_date` d USING (date_id)\nGROUP BY d.year_month\nORDER BY d.year_month", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_mart`.`agg_revenue_by_month`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-29T08:21:52.516956Z", "completed_at": "2025-09-29T08:21:52.522376Z"}, {"name": "execute", "started_at": "2025-09-29T08:21:52.523159Z", "completed_at": "2025-09-29T08:21:56.369093Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.85623836517334, "adapter_response": {"_message": "CREATE TABLE (714.0 rows, 3.2 MiB processed)", "code": "CREATE TABLE", "rows_affected": 714, "bytes_processed": 3374875, "bytes_billed": 20971520, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "1756dc64-04a1-4137-bde1-7c2aaa22cd46", "slot_ms": 647}, "message": "CREATE TABLE (714.0 rows, 3.2 MiB processed)", "failures": null, "unique_id": "model.dbt_project.agg_revenue_by_region", "compiled": true, "compiled_code": "\n\nSELECT\n    l.country_long_name\n    ,l.region_name\n    ,SUM(f.line_total) AS revenue\nFROM `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`fact_sales` f\nJOIN `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_location` l USING (location_id)\nGROUP BY l.country_long_name, l.region_name\nORDER BY revenue DESC", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_mart`.`agg_revenue_by_region`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-29T08:21:56.379089Z", "completed_at": "2025-09-29T08:21:56.384125Z"}, {"name": "execute", "started_at": "2025-09-29T08:21:56.384812Z", "completed_at": "2025-09-29T08:22:00.008899Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.633357286453247, "adapter_response": {"_message": "CREATE TABLE (19.1k rows, 1.8 MiB processed)", "code": "CREATE TABLE", "rows_affected": 19064, "bytes_processed": 1871845, "bytes_billed": 10485760, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "6fcc838a-a8d2-4a9c-bce3-71fabf3b6fa0", "slot_ms": 5500}, "message": "CREATE TABLE (19.1k rows, 1.8 MiB processed)", "failures": null, "unique_id": "model.dbt_project.dim_product", "compiled": true, "compiled_code": "\n\nWITH src AS (\n\tSELECT *\n\tFROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`\n)\n\n,product AS (\n\tSELECT\n\t\tproduct_id\n\t\t,product_name\n\t\t,sku\n\t\t,gender\n\t\t,max_price_format AS max_price\n\t\t,min_price_format AS min_price\n\t\t,type_id\n\t\t,store_code\n\tFROM src\n)\n\nSELECT * FROM product", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-29T08:22:00.019828Z", "completed_at": "2025-09-29T08:22:00.030640Z"}, {"name": "execute", "started_at": "2025-09-29T08:22:00.031748Z", "completed_at": "2025-09-29T08:22:04.421726Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.40622615814209, "adapter_response": {"_message": "CREATE TABLE (3.0 rows, 1.5 MiB processed)", "code": "CREATE TABLE", "rows_affected": 3, "bytes_processed": 1570383, "bytes_billed": 31457280, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "3a3c4be9-d870-4ce0-a5f9-7b934c51ff45", "slot_ms": 17939}, "message": "CREATE TABLE (3.0 rows, 1.5 MiB processed)", "failures": null, "unique_id": "model.dbt_project.agg_top_product_by_month", "compiled": true, "compiled_code": "\n\nWITH ranked AS (\n    SELECT\n        d.year_month\n        ,p.product_id\n        ,p.product_name\n        ,SUM(f.amount) AS total_qty\n        ,RANK() OVER (PARTITION BY d.year_month ORDER BY SUM(f.amount) DESC) AS rnk\n    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`fact_sales` f\n    JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_date` d USING (date_id)\n    JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_product` p USING (product_id)\n    GROUP BY d.year_month, p.product_id, p.product_name\n)\nSELECT \n    year_month\n    ,product_id\n    ,product_name\n    ,total_qty\nFROM ranked\nWHERE rnk = 1\nORDER BY year_month", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_mart`.`agg_top_product_by_month`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-29T08:22:04.432866Z", "completed_at": "2025-09-29T08:22:04.440565Z"}, {"name": "execute", "started_at": "2025-09-29T08:22:04.441958Z", "completed_at": "2025-09-29T08:22:08.934839Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.5054848194122314, "adapter_response": {"_message": "CREATE TABLE (2.6k rows, 4.2 MiB processed)", "code": "CREATE TABLE", "rows_affected": 2598, "bytes_processed": 4384569, "bytes_billed": 31457280, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "3b9d9ea2-2a20-4eac-a75f-93275b28c60d", "slot_ms": 19173}, "message": "CREATE TABLE (2.6k rows, 4.2 MiB processed)", "failures": null, "unique_id": "model.dbt_project.agg_top_product_by_region", "compiled": true, "compiled_code": "\n\nWITH ranked AS (\n    SELECT\n        l.country_long_name\n        ,l.region_name\n        ,p.product_id\n        ,p.product_name\n        ,SUM(f.amount) AS total_qty\n        ,RANK() OVER (\n            PARTITION BY l.country_long_name, l.region_name\n            ORDER BY SUM(f.amount) DESC\n        ) AS rnk\n    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`fact_sales` f\n    JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_location` l USING (location_id)\n    JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_product` p USING (product_id)\n    GROUP BY l.country_long_name, l.region_name, p.product_id, p.product_name\n)\n\nSELECT \n    country_long_name\n    ,region_name\n    ,product_id\n    ,product_name\n    ,total_qty\nFROM ranked\nWHERE rnk = 1\nORDER BY country_long_name, region_name", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_mart`.`agg_top_product_by_region`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-29T08:22:08.944518Z", "completed_at": "2025-09-29T08:22:08.953272Z"}, {"name": "execute", "started_at": "2025-09-29T08:22:08.955394Z", "completed_at": "2025-09-29T08:22:13.181136Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.2418458461761475, "adapter_response": {"_message": "CREATE TABLE (1.0 rows, 1.2 MiB processed)", "code": "CREATE TABLE", "rows_affected": 1, "bytes_processed": 1288782, "bytes_billed": 20971520, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "0432a9df-93af-4e9e-be15-921c6e76e4a0", "slot_ms": 34058}, "message": "CREATE TABLE (1.0 rows, 1.2 MiB processed)", "failures": null, "unique_id": "model.dbt_project.agg_top_product_overall", "compiled": true, "compiled_code": "\n\nWITH ranked AS (\n    SELECT\n        p.product_id\n        ,p.product_name\n        ,SUM(f.amount) AS total_qty\n        ,RANK() OVER (ORDER BY SUM(f.amount) DESC) AS rnk\n    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`fact_sales` f\n    JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_core`.`dim_product` p USING (product_id)\n    GROUP BY p.product_id, p.product_name\n)\nSELECT\n    product_id\n    ,product_name\n    ,total_qty\nFROM ranked\nWHERE rnk = 1", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_mart`.`agg_top_product_overall`", "batch_results": null}], "elapsed_time": 79.89183044433594, "args": {"require_nested_cumulative_type_params": false, "send_anonymous_usage_stats": true, "require_batched_execution_for_custom_microbatch_strategy": false, "state_modified_compare_vars": false, "use_fast_test_edges": false, "log_file_max_bytes": 10485760, "favor_state": false, "project_dir": "/home/dunhan/dbt_project", "log_format_file": "debug", "show_resource_report": false, "which": "run", "state_modified_compare_more_unrendered_values": false, "exclude": [], "strict_mode": false, "profiles_dir": "/home/dunhan/.dbt", "log_level_file": "debug", "upload_to_artifacts_ingest_api": false, "require_all_warnings_handled_by_warn_error": false, "select": [], "use_colors_file": true, "printer_width": 80, "populate_cache": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "log_format": "default", "partial_parse": true, "require_resource_names_without_spaces": true, "defer": false, "log_path": "/home/dunhan/dbt_project/logs", "macro_debugging": false, "version_check": true, "require_generic_test_arguments_property": true, "empty": false, "indirect_selection": "eager", "print": true, "vars": {}, "validate_macro_args": false, "show_all_deprecations": false, "introspect": true, "require_yaml_configuration_for_mf_time_spines": false, "static_parser": true, "use_colors": true, "cache_selected_only": false, "source_freshness_run_project_hooks": true, "quiet": false, "skip_nodes_if_on_run_start_fails": false, "require_explicit_package_overrides_for_builtin_materializations": true, "write_json": true, "log_level": "info", "invocation_command": "dbt run", "partial_parse_file_diff": true}}