{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.11", "generated_at": "2025-09-21T13:53:29.771034Z", "invocation_id": "49669c43-b6f3-4ed1-b780-3c8212792d40", "invocation_started_at": "2025-09-21T13:52:34.438828Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-21T13:52:43.003503Z", "completed_at": "2025-09-21T13:52:43.024586Z"}, {"name": "execute", "started_at": "2025-09-21T13:52:43.026277Z", "completed_at": "2025-09-21T13:52:49.529569Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.5299293994903564, "adapter_response": {"_message": "CREATE TABLE (26.1k rows, 8.8 GiB processed)", "code": "CREATE TABLE", "rows_affected": 26079, "bytes_processed": 9484937846, "bytes_billed": 9485418496, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "c8cd9e7d-f842-41e8-b447-ac45c7926ff3", "slot_ms": 48266}, "message": "CREATE TABLE (26.1k rows, 8.8 GiB processed)", "failures": null, "unique_id": "model.dbt_project.stag_customer", "compiled": true, "compiled_code": "\n\nWITH src AS (\n  SELECT *\n  FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`\n),\n\n\ncheckout_success AS (\n  SELECT\n    _id AS customer_id,\n    device_id AS device_id,\n    email_address AS email_address,\n    resolution AS resolution,\n    user_id_db AS user_id_db,\n    user_agent AS user_agent \n  FROM src\n  WHERE collection = 'checkout_success'\n)\n\nSELECT * FROM checkout_success", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-21T13:52:49.541490Z", "completed_at": "2025-09-21T13:52:49.547144Z"}, {"name": "execute", "started_at": "2025-09-21T13:52:49.548335Z", "completed_at": "2025-09-21T13:52:55.134980Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.59740948677063, "adapter_response": {"_message": "CREATE TABLE (3.2m rows, 289.2 MiB processed)", "code": "CREATE TABLE", "rows_affected": 3239628, "bytes_processed": 303250271, "bytes_billed": 304087040, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "09321c62-5169-42af-9a29-98411aadb6e3", "slot_ms": 57760}, "message": "CREATE TABLE (3.2m rows, 289.2 MiB processed)", "failures": null, "unique_id": "model.dbt_project.stag_location", "compiled": true, "compiled_code": "\n\nWITH src AS (\n    SELECT *\n    FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`location`\n),\n\ncasted AS (\n    SELECT\n        CONCAT(src.city, src.country_short, src.region) AS location_id,\n        src.ip AS ip_address,\n        src.city AS city_name, \n        src.country_short AS country_short_name,\n        src.country_long AS country_long_name,  \n        ROUND(SAFE_CAST(src.latitude AS NUMERIC), 6) AS latitude,\n        ROUND(SAFE_CAST(src.longitude AS NUMERIC), 6) AS longitude,\n        src.region AS region_name, \n        src.time_zone AS time_zone, \n        src.zip_code AS zip_code\n    FROM src\n)\n\nSELECT * FROM casted", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-21T13:52:55.145328Z", "completed_at": "2025-09-21T13:52:55.152151Z"}, {"name": "execute", "started_at": "2025-09-21T13:52:55.153278Z", "completed_at": "2025-09-21T13:52:58.990238Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.8488900661468506, "adapter_response": {"_message": "CREATE TABLE (18.8k rows, 1.8 MiB processed)", "code": "CREATE TABLE", "rows_affected": 18822, "bytes_processed": 1852727, "bytes_billed": 10485760, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "15fee3f1-ac8c-4286-a8d4-5dc587c0f633", "slot_ms": 4408}, "message": "CREATE TABLE (18.8k rows, 1.8 MiB processed)", "failures": null, "unique_id": "model.dbt_project.stag_product", "compiled": true, "compiled_code": "\n\nWITH src AS (\n SELECT *\n FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`product_name`\n),\n\ncasted AS (\n SELECT\n   src.product_id AS product_id,\n   src.name AS product_name,\n   src.sku AS sku,\n   src.gender AS gender,\n   src.max_price_format AS max_price_format,\n   src.min_price_format AS min_price_format,\n   src.type_id AS type_id,\n   src.store_code AS store_code\n FROM src\n)\n\nSELECT * FROM casted", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-21T13:52:59.002250Z", "completed_at": "2025-09-21T13:52:59.013408Z"}, {"name": "execute", "started_at": "2025-09-21T13:52:59.014830Z", "completed_at": "2025-09-21T13:53:03.212551Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.215506315231323, "adapter_response": {"_message": "CREATE TABLE (35.1k rows, 3.7 GiB processed)", "code": "CREATE TABLE", "rows_affected": 35065, "bytes_processed": 3947010899, "bytes_billed": 3947888640, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "e381cdc3-29b2-4eb5-aa88-241d7fb54011", "slot_ms": 54462}, "message": "CREATE TABLE (35.1k rows, 3.7 GiB processed)", "failures": null, "unique_id": "model.dbt_project.stag_sales", "compiled": true, "compiled_code": "\n\n\nWITH src AS (\n SELECT *\n FROM `symmetric-fin-469415-q9`.`glamira_data_2025`.`summary`\n),\n\n\nflattened AS (\n SELECT\n   GENERATE_UUID() as sales_id,\n   CAST(src.order_id AS INT64) AS order_id,\n   src._id AS customer_id,\n   src.time_stamp AS date_id,\n   src.ip AS ip_address,\n   src.time_stamp AS time_stamp,\n   src.local_time AS local_time,\n   CAST(src.store_id AS INT64) AS store_id,\n   cp.product_id AS product_id,\n   cp.amount AS amount,\n   cp.currency AS currency_code,\n   cp.price AS price\n FROM src,\n UNNEST(src.cart_products) AS cp\n WHERE collection = 'checkout_success'\n)\n\n\nSELECT * FROM flattened", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-21T13:53:03.227880Z", "completed_at": "2025-09-21T13:53:03.236738Z"}, {"name": "execute", "started_at": "2025-09-21T13:53:03.238396Z", "completed_at": "2025-09-21T13:53:07.133614Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.910846471786499, "adapter_response": {"_message": "CREATE TABLE (26.1k rows, 4.4 MiB processed)", "code": "CREATE TABLE", "rows_affected": 26079, "bytes_processed": 4625154, "bytes_billed": 10485760, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "56cca761-c836-4cdd-ab7a-5738ef78f916", "slot_ms": 8194}, "message": "CREATE TABLE (26.1k rows, 4.4 MiB processed)", "failures": null, "unique_id": "model.dbt_project.dim_customer", "compiled": true, "compiled_code": "\n\nWITH src AS (\n    SELECT *\n    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_customer`\n),\n\ncustomer AS (\n    SELECT\n        customer_id,\n        email_address,\n        resolution,\n        user_agent\n    FROM src \n)\n\nSELECT * FROM customer", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_customer`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-21T13:53:07.143939Z", "completed_at": "2025-09-21T13:53:07.152962Z"}, {"name": "execute", "started_at": "2025-09-21T13:53:07.154250Z", "completed_at": "2025-09-21T13:53:11.802232Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.662339925765991, "adapter_response": {"_message": "CREATE TABLE (52.2k rows, 345.3 MiB processed)", "code": "CREATE TABLE", "rows_affected": 52224, "bytes_processed": 362102242, "bytes_billed": 362807296, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "ec4faacf-4da5-40bf-8b2c-8951267f1279", "slot_ms": 11406}, "message": "CREATE TABLE (52.2k rows, 345.3 MiB processed)", "failures": null, "unique_id": "model.dbt_project.dim_location", "compiled": true, "compiled_code": "\n\nWITH src AS (\n    SELECT *\n    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location`\n),\n\nlocation_data AS (\n    SELECT DISTINCT\n        location_id,\n        city_name, \n        country_short_name,\n        country_long_name,  \n        latitude,\n        longitude,\n        region_name, \n        time_zone, \n        zip_code\n    FROM src\n)\n\nSELECT * FROM location_data", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_location`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-21T13:53:11.815243Z", "completed_at": "2025-09-21T13:53:11.828535Z"}, {"name": "execute", "started_at": "2025-09-21T13:53:11.830227Z", "completed_at": "2025-09-21T13:53:15.412260Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.6022439002990723, "adapter_response": {"_message": "CREATE TABLE (18.8k rows, 1.8 MiB processed)", "code": "CREATE TABLE", "rows_affected": 18822, "bytes_processed": 1852727, "bytes_billed": 10485760, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "26d1ca10-721d-4714-bf0e-0831e60b8ef5", "slot_ms": 6252}, "message": "CREATE TABLE (18.8k rows, 1.8 MiB processed)", "failures": null, "unique_id": "model.dbt_project.dim_product", "compiled": true, "compiled_code": "\n\nWITH src AS (\n    SELECT *\n    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_product`\n),\n\nproduct AS (\n SELECT\n   product_id,\n   product_name,\n   sku,\n   gender,\n   max_price_format AS max_price,\n   min_price_format AS min_price,\n   type_id,\n   store_code\n FROM src\n)\n\nSELECT * FROM product", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-21T13:53:15.422893Z", "completed_at": "2025-09-21T13:53:15.431706Z"}, {"name": "execute", "started_at": "2025-09-21T13:53:15.432884Z", "completed_at": "2025-09-21T13:53:19.075893Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.657059907913208, "adapter_response": {"_message": "CREATE TABLE (65.0 rows, 273.9 KiB processed)", "code": "CREATE TABLE", "rows_affected": 65, "bytes_processed": 280520, "bytes_billed": 10485760, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "fdead761-b799-40eb-b593-4510416bab80", "slot_ms": 302}, "message": "CREATE TABLE (65.0 rows, 273.9 KiB processed)", "failures": null, "unique_id": "model.dbt_project.dim_date", "compiled": true, "compiled_code": "\n\nWITH src AS (\n    SELECT *\n    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`\n),\n\ndate_ AS (\n    SELECT DISTINCT\n        CAST(FORMAT_DATE('%Y%m%d', DATE(TIMESTAMP_SECONDS(src.time_stamp))) AS INT64) AS date_id,\n        DATE(TIMESTAMP_SECONDS(src.time_stamp)) AS full_date\n    FROM src\n)\n\nSELECT\n    date_id,\n    full_date,\n    FORMAT_DATE('%A', full_date) AS day_of_week,\n    CASE WHEN EXTRACT(DAYOFWEEK FROM full_date) IN (1,7) THEN TRUE ELSE FALSE END AS is_weekend,\n    EXTRACT(DAY FROM full_date) AS day_of_month,\n    FORMAT_DATE('%Y-%m', full_date) AS year_month,\n    EXTRACT(MONTH FROM full_date) AS month,\n    EXTRACT(ISOWEEK FROM full_date) AS week_of_year,\n    CONCAT('Q', CAST(EXTRACT(QUARTER FROM full_date) AS STRING)) AS quarter_number,\n    CAST(EXTRACT(YEAR FROM full_date) AS STRING) AS year,\n    EXTRACT(YEAR FROM full_date) AS year_number\nFROM date_\nORDER BY full_date", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_date`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-21T13:53:19.091321Z", "completed_at": "2025-09-21T13:53:19.100573Z"}, {"name": "execute", "started_at": "2025-09-21T13:53:19.101993Z", "completed_at": "2025-09-21T13:53:25.702932Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.616853952407837, "adapter_response": {"_message": "CREATE TABLE (65.0 rows, 273.9 KiB processed)", "code": "CREATE TABLE", "rows_affected": 65, "bytes_processed": 280520, "bytes_billed": 10485760, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "25dd079a-475d-4a6b-8977-146c8605765a", "slot_ms": 4626}, "message": "CREATE TABLE (65.0 rows, 273.9 KiB processed)", "failures": null, "unique_id": "model.dbt_project.dim_store", "compiled": true, "compiled_code": "\n\nWITH src AS (\n    SELECT *\n    FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`\n),\n\nstore AS (\n    SELECT\n        DISTINCT store_id,\n        CONCAT(\"Store \", CAST(store_id AS STRING)) AS store_name\n    FROM src\n)\n\nSELECT * FROM store", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_store`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-21T13:53:25.713294Z", "completed_at": "2025-09-21T13:53:25.725201Z"}, {"name": "execute", "started_at": "2025-09-21T13:53:25.727040Z", "completed_at": "2025-09-21T13:53:29.755072Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.045393705368042, "adapter_response": {"_message": "CREATE TABLE (35.1k rows, 123.6 MiB processed)", "code": "CREATE TABLE", "rows_affected": 35065, "bytes_processed": 129626505, "bytes_billed": 130023424, "location": "US", "project_id": "symmetric-fin-469415-q9", "job_id": "abe658c7-dd6e-49ee-a60a-d53c2a52770d", "slot_ms": 34667}, "message": "CREATE TABLE (35.1k rows, 123.6 MiB processed)", "failures": null, "unique_id": "model.dbt_project.fact_sales", "compiled": true, "compiled_code": "\n\nWITH src AS (\n  SELECT *\n  FROM `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_sales`\n),\n\nsales AS (\n  SELECT \n    src.sales_id,\n    src.order_id,\n    src.customer_id,\n\n    CAST(FORMAT_DATE('%Y%m%d', DATE(TIMESTAMP_SECONDS(src.time_stamp))) AS INT64) AS date_id,\n    TIMESTAMP_SECONDS(src.time_stamp) AS time_stamp,\n    src.local_time,\n\n    l.location_id,\n    src.ip_address,\n\n    src.store_id,\n    src.product_id,\n    src.amount,\n\n    CASE\n      WHEN src.currency_code IS NULL OR TRIM(src.currency_code) = \"\" THEN \"USD $\"\n      WHEN TRIM(src.currency_code) = \" din.\" THEN \"din.\"\n      WHEN TRIM(src.currency_code) = \"\u062f.\u0643.\u200f\" THEN \"\u062f.\u0643.\"\n      ELSE TRIM(src.currency_code)\n    END AS currency_code,\n\n    CASE\n      WHEN src.price LIKE '%,%' AND src.price LIKE '%.%' \n        THEN SAFE_CAST(REPLACE(REPLACE(src.price, '.', ''), ',', '.') AS FLOAT64)\n      WHEN src.price LIKE '%,%' \n        THEN SAFE_CAST(REPLACE(src.price, ',', '.') AS FLOAT64)\n      ELSE\n        SAFE_CAST(src.price AS FLOAT64)\n    END AS price\n  FROM src\n  LEFT JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_staging`.`stag_location` l\n    ON src.ip_address = l.ip_address\n),\n\nwith_rates AS (\n  SELECT\n    s.*,\n    COALESCE(c.exchange_rate, 1.0) AS exchange_rate,\n    s.price * COALESCE(c.exchange_rate, 1.0) AS price_in_usd\n  FROM sales s\n  LEFT JOIN `symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`dim_currency` c\n    ON s.currency_code = c.code OR s.currency_code = c.symbol\n)\n\nSELECT\n  sales_id,\n  order_id,\n  customer_id,\n  date_id,\n  time_stamp,\n  local_time,\n  location_id,\n  ip_address,\n  store_id,\n  product_id,\n  amount,\n  price_in_usd,\n  price_in_usd * amount AS line_total\nFROM with_rates", "relation_name": "`symmetric-fin-469415-q9`.`glamira_data_2025_warehouse`.`fact_sales`", "batch_results": null}], "elapsed_time": 51.30901026725769, "args": {"vars": {}, "use_colors_file": true, "static_parser": true, "partial_parse": true, "require_yaml_configuration_for_mf_time_spines": false, "indirect_selection": "eager", "require_batched_execution_for_custom_microbatch_strategy": false, "populate_cache": true, "defer": false, "show_all_deprecations": false, "strict_mode": false, "use_fast_test_edges": false, "log_file_max_bytes": 10485760, "which": "run", "printer_width": 80, "require_generic_test_arguments_property": true, "log_level_file": "debug", "macro_debugging": false, "state_modified_compare_more_unrendered_values": false, "state_modified_compare_vars": false, "print": true, "partial_parse_file_diff": true, "profiles_dir": "/home/dunhan/.dbt", "favor_state": false, "exclude": [], "use_colors": true, "log_format_file": "debug", "upload_to_artifacts_ingest_api": false, "cache_selected_only": false, "validate_macro_args": false, "source_freshness_run_project_hooks": true, "log_path": "/home/dunhan/dbt_project/logs", "select": [], "send_anonymous_usage_stats": true, "empty": false, "introspect": true, "skip_nodes_if_on_run_start_fails": false, "log_level": "info", "require_explicit_package_overrides_for_builtin_materializations": true, "invocation_command": "dbt run", "version_check": true, "write_json": true, "require_nested_cumulative_type_params": false, "quiet": false, "project_dir": "/home/dunhan/dbt_project", "warn_error_options": {"error": [], "warn": [], "silence": []}, "require_resource_names_without_spaces": true, "require_all_warnings_handled_by_warn_error": false, "show_resource_report": false, "log_format": "default"}}