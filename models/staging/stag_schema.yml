version: 2

models:
  - name: stag_sales
    description: "Flattened sales events from glamira_data.summary with one row per cart product."
    columns:
      - name: sales_id
        description: "Surrogate PK generated by GENERATE_UUID()."
        tests:
          - not_null
          - unique

      - name: order_id
        description: "Order identifier from source."
        tests: 
          - not_null

      - name: customer_id
        description: "Customer/session id from _id."
        tests: 
          - not_null

      - name: date_id
        description: "Event timestamp."
        tests:
          - not_null
      
      - name: time_stamp
        description: "Event date (UTC)."
        tests: []

      - name: local_time
        description: "Event date in local time."
        tests: []

      - name: ip_address
        description: "IP address as STRING."
        tests: []

      - name: store_id
        description: "Store identifier."
        tests: []

      - name: product_id
        description: "Product id from cart_products."
        tests:
          - not_null

      - name: amount
        description: "Quantity for the product line."
        tests: []

      - name: currency_code
        description: "Currency code/string from cart_products."
        tests: []

      - name: price
        description: "Unit price."
        tests: []

  - name: stag_customer
    description: "Staging model for customer/session info from checkout_success events."
    columns:
      - name: customer_id
        description: "Unique customer/session identifier."
        tests:
          - not_null
          - unique

      - name: device_id
        description: "Device identifier string."
        tests: []

      - name: email_address
        description: "Customer email address."
        tests: []

      - name: resolution
        description: "Screen resolution of device."
        tests: []

      - name: user_id_db
        description: "User ID from database."
        tests: []

      - name: user_agent
        description: "Browser/device user agent string."
        tests: []

  - name: stag_location
    description: "Staging model for IP-based location enrichment."
    columns:
      - name: location_id
        description: "Location id for the same city, country, and region."
        tests:
          - not_null

      - name: ip_address
        description: "User IP address as string."
        tests: []

      - name: city_name
        description: "City name resolved from IP."
        tests: []

      - name: country_short_name
        description: "Country ISO2 code (short name)."
        tests: []

      - name: country_long_name
        description: "Full country name."
        tests: []

      - name: latitude
        description: "Latitude of IP location."
        tests: []

      - name: longitude
        description: "Longitude of IP location."
        tests: []

      - name: region_name
        description: "Region or state."
        tests: []

      - name: time_zone
        description: "Timezone of IP location."
        tests: []

      - name: zip_code
        description: "Postal code if available."
        tests: []

  - name: stag_product
    description: "Staging model for product master data."
    columns:
      - name: product_id
        description: "Unique product identifier."
        tests:
          - not_null
          - unique

      - name: product_name
        description: "Product display name."
        tests: []

      - name: sku
        description: "Product SKU code."
        tests: []

      - name: gender
        description: "Target gender (e.g., women, men, null)."
        tests:
          - accepted_values:
                arguments:
                    values:
                        - 'women'
                        - 'men'
                        - 'Unknown'

      - name: max_price_format
        description: "Maximum price formatted string."
        tests: []

      - name: min_price_format
        description: "Minimum price formatted string."
        tests: []

      - name: type_id
        description: "Product type identifier."
        tests: []

      - name: store_code
        description: "Store code the product belongs to."
        tests: []